自动化学报
ACTA AUTOMATICA SINICA
1998年 第24卷 第4期 Vol.24 No.4 1998




连续非线性系统的神经网络α阶逆系统控制方法1)
戴先中　刘军　冯纯伯
摘　要　对连续非线性系统，采用连续系统的设计方法，利用神经网络对非线性函数的逼近能力加上用来表征系统动态特性的若干积分器，构造工程上可实现的原系统的神经网络α阶逆系统(将α阶逆系统直接与原系统串接，构成α阶积分伪线性复合系统)，并对α阶积分伪线性复合系统设计线性控制器，实现对原非线性系统的有效控制.仿真结果表明，该方法适用于较一般的线性、非线性连续系统，且结构简单，易于工程实现.
关键词　非线性系统，逆系统，神经网络，辨识，控制.
NEURAL NETWORK αTH－ORDER INVERSE－SYSTEM CONTROL
METHOD FOR NONLINEAR CONTINUOUS SYSTEMS
DAI XIANZHONG LIU JUN FENG CH UNBO
(Automatic Control Eng.Dept.of Southeast Univ.,Nanjing 210096)
Abstract Based on the design process of continuous systems,t his paper focuses on the NN αth－order inverse－system of nonlinear continu ous system.The NN αth－order inverse－system is constructed by combining th e NN approximating nonlinear function of the system with integrators denoting dy namic characteristics.Furthermore,a linear closed－loop controller for the compo site system is designed to complete effective control of the original system.Sim u lation results show that this method can apply to general linear or nonlinear co ntinuous systems,and that the controller can be implemented easily.
Key words Nonlinear system,inverse－system,neural networks(NN),identification ,control.
1　引言
　　近年来，人工神经网络用于线性、非线性系统的辨识与控制取得了较大的进展［1-6］.对非线性系统的神经网络(NN)控制的研究，目前大多限于离散时间系统(即使有的文献处理连续系统，也只是将连续系统离散化，然后采用离散系统的设计方法，对离散化的近似模型进行辨识与控制，实质上是将处理离散系统的方法间接地用来处理连续系统).这主要是由于用NN来处理离散系统的控制问题比处理连续系统易于分析讨论，易于工程实现，亦易于仿真.但大多数实际的被控系统均是连续系统，因此研究连续非线性系统的神经网络控制问题具有重要意义.
　　本文针对一般连续非线性系统，完全采用连续系统的设计方法，研究神经网络α阶逆系统 (将α阶逆系统直接与原系统串接，构成α阶积分伪线性复合系统)的结构与辨识，并将其应用于非线性系统的控制，形成直接用于连续系统的神经网络控制方法.
2　连续非线性系统的逆系统
　　对连续非线性系统的逆系统，本文采用文献［7］中的如下定义：
　　给定一个系统(线性或非线性)Σ，其输入为u(t),输出为y(t),初始状态 x(t0)=x0.记描述该映射关系的算子为θ:u→y,即
y(.)=θ［x0,u(.)］或简写为y=θu　　(1)
　　设Π为另一个系统，表示其映射关系的算子为：yd→ud,如果算子满足下式
θyd=θud=yd,　　(2)
则称系统Π为系统Σ的单位逆系统.相应地，系统Σ称为原系统.
　　设Πα为又一个系统，表示其传递关系的算子为α：Φ→ud,如果对 于Φ=y(α)d(t),即yd的α阶导数，算子α满足
θαΦ=θα(y(α)d)=θud=yd,　　(3)
则称系统Πα为系统Σ的α阶积分逆系统.单位逆系统是α=0时α阶逆系统的特例.
　　对于给定系统Σ，如果存在如上描述的逆系统Π或Πα(理论上两种 逆系统可相互转换，即一个系统存在单位逆系统和存在α阶逆系统是等价的［7］)，则称系统Σ为 可逆系统 .当系统的数学模型(数学表达式)已知时，依据该数学模型，可判断系统是否可逆［7］ .但当系统的数学模型未知或未全知时，很难判断.为了讨论上的方便，在本文中讨论的非 线性系统均假定具有上述意义下的逆系统.
3　神经网络α阶逆系统的结构与辨识
　　神经网络α阶逆系统的构造思想是：对未知连续系统，用静态神经网络加若干积分器(或微分器)来实现α阶逆系统的功能，其中静态神经网络仅用来逼近静态非线性函数，积分器(或微分器)反映系统的动态特性.这种静态特性与动态特性相互分开、神经网络与积分器各司其职的结构，有助于简化神经网络的内部结构，有助于提高神经网络收敛速度.
　　设原系统(SISO且不显含时间t)的数学模型用非线性微分方程
f［y(n),y(n-1),…，y(1),y,u(m),u(m-1),…，u (1),u］=0　　(4)
表示.式中u(t)为输入，y(t)为输出，m,n(m≤n)分别为输入、输出的阶次，y(n)为y 的n阶导数，u(m)为u的m阶导数.
　　先讨论原系统输出、输入及其各阶导数均已知的特殊情况.假定存在未知函数g使
u=g［y(n),y(n-1),…，y(1),y,u(m),u(m-1),…，u (1)］　　(5)
成立.此时可实现结构很简单的神经网络α阶逆系统，如图1(a)所示，其中Y表示向量［y,…，y(α-1),y(α+1),…,y(n)］,U 表示向量［u(1),…，u(m)］，神经网络仅用来逼近式(5)中的未知非线性函数 g.由于原系统输出、输入及其各阶导数均已知，即无论α在0～n之间取何值，Y和U 都为已知量，所以可实现任意阶的神经网络逆系统.神经网络α阶逆系统的离线辨 识结构也很简单，如图1(b)所示，其中Y1表示向量［y(1), …, y(n)］,U同图1(a)，NN的输入信号全部由原系统提供，不需要任何积 分或微分运算.


图1　原系统输出、输入的各阶导数已知时的NNα阶逆系统结构(a)与辨识结构(b)
　　在实际应用中，要求原系统输入输出的各阶导数完全已知(可测)，常常是难以做到的.许多情况下，除了系统的输出输入y，u能检测与系统的阶数n，m已知外，对系统的其余 情况可能一 概未知.这时原系统输入输出的各阶导数只能通过对已知状态进行积分或微分来获得.在实际计算机控制系统中，积分或微分运算是由计算机通过数值积分或数值微分来实现，由于数值积分实现精度高，数值微分精度差，因此一般仅采用数值积分.
　　当原系统输出、输入的各阶导数均未知时，同样假定存在未知函数gn
u(m)=gn［y(n),y(n-1),…，y(1),y,u(m-1)，…,u(1),u ］=0　　(6)
成立.此时仅用积分器与NN可构成神经网络n阶逆系统，如图2(a)所示，其中神经网络用来逼近式(6)中的未知非线性函数gn.相应的逆系统辨识结构如图2(b)所示，需要m个积分器与n个微分器参与该离线辨识过程(注：在非实时的离线辨识中，可通过对y,u的高速采样获得尽可能多的数据和高精度的数值微积分来提高辨识精度).


图2　原系统状态完全未知时的神经网络n阶逆系统结构(a)与辨识结构(b)
(D表示微分，D-1表示积分)
　　由于神经网络n阶逆系统与原系统构成的伪线性复合系统具有n阶积分的性质，当n较高时，这样的复合系统稳定性差，难以整定.因此从实际应用角度，总是希望神经网络逆系统的阶数越低越好.神经网络单位逆系统是最理想的，但当原系统输出、输入的各阶导数未知时，在神经网络单位逆系统结构中要得到α=0时图1(a)中的Y与U，就需要较多的微分器，实现精度很差.而当原系统输出、输入的各阶导数未知时，不使用微分而仅使 用积分所能实现的神经网络逆系统的最低阶数为α=n-m，即原系统的相对阶数，因为不使用微分时要满足正则性(易于实现)，就必须有系统的输入阶次不大于输出阶次，而在逆系统表达式(6)中，y的微分阶次比u的微分阶次高α，只有选择y的α阶导数或更高阶导数作为逆系统的输入，才能使逆系统中输入阶次不大于输出u的阶次，从而满足正则性(易于实现)，此时构成的逆系统为α阶或更高阶的逆系统.(注：α阶逆系统本身的相对阶数为0)
　　对于线性系统，原系统的微分方程表示式(4)又可表示为
［y(n-m)…，y,y(-1),…，y(-m),u,u(-1),…u(-m)］=0.　　(7)
式中y(-m)为y的m阶积分，u(-m)为u的m阶积分，其它参数定义见式(4)，且一定存在未知线性函数，使
u=［y(n-m)…，y,y(-1),…，y(-m),u(-1),…u(-m)］　　(8)
成立.此时即可实现如图3所示的神经网络α阶逆系统(具体结构参见图2(a)，图中α为原系统的相对阶数，yα表示向量［y(α-1) ,…，y,y(-1),…，y(-m)］,uα表示向量［u(-1)，…, u(-m)］,神经网络仅用来逼近式(8)中的未知线性函数.


图3　神经网络α阶逆系统结构
　　对于非线性系统，如果原系统的微分方程式(4)可用式(7)表示，同样可实现神经网络α阶 逆系统，α为原系统的相对阶数.
　　神经网络α阶逆系统中使用的神经网络可选用任一种静态网络，只要能逼近非线性函数即 可.辨识中使用的算法可以是与采用的神经网络相匹配的任一种算法.我们在仿真研究中，选用仅有一个隐含层的多层感知器，输入层结点数依据系统的阶数n与相对阶数α来确定，一般为2n+1-α，隐含层结点数等于或略大于输入层结点数，输出层结点数为1.辨识算法采用常用的附加冲量项的改进型BP算法.简单的神经网络结构和学习算法说明神经网络α阶逆系统结构简单、易于实现.
4　NNα阶逆系统在控制中的直接应用--神经网络逆系统控制方法
　　将已经辨识好的神经网络α阶逆系统直接与原非线性系统连接起来，就构成一近似伪线性系 统，具有α阶积分性质.进一步应用线性系统理论中的各种控制方法，如PID控制、串并联校正、极点配置(如图4所示)等等，设计出满足系统要求的控制器，连同神经网络逆系统一起构成复合控制器，实现对原非线性系统的有效控制.


图4　对2阶伪线性复合系统采用极点配置示意图
5　NN逆系统控制仿真实例
　　二阶非线性系统为［7］
+3y2+y3=u.　　(9)
　　采用试验信号ud(t)=sin(2πt/2.5)，离线学习样本｛ud,y｝通过数值计 算(代替实际的系统采样)获取(步长为0.001s，2500个数据对)，数值微分得｛，｝，再从中等间隔取25个数据对构成训练样本集｛ud,y,， ｝.
　　离线逆辨识时，假设原系统是未知的.逆辨识结构如图2所示，获得的NN2阶逆系统(3－4－1)与原系统构成2阶积分伪线性复合系统后，采用极点配置构成图4所示的控制系统(其中K=4,f1=1,f2=0.8).该系统对于方波输入(幅值分别为±0.6和±0.4)的响应如图5所示，其中实线为复合控制系统的响应，虚线为输入信号，点划线为原系统对该输入信号的响应.


图5　采用NN2阶逆系统复合控制器的系统(图4)对方波输入的响应
6　神经网络逆系统控制方法与其它控制方法的比较
　　(1)与同样采用逆思想的神经网络控制方法如直接逆控制相比，本文介绍的方法有如下3个 特点：
　　1)NN逼近非线性函数，积分、微分表征动态特性，分工明确，NN结构简单；
　　2)用神经网络与积分器构成的逆系统为正则的NNα阶逆系统，而不是NN单位逆系统，易于实现；
　　3)NNα阶逆系统仅作为整个控制器的一部分，按线性系统理论设计的线性控制器构成整个控制器的另一部分，该线性控制器设计简单，能提高整个系统的性能.
　　(2)与通常意义下的逆系统方法［7］相比，本文介绍的方法具有更广的应用范围，这是由于通常意义下的逆系统方法需要知道原系统的准确模型和必须能解出与式(4)系统相应的逆的显式表示，这是通常意义下的逆系统方法在实际应用中的两个“瓶颈”问题，限制了其实际应用.而本文介绍的方法无以上要求.
7　几点初步结论
　　(1)本文介绍的用神经网络加积分器构成的NNα阶逆系统再辅以反馈控制等常规控制方法，完全采用连续系统的设计方法，为连续系统的NN控制提供了一种较一般的可工程实现的方法，其特点是：
　　1)适用于式(4)表示的一般非线性系统(假定系统是可逆的).
　　2)不需知道原系统的数学模型(仅需知道系统的阶数与相对阶数).
　　3)结构简单.
　　(2)当原系统的相对阶数α不为零且输入、输出的各阶导数未知时，实际工程可实现的一般不是单位逆系统，而是α阶逆系统.
　　1)国家自然科学基金资助项目.
作者简介：戴先中　男，1954年5月生.1986年毕业于清华大学，获博士学位，现为东南大学自动控制系主任，教授，博士生导师.当前研究方向为神经网络、非线性控制、电力系统控制、计算机控制等.
　　　　　刘　军　男，1972年9月生.1991、1994、1997年于东南大学分别获得学士、硕士、博士学位.当前研究方向为神经网络、非线性网络、电力系统控制、计算机控制等.
　　　　　冯纯伯　简介及照片见本刊第22卷第1期，1995年11月当选为中国科学院院士.
作者单位：东南大学自动控制系　南京　210096
参考文献
1 Hunt K J,Sbarbaro D et al.Neural networks for control systems-- a survey.Automatica,1992,28:1083-1112
2　Nguyen D H,Widrow B.Neural networks for self－learning control systems.IEEE Contr.Syst.Mag.,1990,10(2):18-23
3　Chen Fuchuang,Liu Chenchung.Adaptively controlling nonlinear continuous－time systems using multilayer neural networks.IEEE Trans.Auto－Contr., 1994,AC－39:1306-1310
4　Ahmed M S.Block partial derivative and its application to neural－net－base d direct－model－reference adaptive control.IEE Proc.－D,1994, 141(5):305-314
5　Hunt K J,Sbarbaro D.Neural networks for nonlinear internal model control.IEE Proc.－D,1991,138(5):431-438
6　Nielsen R H.Theory of the backpropagation neural network,I JCNN 89,1989,I59 3-I605
7　李春文，冯元琨.多变量非线性控制的逆系统方法.北京：清华大学出版社，1991
收稿日期　1996-03-26
