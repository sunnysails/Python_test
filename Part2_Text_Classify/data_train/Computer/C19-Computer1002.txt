自动化学报
ACTA AUTOMATICA SINICA
1998年 第24卷 第1期  Vol.24  No.1 1998



多变量时滞系统Dahlin控制器的设计
张卫东　孙优贤　许晓鸣
摘　要　在现代鲁棒控制理论基础上，提出一种多变量Dahlin控制器多目标优化设计方法.利用线性分解变换，多变量Dahlin控制器设计问题被转化为标准的H∞优化问题，通过对标准的H∞优化问题求解得到了最终的控制器.它同时具有时滞补偿，解耦和控制的作用.与已有的方法相比，该方法不但直观，而且兼顾了系统的性能和鲁棒性.
关键词　Dahlin控制器，多变量系统，时滞系统，鲁棒控制.
MULTIVARIABLE DAHLIN CONTROLLER DESIGN
ZHANG WEIDONG　SUN YOUXIAN
(National Laboratory of Industrial Control Technology, Institute of Industrial Process Control of
Zhejiang University, Hangzhou　310027)

XU XIAOMING
(Department of Automatic Control, Shanghai Jiaotong University, Shanghai　20030)
Abstract　The well-known Dahlin controller for scalar control systems is extended to the control of a class of multivariable control systems with time delays. The problem of multivariable Dahlin controller design is converted to a standard H∞ optimization problem. By solving the H∞ optimization problem, we obtain the multivariable Dahlin controller. Compared to the previous method, the new one provides both good performance and robustness.
Key words　Dahlin controller, robustness, time-delay, multivariable control system.
1　引言
　　Dahlin控制器［1］是一种用于大纯滞后控制对象的数字控制器，最初是由IBM公司的Dahlin在1968年提出的，与此同时Higham［2］也提出了类似的方法.这类方法的优点是控制器的设计过程非常简单，控制系统具有很好鲁棒性.因此Dahlin控制器成为一类典型的控制方法［3－6］.Astrom［7］定性地指出Dahlin控制器是一种Smith预估器［8］型的控制器，我们则证明了Dahlin控制器在本质上与采用H2最优方法设计的次最优Smith预估器是等价的［9］，从而揭示了Dahlin控制器能够有效地用于大纯滞后对象控制的原因.然而，以往的工作都是针对单变量的情况进行研究的，多变量Dahlin控制器的研究一直毫无进展.直到最近，Teng等［10］才将Dahlin控制器推广到多变量的情形.但是Teng等的工作仅仅考虑了标称情况的设计，没有考虑到系统的鲁棒性问题.另外，这种方法只适用于具有相等时滞的对象，对不等时滞的对象是采用凑齐的办法来解决的，在凑齐时小的时滞被人为地延长了，因而引入了很大的保守性.
　　本文提出一种多变量时滞系统Dahlin控制器多目标优化设计方法，其基本思想是将Dahlin控制器的设计问题转化为标准的H∞优化问题，通过对标准的H∞优化问题求解得到最终的控制器.这种方法的优点是可以将控制器的求解和系统稳定裕度优化综合起来考虑，从而同时保证了系统的性能和鲁棒性.与Teng等的方法相比，本文方法还具有直观的优点.本文提出的设计方法是在连续域中进行的，当控制对象具有相同时滞时问题得到了很好的解决；当控制对象具有不同时滞时，采用了逼近的办法处理.

2　单变量Dahlin控制器的设计方法
　　考虑一个单变量单位反馈控制回路，其中C(z)是控制器，G(z)是控制对象，那么系统的闭环传递函数为
　　　　　　　　　　　　　　　(1)
若T(z)是已知的，则控制器的综合公式为
　　　　　　　　　　　　　　　(2)
式中的T(z)应当这样选择，它必须使控制器是物理上可实现的，因此算法中不能包含有预估作用的项.对一阶惯性加纯滞后控制对象
　　　　　　　　　　　　　　　(3)
式中Ts是采样周期，N是在过程纯滞后中的采样周期数.Dahlin控制器规定闭环控制系统的传递函数为
　　　　　　　　　　　　　　　(4)
如果表示在复频域中就是
　　　　　　　　　　　　　　　(5)
其中λ＞0，θ=NTs.由此得到控制器为
　　　　　　　　(6)
式中的λ是在现场根据试验选择的可调参数，它可以用于调整系统的性能和鲁棒性.

3　多变量Dahlin控制器的设计
　　考虑多变量单位反馈系统.假设G(s)∈R(s)m×n表示稳定的控制对象，C(s)∈R(s)m×n表示控制器，G(s)和C(s)中的元素具有如下的形式：
［G(s)］ij=gij(s)e-θijs, 　　　　　　　　　　　　　　　(7)
［C(s)］ij=cij(s).　　　　　　　　　　　　　　　(8)
这里gij(s), cij(s)∈R(s), θij≥0, i,j=1,2,…，n.
3.1　鲁棒稳定性分析
　　设Δ(s)为一关于G(s)的加性摄动，并且Δ(s)满足
　　1) G(s)与G(s)+Δ(s)在开右半平面具有相同数目的极点.
　　2) (Δ(jω))≤(ω), ω≥0.
这里为大于零的实函数.在标称情况下，如果存在一个C(s)使整个闭环系统是内稳定的，则称C(s)能够镇定G(s).
　　引理1［11］　(Youla参数化定理).在上述系统中，如果G(s)的稳定的，则所有镇定G(s)的控制器的集合为
｛C(s):C(s)=Q(s)(I-G(s)Q(s))-1, Q(s)∈RH∞， det(I-G(∞)Q(∞))≠0｝.
在过程控制中Q(s)也称作内模控制器，可以用内模结构方便地实现.因此系统的灵敏度函数可以写作
S(s)=(I+G(s)C(s))-1=I-G(s)Q(s) ,　　　　　　　　　　　　　　　(9)
余灵敏度函数可以写作
T(s)=G(s)C(s)(I+G(s)C(s))-1=G(s)Q(s).　　　　　　　　　　　　　　　(10)
定义　　　　　　　　　　　　　　　R(s)=C(s)(I+G(s)C(s))-1,
则系统的加性稳定性优化问题可以表示为
　　　　　　　　　　　　　　　(11)
式中W1(s)是权函数.稳定性优化保证了具有加性摄动Δ(s)的系统具有尽可能好的鲁棒性.
　　引理2［11］　考虑上面的系统，如果标称系统是内稳定的，那么具有加性摄动Δ(s)的系统是内稳定的，当且仅当

由于时滞的存在使得上式的处理非常困难，为此对控制对象进行Hadamard分解
G(s)=G0(s).*EG(s) .　　　　　　　　　　　　　　　(12)
式中［G0(s)］ij=gij, ［EG(s)］ij=e-θijs.由此可以构造一个无时滞系统，系统的控制对象为G0(s),控制器为
C0(s)=Q(s)(I-G0(s)Q(s))-1 .　　　　　　　　　　　　　　　(13)
这样选择控制器是因为若存在一个Q(s)∈RH∞, 使得C(s)能够镇定G(s)，则Q(s)必能使上述的C0(s)镇定G0(s)，那么系统的灵敏度函数和余灵敏度函数分别为
S0(s)=I-G0(s)Q(s), T0(s)=G0(s)Q(s) .
考虑到R0(s)=C0(s)(I+G0(s)C0(s))-1=Q(s)=R(s),所以我们可以将时滞系统稳定裕度优化问题转化为一个如下的非时滞系统稳定裕度优化问题
　　　　　　　　　　　　　　　(14)
3.2　系统性能优化
　　下面考虑系统性能优化问题.设计步骤与单变量Dahlin控制器设计方法是类似的.首先，给定一个合适的系统闭环传递函数Td(s)，由于希望多变量系统是解耦的，因此Td(s)应是个对角矩阵
Td(s)=diag{td11(s)e-θd11s,td22(s)e-θd22s,…,tdnn(s)e-θdnns}.　　　　　　(15)
这里tdii(s)∈R(s), i=1,2，…，n.那么控制器的设计问题就是使系统的闭环传递函数等于Td(s).遗憾的是在一般情况下这点是无法做到的，我们只能要求系统的闭环传递函数尽量逼近Td(s)，即

在整个频带上进行这种逼近可能很困难，而且会引入大的保守性.一个合理的办法是引入权函数W2(s)使得系统闭环传递函数在一定的频带上逼近Td(s)，即
　　　　　　　　　　　　　　　(16)
这是一个模型匹配问题.一个自然的想法是把它也化为等价的无时滞系统的性能问题，当控制对象具有相同时滞时，对Td(s)做Hadamard分解
Td(s)=Td0(s).*Ed(s).　　　　　　　　　　　　　　　(17)
这里Td0(s)=diag{td11(s), td22(s),…, tdnn(s)}, Ed(s)=e-θdsI, θd=θd11=θd22=…θdnn.则有
‖W2(s)(T(s)-Td(s))‖∞=‖W2(s)(T0(s)-Td0(s))‖∞ .　　　　　　　　(18)
不仅如此，在后边的讨论中我们还会看到，对这类对象可以进行精确的模型匹配，使系统达到完全的解耦.遗憾的是对一般的情况目前还没有比较满意的方法.从工程实际的角度出发，可以采用足够高精度的有理函数逼近的办法来解决这个问题，类似的例子可以在文献［12，13］中找到，这主要是基于如下的理由.首先，对工程实际而言G(s)中的元素通常是一阶或二阶加纯滞后的传递函数，这些传递函数本身就是经过近似得到的，因而做适当的近似处理是允许的.其次，实际的控制对象总是存在着不确定性，与此相比有理函数逼近带来的误差是很小的.因此在问题没有得到更好的解决之前，这不失为是一个较好的折衷办法，它比Teng等的方法的保守性要小的多.
　　采用有理函数逼近必须在系统的标称性能上作出一定的让步，但由于对系统的稳定裕度进行了优化，所以本文的方法与以往的简单地采用有理函数逼近的方法是有本质区别的，这点可以在后边的设计实例中看到.由(14)式和(23)式可以得到多变量Dahlin控制器设计目标为
　　　　　　　　　　　　　　　(19)
在多变量的情形下求解Dahlin控制器，将系统的稳定性考虑进去是非常必要的，一方面当T(s)不能很好地逼近Td(s)时，我们希望闭环系统仍然是稳定的； 另一方面，当控制对象的参数发生摄动时，我们要求系统要有足够大的稳定裕度.如果只考虑模型匹配指标会使闭环系统具有非常差的鲁棒性［14］.
4　H∞多目标优化问题求解
4.1　控制对象具有相等时滞的情况
　　当控制对象具有相等时滞时，多变量Dahlin控制器的设计目标变为
　　　　　　　　　　　　　　　(20)
因为T0(s)=G0(s)Q(s)，若G0(s)是可逆的，取Q(s)=G0(s)-1Td0(s)就可以达到性能的完全匹配，这时闭环系统是精确解耦的.这个结论与Teng等在离散域中得到的结论是等价的，但是从模型匹配的角度来看非常直观，无需繁琐的证明.
　　在考虑到系统的不确定性时，可以使用下边介绍的方法设计控制器.
4.2　控制对象具有不等时滞的情况
　　当控制对象具有不等时滞时，可采用足够高精度的有理函数逼近的办法来解决(如Pade近似).为求解H∞多目标优化问题，首先把它等价为一个标准的H∞优化问题.考虑广义控制对象
　　　　　　　　　　　　　　　(21)
它关于C(s)的下线性分解变换(LFT)为

令
因为

所以
得到广义控制对象为
　　　　　　　　　　　　　(22)
如果各传递函数的实现为
　　　(23)
则

所以P(s)的一个实现为
　　　　　　　　　　　　　　　(24)
其中A∈Rp×p； B1∈Rp×m1; B2∈Rp×m2; C1∈Rp1×p; C2∈Rp2×p; D11, D12, D21, D22有相应的阶次.它们分别表示如下：


标准的H∞优化问题的求解过程就是要寻找一个控制器C(s)，使满足条件
　　　　　　　　　　　　　　　(25)
这里γ＞0是个常数.目前已经发展了一类有效的方法来解决这个问题.因此我们有如下的算法：
　　1) 对给定的问题确定权函数W1(s), W2(s)和期望的系统闭环传递函数Td(s)；
　　2) 选择适当大的初始值赋给γ；
　　3) 求广义控制对象的平衡实现以获得较好的数值条件；
　　4) 对广义对象H∞优化问题求解；
　　5) 如果解不存在，增加γ，返回3)；
　　6) 对控制器实施必要的降价，结束.
　　在本文中我们采用Glover和Doyle［15］提出的2-Riccati方程方法解决标准的H∞优化问题.其优点在于算法简单，计算量小，可以得到较低阶次的控制器.

5　设计实例
　　考虑一个造纸机定量水分控制系统.在生产78g防粘原纸时，按文献［16］中的方法建立的系统模型为
　　　　　　　　　　　　　(26)
选择权函数为

W1(s)是个高通滤波器，主要用于强调系统的高频不确定性，它将闭环系统的带宽限制在0.1rad/s. W2(s)是个低通滤波器，给出了适当的模型匹配要求.在低频段希望设计的闭环系统传递函数尽量接近希望的闭环系统传递函数，因此它的增益很高(图1).取希望的闭环系统传递函数为
　　　　　　　　　　　　　　　(27)


图1　设计要求(权函数)
当λ1和λ2趋向于零时就达到了完美控制.在实际中完美控制是做不到的，这里取λ1=λ2=5.按以上要求设计的闭环控制系统的回路特性如图2所示.由于得到的控制器具有12个状态，考虑到工程上的可实现性，需要对控制器进行降阶，降阶后的控制器为



图2　灵敏度函数和余灵敏度函数
其中
n11(s)=15.8436s3+909.6482s2+309.9057s+0.0947,
n21(s)=1.9703s3+97.1894s2-122.3365s-1.0486,
n12(s)=4.6130s3+310.4975s2+46.7891s-1.0199,
n22(s)=20.5378s3-4515.6190s2-1585.4215s+0.1126,
d(s)=s4+272.2374s3+12278.096s2+4.6842s+0.0268.
通过比较可以发现控制器降价前后系统的响应只有些微小的差别.现在假设控制对象发生了摄动，其时滞同时增加了25%，时间常数同时减少了20%， 这时系统仍能保持较好的响应(图3和图4).


图3　摄动系统定量阶跃响应


图4　摄动系统定量阶跃响应
　　对控制对象中的纯滞后项采用有理逼近后，有另外一种方法也可以求取控制器，即令Q(s)=G(s)-1Td(s)，这种直接设计的控制器对系统的不确定性会很敏感.图5给出了两种方法设计的系统的稳定裕度，虽然它们都能满足给定的鲁棒性设计要求，但是本文提出的方法在高频段具有非常大的稳定裕度，这使控制器对系统的高频不确定性很不敏感，控制器本身的降阶也能取得较好的结果.假设其他条件不变，只将鲁棒性设计要求修改为
　　　　　　　　　　　　　(47)


图5　加性稳定性裕度比较
那么直接方法设计的控制系统已不能满足要求(图6).


图6　修改后的加性稳定性裕度
6　结论
　　本文的主要贡献在于给出了一种从优化系统闭环传递函数出发设计控制器的新方法，而不是象以往的那样从最优干扰抑制入手求解控制器.H∞理论应用的一个主要困难是得到的控制器阶次过高，得先降阶再付诸实施，可是降阶算法只是设法逼近原来的控制器，却无法知道它对最终的控制效果究竟会造成什么影响，又是什么原因(如零极点位置)所起的作用.这一问题至今还没有得到很好的解决［17］.本文的方法避开了这个的问题，从优化系统的高频稳定裕度入手，使控制器降阶取得了较好的效果.文中以一个实际的控制对象为例进行了设计，证明了该方法的有效性.
1)　中国博士后科学基金和国家“九五”攻关项目资助.
作者简介：张卫东　男，1967年生于黑龙江.1990年毕业于浙江大学科仪系，1992年在浙大电机系获硕士学位，1993年至1996年在浙大工业控制研究所攻读博士学位，1996年6月开始博士后研究工作.作为第一作者发表论文近50篇.研究方向为过程控制理论、鲁棒控制理论及其应用.
　　　　　孙优贤　男，教授，博士导师，中国工程院院士.现任浙江大学工业控制技术研究所所长，国家重点实验室和国家工程研究中心主任.1984年至1987年获德国洪堡奖学金.长期从事过程控制理论和应用、鲁棒控制理论及应用、H∞控制理论及应用、容错控制理论及应用，以及造纸过程的模型化和计算机控制研究.获各类科技进步奖18项.
　　　　　许晓鸣　男，教授，博士导师.现任上海交通大学电子信息学院副院长.德国洪堡奖学金获得者.长期从事电气自动化、过程控制理论、鲁棒控制理论及应用和计算机网络研究，承担多项国家重点科研项目，发表学术论文150多篇，获各类科技进步奖3项.
作者单位：张卫东　孙优贤　浙江大学工业自动化国家重点实验室，工业控制研究所　杭州　310027
　　　　　许晓鸣　上海交通大学自动化系　上海　200030
参考文献
［1］　Dahlin E B. Designing and tuning digital controllers. Instrum.Control Systems, 1968, 41(7):77-81.
［2］　Higham J D. Single-term control of first-and second-order processes with time delay. Control, 1968, 2: 136-140.
［3］　王骥程，祝和云编.化工过程控制工程(第二版)，北京：化工出版社，1991.
［4］　Gopal M. Digital control engineering. New Delhi: Wiley 1988.
［5］　Leigh J R. Applied digital control. Englewood Cliffs NY: Prentice Hall, 1985.
［6］　Seborg D E, Edgar T F, Mellichamp D A. Process dynamics and control. NY: Wiley, 1989.
［7］　Astrom K J, Wittenmark W. Computer controlled systems. NJ:Englewood Cliffs, Prentice Hall, 1984.
［8］　Smith O J M. Feedback control system. NY:McGraw Hill, 1958.
［9］　张卫东，孙优贤.大纯滞后对象的H2次最优控制.控制理论与应用，1996，13(4)：496-499.
［10］　Teng F C, Ledwich G F, A C Tsoi. Extension of the Dahlin-Higham controller to multivariable systems with time-delays. Int. J. Control, 1994, 25(2):337-350.
［11］　Maciejowski J M. Multivariable Feedback Design. UK:Addison Wesley, 1989.
［12］　Laughlin D L, Rivera D E, Morari M. Smith predictor design for robust performance. Int. J. Control, 1987, 46(2):477-504.
［13］　Stahl H, P Hippe. Design of pole placing controllers for stable and unstable systems with time delay. Int. J. Control, 1987, 45(6):2173-2182.
［14］　Ho D W C, J Lam, T W K Chan. An application of H∞ design to model-following. Int. J. Control, 1992, 55(2):483-509.
［15］　Glover K, Doyle J C. State space formulae for all stabilizing controllers that satisfy an H∞ norm bounded and relations to risk sensitivity. System & Control Letters, 1988, 8(11):167-172.
［16］　张卫东，孙优贤.纸机定量水分控制通用模型―(Ⅰ)模型的建立.信息与控制，1996，25(1)：25-43.
［17］　张卫东，孙优贤.频域控制理论的发展及其取得的成就.控制与对策，1996，11(2)：242-249.
收稿日期　1996-01-12
