自动化学报
ACTA AUTOMATICA SINICA
2000　Vol.26　No.1　P.68-73



基于HM非线性模型的滚动时域H∞控制
耿晓军 席裕庚
摘 要 基于HM (Heterogeneous Model)非线性系统模型，提出并研究了滚动时域H∞控制器的设计.给出了基于H∞性能指标的最优控制律和其存在的充分性条件，该控制律可以保证系统稳定和干扰衰减增益不超过某一上限.然后，为了减少计算量,设计了有上述相同性能保证的次优控制器.
关键词 滚动时域控制，H∞控制，非线性系统，预测控制.
RECEDING HORIZON H∞ CONTROL BASED ON HM
NONLINEAR MODEL
GENG Xiaojun XI Yugeng
(Institute of Automation, Shanghai Jiaotong University, Shanghai 200030)
Abstract This paper concentrates on the problem of receding horizon H∞ control for a family of nonlinear systems that can be represented by a heterogeneous model (HM). Under H∞ performance index, the sufficient conditions arederived for the optimal controller which guarantees the stability with disturbance attenuation. Then, in order to reduce the computational burden, a suboptimal controller which can guarantee the same system performance is designed.
Key words Receding horizon control,H∞ control, nonlinear systems, predictive control.
1 引 言
　　70年代末Kwon等［1］针对线性时变系统，提出了一种稳定的控制策略――带终端约束的滚动时域控制(CRHC).90年代以来，Mayne等［2］将其思想扩展到非线性系统，并证明在一定假设条件下系统闭环稳定.在要求控制系统稳定的同时，人们往往还希望系统性能优良.H∞控制正是如此，它要求控制输出对扰动输入的增益能够不超过某个上界.结合滚动时域控制和H∞控制，本文提出并研究了一类有扰动非线性系统的滚动时域H∞控制.
　　本文内容共分4节，在第2节中将给出系统的模型和问题的描述.第3节是本文的主要工作部分，首先基于H∞性能指标给出滚动时域H∞最优控制律及其存在的充分性条件，然后为了求解方便，利用HM非线性模型的特点，得到了该问题的次优控制器.该控制器同最优控制器一样可以保证系统稳定和干扰衰减增益小于某一上限的性能要求.第4节是结束语.
2 问题描述
2.1 非线性系统HM模型
　　实际系统的全局数学模型常常难以得到.本文采用由如下一系列局部模型集结而成的HM近似非线性模型［3］
　(1)
其中Rl表示第l个局部区域，为系统(1)的第l个子系统，x(t),u(t),w(t),z(t),yl(t)分别为第l个子系统的状态、输入，扰动、输出和量测变量，w(t)∈L2［0,∞).令GT［F G］=［0 I］.
　　系统的全局近似模型表示如下：
（2）
这里其余类似，为特征基函数，μ∈M,M为特征基函数的集合，且
　　下面引入标称模型系统(2)重写为
　(3)
这里 其余ΔB(μ(t))，ΔC(μ(t))，ΔD(μ(t))，ΔH(μ(t))的表达式与ΔA(μ(t))类似.
　　对于系统HM的建立，包括局部区域的划分、基函数的选取、子系统结构参见文［4］.
2.2 滚动时域H∞控制策略
　　本文选取如下的滚动时域性能指标：

s.t　x(t+T)=0　(4)
其中λ>0，Q，R均为正定方阵，R可逆.x(t+T)=0为滚动时域控制的终端约束项，(4)式中后半部分为常用的min-max干扰衰减性能指标，前半部分是为兼顾系统的动态响应性能而设计的.总的来说它意味着在每一时刻t要找到一个稳定的控制律u(τ)，τ∈［t,t+T］，使系统在最坏的干扰情况下性能最优，同时只将u(t)作为实施于系统的控制量.
3 主要结果
3.1 滚动时域H∞控制问题的最优解
　　在线性系统滚动时域H∞控制基础上［5］，给出系统(2)在性能指标(4)下的最优解和其存在的充分性条件.
　　定理1. 如果存在正实数γ，T，λ，使微分Riccati方程
　(5)
边界条件为P(t+T,t+T)=0，存在一致有界对称正定阵P(τ,t+T),t≤τ≤t+T，并且P(t,t+T)-1存在且一致有界，则系统(2)稳定，且干扰衰减增益满足相应的最优控制律u(t)=K(μ)x(t)=-(λR+I)-1BT(μ)P(t,t+T)-1x(t)，其中
　(6)
　　证明.沿用文［5］的证明思路，我们同样令V=xT(t)P(t,t+T)-1x(t).
　　1)首先证明系统的闭环稳定性(w=0时).由(5)有下式成立：

P(t+T,t+T)=0保证了半正定［5］,故上式最后一项非正.并注意到(6)式，有

对V求导，并将上式代入，可得到

因此系统闭环渐近稳定.
　　2)下面考虑闭环系统的干扰衰减性质.由于闭环渐近稳定，对于任意初值x(t0)和w∈L2［0,∞)，有x(∞)=0，于是

上式中‖.‖为L2［t0,∞)范数，记令x(t0)=0，则有

　　该定理表明，只要(5)式有可行解，滚动时域H∞控制在性能指标(4)式下的最优控制律即可由(6)式得到.(5)式虽然形式上是偏微分方程，但其第二个参数是固定值t+T，因此完全可以同微分方程一样数值积分求解.然而，在计算(5)式的过程中，任一时刻t+τ时，(5)式中系数A(μ)，B(μ)，H(μ)皆依赖于x(t+τ)，而x(t+τ)又依赖于u(t+τ)，这样就形成了一个迭代过程.在每一时刻要求解u(t)，都需要许多这样的迭代过程，计算量非常大.
　　于是，本文下面的工作从实际可行性出发，试图找寻原控制问题的一个满足控制性能要求的次优解.
　　为此，在定理1基础上，首先针对系统(3)的标称模型
　(7)
给出下面改进的充分性条件.
　　推论1. 对于系统(7)，如果存在正实数γ和T，使下面微分Riccati不等式有解，
　(8)
边界条件P(t+T,t+T)=0，P(τ,t+T)性质同定理1，则系统(7)稳定，且有
　(9)
且控制律为
　　证明.证明过程可参照定理1，故略.
　　推论1说明将定理1中的微分Riccati方程(5)放松为上述Riccati微分不等式(8)后，所得到的控制律仍然可以实现和定理1的最优控制律相同的控制目的.
3.2 滚动时域H∞控制问题的次优解
　　首先引入下面的上界概念［3］
　(10)
其中M为基函数的集合.ETE即为ΔA(μ)TΔA(μ)的上界.寻求上界的方法可参考文［3］.类似地我们可以得到B(μ)(λR+I)-1B(μ)T的下界和H(μ)H(μ)T的上界.分别记为
　(11)
　(12)
　　由文［3,4］可知，由于标准基函数的性质，这里得到的上下界都是与状态量无关的常量.
　　定理2. 对于系统(2)，如果存在正实数T，γ，ε，δ，使下面微分Riccati方程有解，
　(13)
边界条件P(t+T，t+T)=0,P(τ,t+T)性质同定理1，则系统(2)稳定，系统性能满足式(9).反馈控制律形同式(6).
　　证明. 在不发生混淆的情况下，下面记P(τ,t+T)为P.将(6)式代入系统(2)，得到闭环系统.
　　1)对于闭环控制系统，令Lyapunov函数V=xT(t)P(t,t+T)-1x(t).
　(14)
利用式(10)～(12)，及故闭环稳定.
　　2)由于闭环渐近稳定，对于任意初值x(t0)和w∈L2［0,∞)，有x(∞)=0.积分式(14)，计算x(t0)=0时系统的干扰衰减增益如下：

　　由定理2可知，在t时刻，只要根据将来有限时域［t,t+T］内ΔA(μ)TΔA(μ)，H(μ)H(μ)T的上界和B(μ)(λR+I)-1B(μ)T的下界，以及某一恰当的ε，δ，我们就可以通过积分求解(13)式，得到当前时刻相对性能指标(4)式的一个次优控制律u(t)，该次优控制律可以保证系统稳定，且干扰增益小于γ.
　　当优化时域长度T→∞时，上述滚动时域H∞控制器等价于文［3］的H∞控制器，而这时求解控制器需要整个时域内的系统参数，由于实际系统往往有许多不确定和不可长期预测的因素，因此，本文提出的滚动时域H∞控制器具有更强的实用性.
　　类似文［3］中H∞控制律的算法设计，我们同样可以给出定理2中控制律的求解过程.基本思想是先假定ε和δ的值，从t+T时刻逆向求解(13)式，得到P(t,t+T).若P(t,t+T)满足条件，则可求出u(t).否则，依次减小ε和δ的值，直到找到符合条件的解.
4 结束语
　　本文基于HM非线性模型，提出并研究了滚动时域H∞控制器的设计.定理1给出的结论是基于性能指标的H∞最优控制器的充分条件.为了解决求解问题，定理2给出次优控制器及其算法.该控制器可以满足系统稳定和干扰衰减的性能要求.本文研究的滚动时域H∞控制器结合了滚动优化的预测控制和H∞控制，因而它一方面可以依据将来有限时段的系统信息在线滚动地设计控制律，克服了系统信息不可长期预测性，另一方面它采用H∞性能指标，在设计控制器时考虑了扰动影响，保证了干扰衰减增益在某一设定范围内.
国家自然科学基金重点项目资助(69934020).
耿晓军 女，1972年生.1996年于西北工业大学获工学硕士，现为上海交通大学自动化系博士研究生.主要从事非线性预测控制的研究.
席裕庚 男，1946年生.1968年毕业于哈尔滨军事工程学院，1984年在德国获工学博士学位，现为上海交通大学自动化系教授，博士生导师.著有动态大系统方法导论，预测控制等书.主要从事复杂系统控制理论的研究.目前主要研究领域是复杂工业过程的优化控制及智能机器人控制.
耿晓军(上海交通大学自动化研究所 200030)
席裕庚(上海交通大学自动化研究所 200030)
参考文献
1，Kwon W H, A E Pearson. A modified quadratic cost problem and feedback
stabilization of a linear system. IEEE Trans. Autom. Control,1977，AC22(5):838～842
2，Mayne D Q, H Michalska. Receding horizon control of nonlinear systems.IEEE 
Trans. Autom. Contr.,1990，AC35(7)：814～824
3，Feng G, S G Cao, N W Ress. An approach to H∞ control of nonlinear systems.Automatica, 1996，32(10)：1469～1474
4，Cao S G, G Feng. Modeling of complex control systems. In:Proc.IFAC NOLOCOS'95
,1995：935～938
5，Tadmor G. Receding horizon revisited:an easy way to robustly stabilize an LTV
system.Systems & Control Letters,1992，18：285～294
收稿日期 1998-06-19 收修改稿日期 1999-02-12
