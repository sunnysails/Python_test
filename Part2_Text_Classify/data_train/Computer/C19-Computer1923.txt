微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000　Vol.19　No.6　P.18-19




电子商务及其安全体系
许大为
摘要：在介绍电子商务的基础上，讨论了有关电子商务安全体系的手段和标准，进而对中国电子商务的发展提出了一些建议。
关键词：Internet 电子商务 安全 加密 认证
1  电子商务概述
　　所谓电子商务，就是指通过计算机网络(互联网)提供的通信手段在网上进行电子交易。这里买主有了广大的新视野，在网上可以从数以万计的供应商中，借助搜索引擎，选择中意的商品或服务。卖方可以在网上建立网页(Home Page)，这些网页可以随设立者的目的，提供各种各样的功用，可以有最简单的商品广告，可以有文字、图像、声音说明、性能示范等高度互动的多媒体商业活动。
　　据报道，1995～2000年，全球电子商务营业额预计达到250亿美元。预计2000～2010年，网上交易额将上升至4500亿～6000亿美元。由此可见，电子商务的发展是未来25年内世界经济发展的主要推动力。
　　影响用户网上交易的最主要原因就是电子商务的安全性。因此尽管电子商务的发展前景非常诱人，但如何建立一个安全可靠的网络应用环境，已经成为商家必须考虑的问题，也是电子商务的一个技术难点。
2  电子商务的安全性要求
　　电子商务发展的核心和关键问题是交易的安全性。由于Internet本身具有开放性，使网上交易面临种种危险。其中主要包括：
　　(1)信息泄露。在商务活动中，A公司与B公司进行交易如果不采取保密措施，那么其他人（公司）就有可能非法看到他们的商务信息。如信用卡的帐号和用户名被人获悉，就可能被盗用；如供应商的价格和数量被竞争对手获悉，就有可能丧失商机。
　　(2)识别。当A公司与B公司进行商务交易时，如果A公司的终端上显示“我是B公司”时，A公司如何相信与他交易的就是B公司而不是其它公司呢？同样，B公司又如何相信与他交易的就是A公司而不是其它公司呢？这就牵涉到一个用户识别的问题。
　　(3)篡改。如果A公司与B公司签定了一份由B公司向A公司供应石油工业1000t，单价＄10／t的合同后，适逢全球油价大幅上涨，B公司如能改动其合同数量，将原来1000t改为10t，则B公司可大幅受益，而A公司就可能因此蒙受损失。
　　(4)蓄意否认事实。由于商情的千变万化，商务合同一旦签成就不能被否认，否则必然会损害一方的利益。如果A公司向B公司定购石油，订货时油价较低，但收到订单后，油价上涨，如果B公司单方面否认收到订单的实际时间，甚至于否认收到订单的事实，则A公司就会蒙受损失。
　　因此，电子商务就提出了相应的安全控制要求：
　　(1)信息保密性。在电子商务在信息传播过程中，一般均有加密的要求，以保证诸如用户信用卡帐号、订单数量、供货价格等商业机密的安全。
　　(2)交易者身份的识别。对于进入网上交易的客户，系统必须检验其合法性，若其不是实际交易的参与者，系统将不准进入，以免出现其它公司假冒交易公司的事情出现。
　　(3)不可修改性。交易合同的文件不可被随意修改，以保障交易的严肃和公正。
　　因此，为了保证电子商务活动的安全性，必须有一套有效的安全机制作为保证，这就要建立电子商务安全基础结构。
3  电子商务的信息安全体系
　　概括起来，电子商务的信息安全体系可以分为以下几个层次：基本加密算法、安全认证手段和安全应用协议，如图1所示。

图1  电子商务信息安全体系
3.1 几个著名的安全交易协议标准
　　在早期的电子交易中，曾采用过一些简单的安全措施，包括：
　　(1)部分告知（Partial Order）。即在网上交易中将最关键的数据如信用卡号码及成交数额等略去，然后再用电话告之，以防泄密。
　　(2)另行确认（Order Confirmation）。即当在网上传输交易信息之后，应再用电子邮件对交易作确认，才认为有效。
　　(3)在线服务（Online Service）。为了保证信息传输的安全，用企业提供的内部网来提供联机服务。
　　这些方法，均有一定的局限性，且操作麻烦，不能实现真正的安全可靠性。
　　近年来，针对电子交易安全的要求，IT业界与金融行业一起，推出不少有效的安全交易标准。主要有：
　　(1)Digicash。 Digicash是一个匿名的数字现金协议。所谓匿名是指消费者在消费中不会暴露其身份，例如现金交易（虽然钞票有号码，但交易中一般不会加以记录）。该协议的步骤如下：
　　①消费者从银行取款，他收到1个加密的数字钱币（Token），此Token可当钱用；
　　②消费者对该Token作加密变换，使之仍能被商家检验其有效性，但已不能追踪消费者的身份；
　　③消费者在某商家消费即使用该Token以购物或购买服务，消费者进一步对该Token用密码变换以纳入商家的身份；
　　④商家检验该Token以确认以前未收到过此Token；
　　⑤商家给消费者发货；
　　⑥商家将该电子Token送银行；
　　⑦银行检验该Token的唯一性。至此消费者的身份仍保密。除非银行查出该Token被消费者重复使用，则消费者的身份将会被暴露，消费者的欺诈行为也暴露了。
在以上的第③步若发生了通信故障，则消费者无法判断商家究竟是否已收到该电子Token。此时消费者有2种选择：将其电子Token返回给银行或到另一商家处消费。如果消费者这样做了，而商家事实上在第③步已收到了该Token，则当商家去银行将该Token兑现时会发现该Token的重复使用。如果消费者不采取行动，既不另行消费也不退还给银行，而商家在第③步事实上未收到该Token，则商家自然不会发货。这样一来，消费者既未收到所购之物，也未花费该电子钱币，肯定受到了损失。可见该数字现金协议是有缺陷的。
　　(2)First Virtual。允许客户自由地购买商品，然后使用E－mail同客户证实每一笔交易。FirstVirtual对通信安全持怀疑态度并采取某种加密形式，并将每个电子商务交易转换为信用卡交易。First Virtual比Digicash要好一些，但比其它电子商务系统要差。
　　(3)SSL。安全套接层协议SSL（Secure Sockets Layer）提供加密认证服务和报文完整性。它是由Netscape提出的安全交易协议。SSL使用加密的办法建立一个安全的通信通道以便将客户的信用卡号传送给商家，它等价于使用一个安全电话连接将用户的信用卡通过电话读给商家。SSL提供3种基本安全服务：
　　①信息私密：通过使用公开密钥和对称密钥技术达到信息私密。SSL客户机和SSL服务器之间的所有业务使用在SSL握手过程中建立的密钥和算法进行加密，这样就防止了某些用户通过使用IP Packet Sniffer工具非法窃听、破译。
　　②信息完整性：确保SSL业务全部达到目的。SSL利用机密共享和HASH函数数组提供信息完整性服务。
　　③相互认证：即客户机和服务器相互识别的过程。它们的识别号用公开密钥编码，并在SSL握手是交换各自的识别号。这样就防止其他用户冒名顶替使用证明。
这一协议当然不能防止心术不正的商家的欺诈，因为该商家掌握了客户的信用卡号。商家欺诈是信用卡业所面临的最严重的问题之一。
　　(4)SET（Secure Electronic Transaction）。它是Visa和MasterCard联合开发的一个协议，它具有很强的安全性。该协议由若干以前发表的协议形成，它们是：STT（Visa／Microsoft）、SEPP（MasterCard）和iKP协议族（IBM）。SET及其适合的诸协议是基于安全信用卡协议的一个例子。按照SET，客户将采购请求和价格进行数字签名，然后用银行公共密钥将付款信息（例如信用卡号）加密。商家认可该采购并将该请求传给银行。银行加工该请求，若价格匹配，则银行对客户的帐号扣款并指令商家完成该笔买卖。
　　SET为电子商务提供以下功能：
　　①付款数据私有化和订货信息与付款信息、传送的保密化。
　　②验证持卡人的信用卡帐目，这是由数字签名和持卡人证书完成的。验证工作与收款机构共同进行。厂商验证工作由数字签名和厂商证书完成。
　　③保留付款信息集成，这是由数字签名完成。
　　④特别用途证书。
　　SET的安全性超过SSL，它可防止商家欺诈。但SET协议不同寻常地复杂，该协议的描述有几百页之多。
　　(5)Netbill。卡内基.梅隆大学（现加州大学克利分校）的J.D.Tygar教授的研究组开发了Netbill协议，并正和CyberCash、MellonBank和VisaInternational一起在卡内基.梅隆开发Netbill的Alpha版。该协议已获得CyberCash的商业用途许可，CyberCash的CyberCoin协议也使用Netbill的方法。Netbill协议涉及客户、商家及Netbill服务器三方。客户持有的Netbill帐号等价于1个虚拟电子信用卡帐号。协议步骤如下：
　　①客户向商家查询某商品价格；
　　②商家向该客户报价；
　　③客户告知商家接受该报价；
　　④商家将所请求的信息商品(例如1个软件或一首歌曲)用密钥K加密后发送给客户；
　　⑤客户准备1份电子采购订单（EPO：ElectronicPurchaseOrder），即三元式（价格、加密商品的密码单据、超时值０的数字签名值，客户将该已数字签名的EPO发送给商家；
　　⑥商家会签该EPO，同时也签上K的值，然后将此二者送给Netbill服务器；
　　⑦Netbill服务器验证EPO签名和会签，然后检查客户的帐号，保证有足够的资金以便批准该交易，同时检查EPO上的超时值看是否过期。确认没有问题时，Netbill服务器即从客户的帐号上将相当于商品价格的资金划往商家的帐号上，并存储密钥K和加密商品的密码单据。然后准备1份包含值K的签好的收据，将该收据发给商家；
　　⑧商家记下该收据单传给客户，然后客户将第4步收到的加密信息商品解密。
　　Netbill协议就这样传送信息商品的加密拷贝，并在Netbill服务器的契据中记下解密密钥。
所有这些安全交易标准中，目前应用较多的是SSL和SET协议。一般认为SET协议安全性较好，可以推广利用信用卡支付网上交易，必将成为网上交易安全通信协定的产业标准，但SET协议在实际应用中并不理想。SET的证书格式比较复杂，使用成本高，其支付方式和认证结构适用于卡支付，对其它支付方式是有限制的。另外SET并不能真正提供不可否认性。实际上，SET在美国只有10％的使用率(在国际上SET协议用得较多的国家是丹麦、南非和西班牙)。相对于SET，SSL近年来发展较好，目前随着高位加密的SSL协议(如SSL－128)开发成功，在美国SSL协议已逐步取代SET协议。但SSL协议不支持数字签名、不具有抗否认的特性，一定程度上限制了它的应用。
电子商务安全体系中的加密算法：
　　(1)常规加密算法。常规加密算法即加密密钥与解密密钥是相同的，它有代替密码、置换密码和数字密码等。常规加密算法设计简单，比较容易破译，已不适用了。
　　(2)对称密钥算法。对称密钥算法的加密过程Ek和解密过程Dk使用同1个密钥K，具有Dk(Ek(P))＝P的特性，又称为共享密钥加密算法。
　　其典型代表是DES(数据加密标准)算法，DES体制由IBM公司研制出，于1977年被美国定为联邦信息标准。
　　DES对64位二进制数据加密，产生位密文数据，使用的密钥为64位，实际密钥长度为56位(有8位用于奇偶校验)。由于该算法结构做得复杂，有较长的密钥，不但速度快、而且破译难，所以使用非常普及。
　　(3)不对称密钥加密算法。该算法也称为公开密钥加密算法，即加密密钥与解密密钥不同，由已知加密密钥(Ke)来推导解密密钥(Kd)，它是由Diffie和Hellman于1976年提出的。
该算法解决了对称密钥加密算法中密钥量多难管理及费用高的不足，而且适应数字签名的需求。
这类算法的典型代表是RSA算法，RSA算法是根据寻求2个长素数比较简单，而将它们的乘积分解开则极其困难这一原理来设计的。RSA系统非常适用于制作数字特征和加密应用。
3.2 安全认证手段
　　(1)数字摘要(digital digest)。这种编码法采用单向Hash函数，将需要加密的信息原文通过特定的变换后，“摘要”成一串128 bit的密文。这串密文又称数字指纹(Finger Print)，它是有固定的长度的一段代码，而且，对于不同的信息原文，将它摘要成密文后的结果总是不同的，而同样的信息原文所形成的摘要必定是一致的。这样，利用这段摘要，就可以验证通过网络传输收到的文件是否是初始、未被非法篡改的文件原文了。
　　(2)数字签名(digital signature)。公开密钥的加密机制虽提供了良好的保密性，但难以鉴别发送者，即任何得到公开密钥的人都可以生成和发送报文。数字签名机制提供了一种鉴别方法，以解决伪造、抵赖、冒充和篡改等问题。
　　数字签名一般采用不对称加密技术(如RSA)，通过对整个明文进行某种变换，得到一个值，作为核实签名。接收者使用发送者的公开密钥对签名进行解密运算，如其结果为明文，则签名有效，证明对方的身份是真实的。当然，签名也可以采用多种方式，例如，将签名附在明文之后。数字签名普遍用于银行、电子贸易等。
　　数字签名不同于手写签字，数字签名随文本的变化而变化，手写签字反映某个人个性特征，是不变的；数字签名与文本信息是不可分割的，而手写签字是附加在文本之后的，与文本信息是分离的。
　　(3)数字信封（digital envelop）。数字信封是用密码技术的手段保证只有规定的收信人才能阅读信的内容。在数字信封中，信息发送方使用密码对信息进行加密，再利用RSA算法对该密码进行加密，被RSA算法加密的密码部分称数字信封。
　　(4)数字时间戳（digital time－stamp）。交易文件中，文件签署的时间是十分重要的信息。在书面合同中，文件签署日期和签名一样都是十分重要的，是防止文件被伪造和篡改的关键性内容。在电子商务中，同样需要对交易文件的日期和时间信息采取安全措施，而数字时间戳服务（DTS）的提出为电子文件发表时间提供安全保护和证明。
　　DTS是网上安全服务项目，由专门的机构提供。时间戳是一个经加密后形成的凭证文档，它包括3个部分：
　　①需要加时间戳的文件的摘要；
　　②DTS机构收到文件的日期和时间；
　　③DTS机构的数字签名。
　　时间戳产生的过程：用户首先将需要加邮戳的文件用HASH编码加密后形成摘要，然后将该摘要发送到DTS，DTS在加入了收到文件摘要的日期和时间信息后再对该文件加密（数字签名），然后送回用户。
　　(5)数字凭证（digital ID）。数字凭证又称为数字证书，是用电子手段来证实一个用户的身份和对网络资源的访问权限。在网络上的电子交易中，如双方出示了各自的数字凭证，并用它来进行交易操作，那么双方都可不必为对方身份的真伪担心。
　　数字凭证的内部格式由CCITTX.509国际标准所规定，格式如表1所示。
表1  数字凭证的内部格式
版本(Version)
数字凭证的序列号（Serial number)
颁发数字凭证单位的数字签名参数(Algorithm ID―parameters)
颁发数字凭证的单位(Issuer name)
公共密钥的有效期(Validity period)
凭证拥有者的姓名(Subject name)
凭证拥有者的公共密钥(Subject public key―algorithm)

　　数字凭证有3种类型：
　　①个人凭证（Personal Digital ID）。它只是为某个用户提供凭证，以帮助其个人在网上进行安全交易操作。个人身份的数字凭证通常是安装在客户端的浏览器内，并通过安全的电子邮件（S MIME）来进行交易操作。
　　②企业（服务器）凭证（Serve ID）。它通常为网上某个Web服务器提供凭证，拥有网上服务器的企业就可以用具有凭证的Internet站点来进行电子交易。有凭证的Web服务器会自动地与客户端Web浏览器通信的信息加密。
　　③软件（开发者）凭证（Developer ID）。它通常为Internet中被下载的软件提供凭证，该凭证用于与微软公司Authenticode技术（合法化软件）结合的软件，以使用户在下载软件时能获得所需的信息。
　　(6)认证中心（CA：Certification Authority）。认证中心是承担网上安全电子交易认证服务、能签发数字证书、并能确认用户身份的服务机构，是一个具有权威性、公正性的第三方。通常是企业性的服务机构，主要任务是受理数字凭证的申请、签发及数字凭证的管理。认证中心依据认证操作规定（CPS：Certification Practice Statement）来实施服务操作。CA的主要功能是：
　　①生成电子证书；
　　②对电子证书和数字签名进行验证；
　　③对电子证书进行管理，重点是证书撤消管理(CRL)，同时要追求实施自动管理(非人工管理)；
　　④建立应用接口，特别是支付接口。
4  安全认证有关的其它问题
4.1 内部管理
　　据最近调查表明，至少有75％的信息安全问题来自内部。认证中心（CA）作为第三方，如果对参与认证的用户和企业不能做到公正、权威的话，后果不堪设想。在信用卡和商业诈骗中，内部人员所占的比例最大。一个完整的安全策略的制定不仅要考虑如何防止外部对本网的攻击，也要考虑如何防止内部人员的破坏。
4.2 电子商务的相应法律法规
　　电子商务不同于普通商务。普通商务中签定的商务合同法律予以保障，人工签名也是普遍接受的。而电子合同法律是否承认，对于数字签名法律是否给予人工签名同样的认可，法律如何仲裁电子交易纠纷，消费者权益保护法是否适用与电子商务等等，这些，都需要制定相应的法律法规。只有这样，才能为电子商务的安全提供法律保障。
5  总  结
　　我国作为最大的发展中国家，应该充分认识到大力发展电子商务的重要性。一方面在政策上加强政府部门对发展电子商务的宏观规划和指导，并为电子商务的发展提供良好的法律法规环境；另一方面，要在技术上保证电子商务的安全性。在发展电子商务的过程中，应坚持建立中国自己的安全防范系统，而不应该片面照搬西方国家的安全系统。因为，国内几乎所有的主机、交换机、路由器、网络操作系统都来自国外，而且美国对别国采取歧视态度，对中国实行密钥信前控制和限制长密钥产品出口。因此，我们必须研制自己的加密算法，建立自己的CA认证中心，以保证中国电子商务的正常发展。
许大为（南京河海大学国际工商学院210029）
参考文献
1，Hanilton S．E－commence for the 21st Century．IEEE Computer，1997；（5）
2，Jutla D．Making Business Sense of Electronic Commence．IEEE Computer，1999；（3）
3，Soon－Yong Choi，Andrew B．Whinston The Future of E－commence：Integrate and Customize．IEEE Computer，1999；（7）
4，Electronic Commerce Project grouping．Accelerating Electronic Commerce in Europe 2nd Edition，1998
5，http：／／www．commerce．org／
6，http：／／www．ispo．cec．be／ecommerce／
7，杨义先．电子商务中的安全问题．世界电信，1999；（1）
8，许榕生．电子商务实用指南．北京：机械工业出版社，1999
收稿日期：1999－12－10
