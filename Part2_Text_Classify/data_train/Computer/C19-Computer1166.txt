自动化学报
ACTA AUTOMATICA SINICA
1999年 第25卷 第6期 Vol.25 No.6 1999



多尺度脊边缘及其在图像目标
分割中的应用1)
宋焕生　刘春阳　吴成柯　梁德群
关键词　边缘检测，目标分割，屋顶状边缘，多尺度.
MULTI-SCALE RIDGE EDGES AND THEIR APPLICATIONS
IN OBJECT SEGMENTATION
SONG Huansheng
(National Key Laboratory of Integrated Services Networks, Xidian University, Xi'an　710071)
LIU Chunyang
(Space Center of the Chinese Academy of Sciences, Beijing　100080)
WU Chengke
(National Key Laboratory of Integrated Services Networks, Xidian University, Xi'an　710071)
LIANG Dequn
(Image Research Institute of Xi'an Jiaotong University, Xi'an　710049)
Key words　Edge detection, object segmentation, ridge edge, multi-scale.
1　引言
　　到目前为止，关于边缘的研究主要是针对阶跃边缘，而对屋顶状边缘(以下简作脊边缘)则研究甚少.但是在一些实际应用中，如果我们主要关心的是呈屋顶状的目标，那么从脊边缘入手进行分析，往往要比从常用的阶跃边缘出发更容易把握目标的本质.图1给出一个具有代表性的例子，这里的目的是分割出图1(a)中对应焊缝缺陷的局部发“亮”的斑状和线状区域.文献［1］采用的办法是首先检测原图的阶跃边缘，然后从中取出焊缝缺陷的对应者，并由此出发完成目标区域分割的目的.然而正如从图1(b)中看到的，要想从这些交织在一起的阶跃边缘中取出对应于焊缝缺陷的部分是相当困难的.在图1(c)中显示的脊边缘则是完全另一种情形，这是我们将在后面提出的多尺度脊边缘中大致与缺陷大小相当的一个尺度.在这里给出的对应于焊缝缺陷的脊边缘如此明确清晰，这是任何基于阶跃边缘的算法［3］所望尘莫及的.


(a)焊缝图像


(b)阶跃边缘


(c)脊边缘


(d)基于脊边缘的分割结果
图1　焊缝图像的阶跃边缘、脊边缘和基于脊边缘的分割结果
2　脊边缘及其检测
　　考察几种比较典型的脊边缘在正交截面上对应的一维信号f(x)(如图2所示)，可以看到，脊边缘位置与f(x)一阶导数的零交叉或二阶导数极值点对应，然而并非所有二阶导数极值点都对应于脊边缘，所以不能用二阶导数极值点而只能用一阶导数的零交叉确定脊边缘的位置.此外，为了剔除脊边缘中次要的和由噪声产生的无意义的部分，除了对脊边缘的位置描述，还需要关于它的强度描述.由于脊边缘表现为f(x)由增加到减少(或由减少到增加)的转折，这种转折的方向(向上凸或向下凹)和剧烈程度大小分别反映为f(x)二阶导数的正负符号和绝对值，所以可以用一阶导数零交叉处的二阶导数描述脊边缘的强度，其中强度为正代表“暗”的脊边缘，强度为负代表“亮”的脊边缘.f(x)的导数实际上就是图像在脊边缘法线方向的方向导数，所以脊边缘的描述涉及二个内容：一个是脊边缘的法线方向；另一个是在法线方向上的一阶和二阶导数.


图2　脊边缘与一、二阶导数的关系
　　在脊边缘位置上，脊边缘的法线方向为二阶方向导数取到极值的方向.用f(i,j)表示图像信号，αm(i,j)表示在(i,j)点上图像二阶方向导数取到极值的方向1)，则图像脊边缘描述为：1)如果图像在(i,j)位置上沿αm(i,j)方向的一阶方向导数为零交叉点，那么(i,j)为图像脊边缘位置；2)如果(i,j)为脊边缘点，那么该点上脊边缘的强度为图像在(i,j)位置上沿αm(i,j)方向的二阶方向导数.
　　
　　1)本文中的方向都指相对水平坐标轴i的逆时钟旋转角度.图像沿α方向的方向导数为
　　(1)
由于在αm(i,j)方向，f″α(i,j)取到极值，所以
　　(2)
αm(i,j)的取值范围为(-π/2,π/2)，所以
　　(3)
图像f(i,j)沿αm(i,j)的一阶和二阶方向导数分别为
f′αm(i,j)=fisinα+fjcosα,　　(4)
f″αm(i,j)=fiisin2α+fijsinαcosα+fjjcos2α.　　(5)
在(3～5)式中
　　(6)
　　对数字图像信号，以上微分表示在实际计算中可以用差分近似代替，因此(4)和(5)式在实际应用中的计算是方便的.
3　多尺度脊边缘
　　多尺度脊边缘是指从若干个尺度下的平滑图像中分别提取出的脊边缘的总体.脊边缘在尺度空间的响应具有较好的局部化特点.这里仍然以焊缝图像为例来说明脊边缘的这一特点，图1(b)和(c)所示为与焊缝缺陷大小相当的尺度上的强度大于某阈值的阶跃边缘和脊边缘，我们看到，有较强强度的脊边缘主要对应于与当前尺度有相当大小的目标，而另一些大目标(如焊缝自身)却由于在当前的尺度上强度较小而没有出现在图1(c)中.与此形成鲜明对比，图1(b)中的情况则完全不同，各种大小的目标由于在当前尺度都有较强的响应而在图1(b)中混杂在一起.脊边缘的这一特点决定了它在分割具有特定大小的目标时比阶跃边缘更为优越.
　　Mallat［4，5］证明，基于B样条的小波变换等于对图像进行多尺度平滑后的水平和垂直方向的一阶方向导数，也就是各个2进尺度上的小波变换等于相应尺度上的fi和fj，而从fi和fj出发又可直接计算fii,fij和fjj，所以我们可以利用Mallat快速算法完成(3～5)式的计算，从而实现多尺度脊边缘的快速计算.

4　基于脊边缘的尺度空间滤波及应用实例
　　文献［6］研究了基于阶跃边缘的尺度空间滤波算法，这种算法可以推广为基于脊边缘的尺度空间滤波器，具体算法如下：
　　1)利用Mallat算法，对图像作二进小波分解；
　　2)从二进小波变换出发，计算在二进尺度空间的多尺度脊边缘及其强度；
　　3)在尺度空间进行脊边缘跟踪，建立脊边缘在尺度空间的对应关系，然后利用脊边缘在尺度空间的协调关系和脊边缘的强度选出重要的脊边缘，滤除由不重要的目标和噪声产生的脊边缘；
　　4)依据具体应用目的和先验知识，从剩下的多尺度脊边缘中选出所关心的那一部分；
　　5)以选定的脊边缘为基础，利用类似文献［6］中的方法设计小波变换选通域；
　　6)对选通后的小波变换作反变换，就得到最后滤波结果.
　　上面算法用于焊缝缺陷分割的结果如图1(d)所示，这是相当令人满意的.所以，在某些图像目标分割的应用中，脊边缘具有阶跃边缘无法替代的独特优势.
1)国家自然科学基金(批准号69575014)资助课题.
作者简介：宋焕生　1964年生，博士后.主要研究方向为非线性图像处理、计算机视觉.
　　　　　刘春阳　1962年生，博士后.主要研究方向为图像压缩编码.
作者单位：宋焕生　西安电子科技大学综合业务网及关键技术国家重点实验室　西安　710071
　　　　　刘春阳　中国科学院空间中心　北京　100080
　　　　　吴成柯　西安电子科技大学综合业务网及关键技术国家重点实验室　西安　710071
　　　　　梁德群　西安交通大学图像研究所　西安　710049
参考文献
1　Liang Dequn et al. Antomatic identification of the defect level of welding seam based on X-ray image. FENDT'92, 1992, 267～274
2　Witkin A. Scale space filtering. In: Proc.Int.Joint Conf.Artifical Intell, 1983, 1019～1022
3　Marr D, Hildreth E. Theory of edge detection In: Proc.Royal Soc. London B, 1981, 207(2):187～217
4　Mallat S et al. Characterisitics of signals from mlutiscale edges. IEEE Trans. Pattern Anal. & Mach.Intell. 1992, 14(7):710～732
5　Mallat S et al. Singularity detection and processing with wavelets. IEEE Trans. Inf. Theory, 1992, 38(2):617～643
6　宋焕生等.一种新的小波变换域选通滤波器.信号处理，1996，12(4)：311～315
收稿日期　1997-09-08　　收修改稿日期　1998-03-23研究简报
