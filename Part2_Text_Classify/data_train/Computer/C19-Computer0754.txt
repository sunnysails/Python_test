自动化学报
ACTA AUTOMATICA SINICA
1999年　第25卷　第5期　Vol.25 No.5 1999



一种新的被遮挡的光滑边界与错觉
轮廓的感知修复模型1)
刘海鹰　黄胜华　洪继光
摘　要　研究了被遮挡的光滑边界与错觉轮廓的构造问题.提出了一种基于心理学假设的构造模型.该模型利用在关键点上分布的电荷所激发的电场来模拟引力场，并定义了场激发子及其引力，同时构造了一个图来解决分组问题.通过该模型能高效地构造出被遮挡边界与错觉轮廓.应用范例证明了该模型的有效性.
关键词　被遮挡边界，错觉轮廓，引力场，修复场.
A NEW MODEL OF PERCEPTUAL COMPLETION FOR OCCLUDED
SMOOTH BOUNDARY AND ILLUSORY CONTOUR
LIU Haiying　HUANG Shenghua　HONG Jiguang
(National ASIC Design Engineering Center of China
Institute of Automation, Chinese Academy of Sciences, Beijing　100080)
Abstract　A novel model for constructing the occluded smooth boundary and illusory contour is presented. The model is based on an assumption that the boundary completion depends on some field attraction. An electric field generated by charges artificially distributed on key points of boundary fragments is selected to imitate the attraction. Then, the field stimulator and attraction are also defined according to electromagnetic theory. Moreover, a graph is constructed to solve the global grouping problem. By using this model, the occluded boundary and illusory contour can be quickly constructed without complex computing. A group of occluded boundary and illusory contour stimuli including an application is used to demonstrate the efficiency of our model.
Key words　Occluded boundary, illusory contour, attracting field, perceptual completion
1　引　言
　　推导三维物体的拓扑结构是计算机视觉中最难解决的问题之一.传统模型多用于研究完全可见的物体.然而视觉中最惊人的特点在于视觉感知的正确性――即对外部世界的感知与外部世界本身物理特性的对应.实际上，人类的视觉系统重构了输入人眼图像的大部分而使得视觉世界是完整的.研究感知问题的方法可按数据源大致分为两类：生理学方法和心理学方法.生理学方法是以视觉系统的解剖学和生理学为基础的，而心理学是以感知能力和感知实验为基础的.
　　许多研究人员着重于生理学方法.Ullman在从视觉系统结构中推出视觉模型方面做了些早期工作［1］.Grossberg 和 Mingolla从视觉皮层的结构中分析了错觉轮廓的作用［2］.Guy 和 Medioni亦描述了从局部图像信息中抽取全局结构的方法［3］.
　　最近 Williams 和 Jacobs提出了随机修复场(stochatic completion fields)的概念，用以解决感知修复问题［4］.根据“哺乳动物的视觉皮层精细地对应于特定的位置和方向”这种生理学现象，文献［4］提出了以位置和朝向位于图像平面的网格点上的随机行走作为边界形状的先验概率分布模型，由此定义了一个能量函数来度量两个关键点之间不同路径的相似度，并用两个格林函数的卷积计算修复场.但是经过复杂的计算，只能得到估计的修复区域，无法直接得到感知边界.
　　本文基于 “图像中两条边界碎片之间的一致程度决定了它们能看作一条边界的可能性”［5］这种心理学现象，提出一种高效的感知修复模型.这种模型着重考虑边界碎片的位置和朝向，并使用了引力来衡量“边界碎片之间的一致程度”.
2　引力修复场模型
2.1　物理学基础
　　心理学认为被修复的边界形状依赖于某种引力，而人体的信息传递是依靠生物电，因此可以利用电场来建立引力场并模拟该引力.依照电磁场理论，当在空间放置一个点电荷时，若定义无穷远处的电位为0，则该电荷在空间某点激发的电位为
　(1)
式中q是电量，ε0是真空介电常数，r是空间该点到点电荷的距离.如果存在多个点电荷q1, q2,…, qn并且空间某点距离这些电荷的距离分别为r1, r2,…,rn，则总电位为
　(2)
　　对于二维的情况，这些电荷产生的电场为
　(3)
式中(x, y)是位置坐标，i,j是坐标平面的单位向量.
　　正负点电荷之间产生的引力场只包含位置信息而没有包含方向信息，所以必须设计一种电荷单元使之同时包含位置和方向信息.
2.2　场的构造
　　这里引入一种叫做激发子的电荷单元来度量边界碎片的位置和空间的一致性.激发子是一条长度为l的线电荷，一端位于关键点上，方向是边界碎片在关键点的切线上，如图1(a)所示.线电荷上的电荷密度是从+ρ到 -ρ(ρ> 0) 均匀分布的，如图1(b).这样激发子产生的引力场就同时包含了边界碎片关键点处的位置和方向信息.如果激发子放置得当，就能够从引力场的场线中重构出物体的感知边界.


图1　场的构造
2.3　公式化表达
　　线电荷产生的电位为
　(4)
式中ρ(x,y,z)是线电荷密度分布函数，r是空间上一待计算点(x,y,z)到电荷单元ρ(.)dτ的距离.n条线电荷的总电位为
　(5)
引力场为
　(6)
　　若设激发子si的位置为(xi,yi)，方向为θi,长度为li、关键点上的电荷密度为ρi和类型为typ ei（“源”或“目”，在下文中定义）,则其产生的电位为
　(7)
式中


总的引力场为
　(8)
　　由于仅在关键点和无穷远点处引力场为0，所以一切不在关键点或无穷远点处的点在场的引力作用下都将最终到达另一个关键点或无穷远点.这意味着在某个关键点出给一个微小位移Δd，该点都将沿该关键点处的切线方向出发，在引力场的作用下最终到达另外一个关键点或无穷远点.因此只要激发子放置得当，无须复杂计算，就可以得到一条连接两条边界片断的光滑感知边界或错觉轮廓.
　　上述引力场模型可直接应用于简单的局部被遮挡边界和错觉轮廓的修复问题.但当图形较复杂时，会得到某些不应有的修复线.这是因为两边界片断之间是否存在感知边界不仅取决于局部信息，还取决于在全局上的感知边界是否一致［6］.所以对于复杂图像，在建立引力场之前应对激发子进行分组预处理.
2.4　分组处理
　　对于图形的修复问题，存在着三类不确定性问题，即形状的不确定性、单元的不确定性和深度上的不确定性.分组问题(grouping problem) 是由单元的不确定性产生的，即“哪些轮廓片断和另外哪些轮廓片断能组成边界”［6］.若把位于关键点处电荷分布密度为-ρ的激发子定义为“源”，把位于关键点处电荷分布密度为+ρ的激发子定义为“目”，则这里的分组问题就转化成了“源”和“目”的分布和匹配问题.
　　采用传统的右手规则，即沿边界行进时物体的表面位于行进方向的右侧.当沿边界行进而进入关键点时，在关键点上放置一个“源”；当沿边界行进而背离关键点时，在关键点上放置一个“目”.这样每一个关键点处都将有两个激发子（一个是“源”，一个是“目”）.显然这两个激发子对应的边界片断属于不同的物体.
　　对于“源”和“目”的匹配问题，可采用图论中的最大权匹配法加以解决.定义一个图，它的每一个顶点表示一个激发子，每一条带权值的边表示两个激发子之间的可连接关系.其中权值Wij的定义如下： 
　(9)
式中α，β是比例因子，Rij是两激发子si,sj之间的可连系数，Dij是两激发子si,sj之间的相邻系数.
　　可连性在这里是指两条边界片断可用一条光滑曲线相连的可能性.为了防止曲线的外展和自环等等现象，还必须加上一个单调性限制.可连性可解析地表达成公式(10).考虑两条边界E1,E2，使 R和r分别在关键点处垂直于E1, E2，且使R≥r，并设φ为R和r的夹角，如图2所示.可以证明，当这两条边界符合可连性条件公式 (10)时，存在一条一阶连续曲线可将两边界连接在一起，且曲线两端分别与两边界相切［7］
0＜Rcosφ＜r.　(10)


图2　可连性说明
　　加上考虑其它诸如平行、垂直和共线的情况，定义可连系数为
　(11)
式中c1≥1,c2＜0;ti,tj是方程组的解. Rij越大表示两条边界越“可连”.
　　相邻系数定义如下：
　(12)
Dij越大两关键点越接近.
3　实　验
　　用公式(8)可直接分析并绘制引力场.关于激发子分布的图的最大权值匹配问题.考虑到计算效率，可采用Gabow N-次方最大权匹配算法［8］.
　　图3 是对Kanizsa三角形的修复情况.分组算法中取α=β=1,c1=1,c2=-1. 


图3　Kanizsa 三角形修复结果
“―”为感知边界；“…”为边界碎片；“●”为关键点
　　图4、图5是该模型在集成电路(IC)线网跟踪的实际应用.线网跟踪是 IC 评估、验证和反向中的重要环节.但是由于 IC 芯片版图中线网的多层遮挡问题，线网跟踪很难自动完成.本文的模型为此提供了一种解决方法，大大提高了线网跟踪的自动化程度.图4(a)是 IC 芯片版图中局部线网的256级灰度图像.图4(b)是图4(a) 的边界细化结果.关键点1-7上分布的是源，关键点8-14上分布的是目.分组算法中取α=β=1,c1=1,c2=-1.图5中给出了部分修复结果.


图4　集成电路版图图像局部

图5　图4修复结果的部分
4　结　论
　　感知修复能力是人类视觉中最惊人的特性之一.怎样使计算机视觉具有这种能力一直是一个难题.已提出的模型主要是以生理学知识为背景或假设的，它们或多或少地忽略了物体本身对感知修复的影响.本文提出的引力修复场模型，有合理的心理学依据，强调了边界片断本身的物理特性，从其本身存在的一致性（位置一致性和方向一致性）出发，推导出简洁高效的计算方法，从而避免了其它算法中复杂度较高的卷积、多重积分等.更重要的是，能够得到确定的边界，而不象其它算法［1，4］经过复杂运算后，仅得到边界的可能范围.实际应用中这个模型也得到了验证.
1) 国家科技部重点科技项目“亚微米、深亚微米集成电路自动化分析技术研究”课题之一.
作者简介：刘海鹰　博士.1993年毕业于福州大学电气工程系，1998年获中国科学院自动化研究所博士学位.现为美国林肯大学计算机系博士后.主要研究方向为：模式识别、计算机视觉.
　　　　　黄胜华　博士.1993年毕业于北京师范大学数学系，1998年获中国科学院自动化研究所博士学位.现在公安部一所工作.主要研究方向为：模式识别、图像处理.
　　　　　洪继光　研究员，博士生导师.1962年毕业于成都电讯工程学院.现为中国科学院自动化研究所总工，国家专用集成电路工程技术研究中心主任.主要研究方向为：模式识别、集成电路分析和计算机视觉.
作者单位：国家专用集成电路设计工程技术研究中心，中国科学院自动化研究所，北京　100080
参考文献
1　Ullman S. Filling-in the gaps: The shape of subjective contours and a model for their generation. Biological Cybernetics，1976，AC-21, 1-6
2　Grossberg S, Mingolla, E. The Role of Illusory Contours in Visual Segmentation. In: The Perception of Illusory Contours. New York:SpringerVerlag, 1987. 116-125
3　Guy G, Medioni G.Inferring Global Perceptual Contours from Local Features, In: Proc of the DARPA Image Understanding Workshop, Washington, D.C., 1993, 881-892
4　Williams L R, Jacobs D W. Stochastic Completion Fields: A Neural Model of Illusory Contour Shape and Salience, In: Proc. of 5th Intl. Conf. on Computer Vision (ICCV'95), Cambridge, MA, 1995
5　Gibson J J. The Perception of the Visual World. Boston, Houghton Mifflin, MA
6　Williams L R, Hanson A R. Perceptual Completion of Occluded Surfaces , In: Proc. of IEEE Conf. on Computer Vision and Pattern Recognition (CVPR '94), Seattle, WA, 1994
7　Kellman P J,Shipley T F. A theory of visual interpolation in object perception. Cognitive Psychology, 1991, AC-23,141-221
8　Gabow's , Implementation of Algorithms for Maximum Matching on Nonbipartite Graphs, ［Ph.D. thesis］. Stanford University, 1973
收稿日期：1997-10-21
修稿日期：1999-03-01
