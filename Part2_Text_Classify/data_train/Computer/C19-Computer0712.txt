自动化学报
ACTA AUTOMATICA SINICA
1999年 第25卷 第1期 vol.25 No.1 1999



工业过程广义稳态优化控制研究1)
罗旭光　万百五
摘　要　基于广义稳态和稳态集合的中心名义值概念，给出了工业过程广义稳态优化控制问题的数学描述，并就该问题的存在性给予了充分性证明；此外，对处理工业过程广义稳态优化控制问题的一种等效方法展开了深入讨论，给出了具体算法步骤，并对一个化工过程的广义稳态优化算例进行了仿真计算；结果表明，文中关于广义稳态优化控制问题的定义是正确的，算法是有效的.

关键词　混沌，唯一遍历，广义稳态，工业过程，稳态优化.

STUDY ON OPTIMIZING CONTROL OF GENERALIZED STEADY
STATE FOR INDUSTRIAL PROCESSES
LUO Xuguang　WAN Baiwu
(Systems Engineering Institute,Xi′an Jiaotong University,Xi′an　710049)
Abstract　According to the definitions of the generalized steady state and the nominal central value of steady-state sets,the problem of generalized steady-state optimizing control for industrial processes is stringently described.The existence of the problem is also proved for the sufficiency.On the other hand,an equivlent method for optimizing control of the generalized steady state is deeply discussed,and an algorithm for solving the problam is given.Based on the algorithm,a generalized steady state of a chemical engineering process is calculated.The conclusion shows that the definition about optimizing control for generalized steady state is suitable,and that the algorithm is effective.
Key words　Chaos, unique ergodicity, generalized steady state, industrial processes, steady-state optimizing.


1　引言
　　混沌现象普遍存在于各类非线性系统中，使得工业过程的稳态形式已不能仅仅用常值稳态(平衡态)简单概括，它还应当包括周期稳态、拟周期稳态和混沌稳态；对于如此复杂的稳态行为，工业过程的稳态优化控制问题研究将面临着新的挑战.文［1］根据非线性动力学系统理论，针对工业过程中存在的上述多种稳态形式，给出了一种统一的数学描述――即广义稳态；证明了非线性系统在满足较宽的条件下，其广义稳态存在.另一方面，文［2］对广义稳态集合的度量问题作了有益的研究，利用遍历理论的Borel不变测度积分定义了广义稳态集合的中心名义值，证明了非线性系统在广义稳态存在的前提下，其稳态集合的中心名义值唯一存在；从而，为本文研究工业过程的广义稳态优化控制问题做好了必要的理论准备.

2　工业过程描述
　　通常，实际工业过程可以表示为图1的形式，图中c(k)∈C是过程控制器的设定点，u(k)∈U是过程A的控制变量，x(k)∈X是过程A的输出变量，y(k)∈Y是过程B的输出变量，它可以是生产过程输出产品的产量，也可以是产品的某个质量指标；v(k)∈VRl,w(k)∈WRm分别是过程A和B的物料输入(扰动)；而过程A和B合成一个完整的工业生产过程［3］.一般来说，u(k),x(k)和y(k)均是可量测的，而v(k)和w(k)在一个较长的时间段内是不变的，因此，在数学模型中可以不考虑它们的影响.图1所示系统可由如下差分方程描述：
(1a)
由于控制器设定点变量c(k)在每一次调整间隔内保持不变，故可将(1a)式中差分方程u(k+1)=f3(*)中的c(k),c(k-1)，…，c(k-i+1)用c表示，即在每一次调整间隔内，c只是差分方程中的一个参数，而非动态变量.进一步将(1a)式差分方程化成一阶差分状态方程的矩阵形式［1］
z(k+1)=F(z(k)),　k∈Z,(1b)
式中　z(k+1)∈Z=Y×X×URs+r+j.由文［1］可知，描述图1所示非线性系统的(1a)和(1b)式具有等价性，故在研究非线性系统的稳态行为时，可不必加以区别.

图１ 工业过程结构框图
　　假设1.1) 在非线性系统(1)中，f1(.),f2(.),f3(.)∈Cr(r次连续可微函数空间，r≥1);2) 非线性系统(1)的运动状态是闭环输入输出稳定的，即对c∈CRi，｜c｜≤Mc,　0＜Mc＜∞,　k∈Z+,则有｜y(k)｜≤My,　｜x(k)｜≤Mx和｜u(k)｜≤Mu，其中0＜My＜∞,　0＜Mx＜∞,　0＜Mu＜∞,　k∈z+.

3　工业过程广义稳态问题描述及其存在性
　　设控制器设定点容许集合C=｛c∈Ri:D(c)≤0｝为紧集，D(*)是连续可微的凸向量函数，若非线性系统(1)的平衡态是一常值稳态时，系统的稳态优化则是一个带等式约束和不等式约束的非线性规划问题，即
(2)
上式中　Q(.，.，.)∈Cr(r≥1)，并且是凸标量函数，它表示工业过程的技术经济指标；G1(.)和G2(.)是过程相对于设定点c的稳态非线性映射关系.
　　由(2)式描述的DOP问题就是过去用于处理确定性系统的通常方法，即将其简单地视为常值稳态的优化问题.根据文［1］的研究知道，由于系统内在的非线性机制，使得在控制器设定点改变或者过程参数发生变化时，非线性系统(1)除存在常值稳态之外，还可能出现周期稳态、拟周期稳态和混沌稳态；此时，设定点c∈C与系统稳态｛｝｜c［1］之间的关系是一种点到集合的映射，如果仍用(2)式定义的DOP问题去描述具有广义稳态的非线性系统(1)的稳态优化控制问题已经毫无意义.
　　当非线性系统(1)满足假设1的条件，并且其离散动力学系统是同胚映射时，由文［2］可知，它的离散动力学系统在达到稳态时是唯一遍历的.这表明，过程A和过程B的输出x(k)，y(k)虽然可能不收敛于一个常值，但是时间序列y(k)和x(k)在平均意义下将一致收敛于各自相空间上按正规Borel测度μ的积分μ(f2)，而μ(f1)和μ(f2)是唯一不变的［2］.因此，基于这一结论，具有广义稳态的非线性系统(1)的稳态优化控制问题定义为
(3)
式中

　　关于由(3)式定义的非线性系统(1)的稳态优化问题(GOP)的存在性，有下面的定理.
　　定理1.若非线性系统(1)满足假设1的条件，并且其离散动力学系统的映射 φ:Z→Z是同胚的，则由(3)式描述的GOP问题存在，并且指标函数Q(c,f1(φkz), f2(φkz))的时间均值一致收敛.
　　定理1的证明略，详见文［4］.定理1保证了非线性系统(1)在满足假设1的条件下，并且其离散动力学系统是同胚映射时，其GOP问题存在；从而，可构造求解GOP问题的有效算法.

4　广义稳态优化算法
　　事实上，由(3)式描述的稳态优化是指标函数未知的确定性稳态优化问题，为了借鉴ISOPE方法［5］的主要思想，以及Lin用于处理随机稳态的技术［3］，建立一种处理GOP问题的有效算法，必须保证q(c)关于c是可微的.为此，有以下一些引理.
　　引理1.若非线性系统(1)满足假设1的条件，并且Q(.，.，.)∈Cr(r≥1)，则Q/c是关于c,y(k),x(k),y(k)/c和x(k)/c的连续函数.
　　引理1的证明略，详见文［4］.简记yc(k)y(k)/c, xc(k)x(k)/c,Q/cqc(c,x(k),y(k),xc(k),yc(k))=qc(c,f1,f2,f′1c,f′2c); 式中yc(k)=f′1c(.)和xc(k)=f′2c(.)仍然是差分方程.
　　假设2. 时间序列yc(k),xc(k)和uc(K)是有界的，即对k∈Z+, ｜yc(k)｜＜+∞,｜xc(k)｜＜+∞和｜uc(k)｜＜+∞.
　　引理2. 若非线性系统(1)满足假设1(1)的条件，则差分方程yc(k+1)=f′1c(.), xc(k+1)=f′2c(.)和uc(k+1)=f′3c(.);以及y(k+1)=f1(.), x(k+1)=f2(.)和u(k+1)=f3(.)在ZcR2×(s+r+j)上确定了一个离散动力学系统｛Ψk:k∈Z｝, Ψ:Zc→Zc,其中Zc［Y,X,U,Yc,Xc,Uc］T.
　　引理2的证明略，详见文［4］.
　　引理3. 若对t∈TRn,有限，以及对存在，并且有可积函数g(x),使得
　　引理3的证明略，详见文［6］.
　　引理2. 若非线性系统(1)满足假设1和假设2的条件，并且φ:Z→Z是同胚映射，如果Q(.，.，.)∈Cr(r≥1)，则GOP问题的指标函数q(c)关于设定点c是连续可微的.
　　定理2的证明略，详见文［4］.正是因为非线性系统(1)在满足假设1和假设2时，定理1和定理2保证了GOP问题的存在性以及q(c)关于c的连续可微性，从而为建立GOP问题的优化算法奠定了基础，下面给出广义稳态优化控制算法.
　　对于任意给定的控制器设定点初值v0∈C, 当迭代计算第L步时：
　　1)计算　λL=λ(vL)=Q′(vL,G1(vL),G2(vL))-q′(vL)′(vL)-q′(vL).
式中　G1:CRi→YRs, G2:CRi→XRr，它们分别是过程B和A相对于设定点v∈C的稳态映射， Q′(.)和q′(.)是对v的偏导数.
　　2) 对于给定的λL，求解下式基于模型的优化问题

得到相对于vL的最优解c(vL)，简记为cL.
　　3) 采用松弛法修正控制器设定点vL，即
vL+1=vL+ε.(cL-vL)，　ε为步长.
　　4) 若vL+1=vL，迭代结束；否则，转1).
　　上述算法实质上是一种建立在稳态模型基础上、并利用过程的动态信息进行修正的优化方法，最终结果使得实际过程达到稳态最优.可以证明，MOP问题的最优解亦是GOP问题的最优解.由于篇幅限制，关于优化算法的最优性和收敛性证明将另文介绍.

5　仿真算例
　　考虑由一个液位控制系统(LLCS)和一个连续搅拌反应器系统(CSTR)组成的化工过程，如图2所示，文［7］就LLCS系统和CSTR系统在离散控制下可以产生混沌现象进行了验证.　


图2　化工过程示意图
　　在LLCS系统中，Qi,Qm分别为物料输入和输出流量，d为扰动输入，ρ为流体密度，A为容器横截面积，h为液面高度；该系统通过一个比例控制器P对输入流量Qi进行调节以控制容器中的液面高度h.在CSTR系统中，Qm,Qo分别为输入和输出流量，cin和c分别为输入和输出浓度，且输入流的浓度cin恒定，V为反应物体积.由物料平衡关系，可得描述图2所示化工过程的数学模型
(4)
上式中　y表示由化工过程生成的反应物相对浓度c/cin，x是化工过程的受控中间变量，亦即液面相对高度h/h0，u是调节液面高度的控制变量；通过控制液面高度间接控制最终反应物的浓度；Δθ1,Δθ2分别为LLCS和CSTR系统的采样周期，v为阀门系数，g为控制器增益.若令(4)式中各参数为=0.16667, v=2.68556，h0=1,g=20.0,λ=5.0,Δθ1=Δθ2=0.15，并且-1.0＜u(k)＜4.0, 1.0≤xc≤5.0；经整理，得
(5)
　　显然，由(5)式描述的化工过程是一个非线性控制系统，它满足假设1的条件，因此，该系统的广义稳态存在：另一方面，容易证明非线性系统(5)的离散动力学系统是同胚的，所以它们是唯一遍历的，根据定理1，非线性系统(5)的广义稳态优化控制问题(GOP)存在.因为有控制器的调节作用，使得x始终围绕设定点xc上下波动，而xc∈［1.0，5.0］，所以x的取值不会趋近于0，从而可以保证非线性系统(5)满足假设2的条件.因此，可以按照上节中的优化算法将该系统的GOP问题转化为MOP问题求解.
　　设非线性系统(5)的稳态优化指标函数为
Q=(xc-2)2+(xc-x(k))2+(y(k)-1)2;(6)
置设定点初值 xc=2.8,v=3.0; 修正步长ε=1.0；经过3次迭代计算，便得到广义稳态的最优设定点，结果如表1所示.图3和图4是非线性系统(5)相应于第1次和第3次设定点修正时，时间序列x(k)和y(k)的变化曲线，从图中可以看出，非线性系统(5)具有广义稳态.


图3　第1次迭代时的x(k)和y(k)的响应曲线　图4　第3次迭代时的x(k)和y(k)的响应曲线

　
表1　数值计算结果

迭代次数L最优设定点c(v)中心值μ(x)中心值μ(y)性能指标q(c)
31.9283401.8662660.4233180.754063


6　结束语

　　文中对工业过程广义稳态优化控制问题(GOP)进行了深入研究.将GOP问题引入有限测度空间，并依据测度理论证明了同胚的非线性系统在满足假设1的条件下，其GOP问题唯一存在；证明了同胚的非线性系统在满足假设1和假设2的条件下，便可将GOP问题化为MOP问题后求解，并给出了算法步骤；最后，对一个由液位控制系统和连续搅拌反应器系统组成的工业过程进行了数值计算，结果表明，文中关于GOP问题的定义是正确的，算法是有效的.

1)国家自然科学基金资助项目.
　　罗旭光　1990年毕业于西北工业大学航天学院，获硕士学位；1998年毕业于西安交通大学系统工程研究所，获博士学位.现在广东美的集团R&D研究所工作，主要研究领域为：工业过程稳态优化控制、模糊神经元网络、混沌理论、智能控制等.
　　万百五　1951年交通大学电信研究所研究生毕业，现为西安交通大学系统工程研究所教授、博士生导师，中国自动化学会荣誉理事；曾获得国家教委科技进步一等奖一次、二等奖两次、三等奖一次以及机械电子工业部科技进步一等奖一次.主要研究领域为：大系统理论与应用，大工业过程递阶稳态优化与智能控制等.
作者单位：(西安交通大学系统工程研究所　西安　710049)
参考文献
1　罗旭光，万百五.工业过程广义稳态研究.西安交通大学学报，1998，32(5)：1―6
2　罗旭光，万百五.工业过程广义稳态的平均度量.西北大学学报(自然科学版)，1998，28(3)：198～202
3　Lin J，Wang M,Roberts P D.Improvements in the formulation and solution approach for stochastic optimizing control of steady-state industrial processes.Int.J.Control,1990,52(3):517―548
4　罗旭光.工业过程广义稳态及其优化控制的研究［博士学位论文］.西安：西安交通大学，1997
5　Roberts P D.An algorithm for steady-state system optimization and parameter estimation.Int.J.Systems Science,1979,10:719―730
6　严士健，刘秀芳.测度与概率.北京：北京师范大学出版社，1994，163―173
7　Lee J S,Chang K S.Applications of chaos and fractals in process systems engineering.In:J.Proc.Cont.,1996,6(2/3):71―87


收稿日期　1997-07-21　收到修改稿日期　1998-03-16
