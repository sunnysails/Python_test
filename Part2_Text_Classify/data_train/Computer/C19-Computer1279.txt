自动化学报
ACTA AUTOMATICA SINICA
2000　Vol.26　No.1　P.16-23



不确定离散系统具有H∞性能界的鲁棒LQG状态反馈控制
吴淮宁
摘 要 研究了含有范数有界参数不确定线性离散系统具有H∞性能界的鲁棒LQG状态反馈控制问题，考虑了有限时域时变及无限时域时不变两种情形. 所得的控制器对于所有可容许的参数不确定都能满足给定的H∞性能界，且为最坏情形H2性能指标提供了一个最优上界.对于无限时域时不变情形，该控制器还能保证闭环系统渐近稳定. 结果仅需求解一含有一个尺度参数的Riccati方程.
关键词 线性离散系统, 鲁棒控制, 二次性能指标, H∞优化, Riccati方程.
ROBUST LQG STATEFEEDBACK CONTROL WITH H∞
PERFORMANCE BOUND FOR UNCERTAIN DISCRETETIME SYSTEMS
WU Huaining
(Department of Automatic Control,Beijing University of Aeronautics
and Astronautics,Beijing 100083)
Abstract The paper studies the problem of robust LQG state feedback control with H∞ performance bound for uncertain linear discretetime systems that are subjected to normbounded parameter uncertainty. Both the cases of finite horizon timevarying and infinite horizon timeinvariant are considered. The controller derived can satisfy a given H∞ performance bound and provide an optimized bound for the worst case  H2 performance index for all admissible parameter uncertainties, and also make the closedloop systems asymptotically stable for the case of infinite horizon timeinvariant. The obtained result only needs to solve a single parameter dependent Riccati equation.
Key words Linear discretetime systems, robust control, quadratic performance index, H∞ optimization, Riccati equation.
1 引言
　　对于含有未建模扰动的线性系统来说，采用H∞优化方法来设计控制器是非常有效的［1］.然而用其来处理参数不确定系统的鲁棒稳定问题时，则显得过于保守［2］. 虽然近年来提出的H2保价方法可以很好地解决含有参数不确定系统的最优鲁棒控制器的设计问题［3,4］，但是该方法没有考虑H∞干扰抑制, 而且在大多场合，未建模扰动与参数不确定可能同时存在于控制系统当中. 因此，近年来一些学者对同时含有未建模扰动与参数不确定的系统鲁棒控制器的设计问题进行了研究，如文［5］与［6］分别用Riccati方程法和凸优化方法解决了一类凸有界结构参数不确定离散系统在未建模扰动作用下的鲁棒状态反馈控制问题；而文［7］则对含有范数有界参数不确定的系统在末建模动态作用下的鲁棒状态反馈控制问题进行了研究. 文［5～7］所考虑的H2性能与H∞干扰抑制性能均对应于同样的输入输出，所得的控制器可使系统在满足给定的H∞干扰抑制水平条件下，其最坏情形H2性能指标的一个上界达到最小. 这些方法容许我们设计时可以在最坏情形H2性能与H∞性能之间进行折衷. 然而文［7］仅考虑了连续情形，而相应离散情形，至今还未见报道.
　　本文对含有范数有界参数不确定线性离散系统在未建模扰动作用下的鲁棒状态反馈控制问题进行了研究，考虑了有限时域时变及无限时域时不变两种情形. 给出了系统在满足给定的H∞干扰抑制水平条件下，其最坏情形H2性能指标的一个上界，并导出了“最优的”状态反馈控制器优化了该界. 所得结果仅需求解一个含有一个尺度参数的修正Riccati方程.
2 问题描述
　　考虑如下不确定线性离散时变系统
　(1)
zk=Ckxk+Dkuk.　(2)
这里xk∈Rn为状态;uk∈Rm为控制输入;wk∈Rp为干扰;zk∈Rq为系统输出;为描述名义系统的已知有界实时变矩阵;x0为初态;而ΔAk,ΔB1,k表示系统的参数不确定.假定可容许的参数不确定满足
　(3)
其中为一个未知的实时变矩阵，满足
　(4)
而Hk,E1,k与E2,k为适当维数的已知有界实矩阵. 假定.
　　定义如下有限时域最坏情形H2性能指标和H∞性能指标
　(5)
　(6)
其中分别为初态x0与终态xN的给定加权矩阵，‖y‖2R与‖y‖22,［0,N-1］分别表示为表示为在区间［0,N-1］上平方可加的向量序列所构成的空间，E｛.｝表示期望. 
　　具有H∞性能界的鲁棒LQG状态反馈控制问题是：确定一个状态反馈控制律
　(7)
使得以下条件成立
　　1) 若将wk视为一个平方可加的干扰信号，x0视为一个未知初态，给定γ＞0，则由(6)式定义的H∞性能指标满足
　(8)
　　2)若将wk视为一个白噪声过程，对于0≤k, l≤N-1满足：当k=l时，当k≠l时，E｛wkwTl｝=0.而将x0视为一个满足E｛x0｝=0,E｛x0 xT0｝=X0≥0的随机向量，且与wk互不相关，则由(5)式定义的最坏情形H2性能指标的一个上界达到最小. 
　　由(1),(2)及(7)式构成的闭环系统可写为
　(9)
　(10)
其中这样(5)式可化为
　(11)
其中tr｛．｝表示矩阵的迹，且满足矩阵差分方程
　(12)
其中考虑如下矩阵差分方程
　(13)
则(11)式可改写为
　(14)
令引入如下表达：

引理1.考虑闭环系统(9),(10)式，给定γ＞0及状态反馈增益Kk，若存在一个标量ε＞0，使得Riccati差分方程
　(15)
有一个满足的有界时变解且
　(16)
成立，则此时最坏情形H2性能指标满足
　(17)
称JF为有限时域H2性能保证界. 
　　证明. 由有限时域离散情形有界实引理(见文［8］中定理3.1)可知，方程(15)有一个满足且(16)式成立的有界时变解等价于存在一个满足的有界时变矩阵使得
　(18)
且成立. 由于
容易得出且由

　　令
显然
由(4)式可知M(Qk+1)≥0. 利用等式
可将(18)式化为
　(19)
显然由有界实引理可知
　　同(19)式的推导一样，可以将(15)式改写为
　(20)
令则用(20)式减去(13)式可得

显然Yk≥0，因而(17)式成立. 证毕. 
3 有限时域最优鲁棒控制器设计
　　现在来推导使得(17)式中H2性能保证界JF达到最小意义上的最优状态反馈增益Kk.令
则有如下定理.
　　定理1.存在一个Kk使得JF在(15)式有一个满足且(16)式成立的有界时变解
的约束下达到最小，当且仅当存在一个ε＞0，使得方程
　(21)
有一个满足的有界时变解且
　(22)
成立. 此时
　(23)
且
　(24)
　　证明. 必要性.容易看出JF的最小化等价于Pk在正半定意义上的最小化. 将(15)式对Kk进行配方可得

　(25)
由上式可知，只有当Kk满足(23)式时，Pk才能达到最小，此时(15)式化为(21)式，且由(16)式可得(22)式.
　　充分性. 假定(21)式有一个满足P0＜γ2R0的有界时变解且(22)式成立，令Kk由(23)式给出，将(21)式加上零项
　(26)
然后经整理可得(15)式，这说明该Pk也是(15)式的解，且(16)式成立，很容易验证由(23)式给出的Kk满足优化的必要条件. 显然此时(24)式成立. 证毕. 
　　由引理1及定理1很容易得到如下定理.
　　定理2. 考虑系统(1),(2)式，给定γ＞0，如果存在一个标量ε＞0，使得方程(21)式有一个满足的有界时变解且(22)式成立，则由(23)式给出的状态反馈增益Kk可使且能保证最坏情形H2性能指标满足

从该定理可知，若定理中条件成立，则由(23)式给出的Kk会使闭环系统满足给定的H∞性能指标，且为最坏情形H2性能指标提供了一个最优上界. 
4 无限时域时不变情形
　　现在来研究无限时域时不变稳态情形具有H∞性能界的鲁棒LQG状态反馈控制器的设计问题，也即k→∞的情形. 假定A,B1,B2,C,D,H,E1与E2均为常数矩阵，且DTD＞0，不确定矩阵Fk满足
问题可以描述为：确定一个时不变控制律uk=Kxk满足以下设计要求:
　　1) 对于所有可容许的参数不确定，闭环系统是渐近稳定的. 
　　2)为wk到zk的闭环传递函数，这里σ［.］表示最大奇异值，γ＞0为给定的干扰抑制水平. 
　　3) 最坏情形H2性能指标
　(27)
的一个上界达到最小. 
　　若是渐近稳定的，则(27)式可化为
　(28)
其中满足Lyapunov方程
　(29)
　　引理2. 考虑闭环系统(9),(10)式的时不变情形，给定γ＞0，如果存在一个ε＞0，使得代数Riccati方程
　(30)
有一个稳定解P=PT≥0(也即是渐近稳定的)，且
　(31)
成立，则对于所有可容许的参数不确定闭环系统都渐近稳定，且 此时最坏情形H2性能指标满足
　(32)
称JI为无限时域H2性能保证界. 
　　证明. 与引理1的证明类似，运用无限时域时不变离散情形严格有界实引理［9］，容易证明，若(30)式有一个满足(31)式的稳定解渐近稳定，且同引理1一样，可得这里Y=P因为渐近稳定，所以因而(32)式成立. 证毕.
　　下面的定理给出了使得无限时域H2性能保证界JI达到最小的状态反馈增益K.
　　定理3.存在一个K使得JI在(30)式有一个满足(31)式的稳定解P=PT≥0的约束下达到最小，当且仅当存在一个ε＞0，使得方程
(33)
有一个稳定解P=PT≥0(也即
是渐近稳定的)，且
　(34)
成立. 此时
　(35)
且
　(36)
　　证明. 该定理的证明基本上与定理1的证明相同. 容易看出JI的最小化等价于P在正半定意义上的最小化，将(30)式的右边对K进行配方可知：只有当K满足(35)式时，P达到最小，此时(30)式化为(33)式，且由(31)式可得(34)式，此时的渐近稳定性意味着
的渐近稳定性. 很容易证明反过来定理也是成立的. 证毕.
　　由引理2以及定理3可得有如下定理.
　　定理4. 考虑系统(1),(2)式的时不变情形，给定γ＞0. 若存在一个ε＞0，使得方程(33)式有一个稳定解P=PT≥0，且(34)式成立，则对于所有可容许的参数不确定，由(35)式给出的状态反馈增益K可使闭环系统渐近稳定，且‖Gzw(z)‖∞＜γ，同时能保证最坏情形H2性能指标满足

该定理说明，在满足定理所给的条件下，由(35)式给出的K能够保证闭环系统渐近稳定，且‖Gzw(z)‖∞＜γ，同时为最坏情形H2性能指标提供了一个最优上界. 
　　可以看出，定理4为同时含有范数有界参数不确定及未建模扰动的线性离散系统提供了一种鲁棒状态反馈控制器的设计方法，它容许设计时可以在H2性能保证界与H∞干扰抑制性能之间进行权衡. 显然，在给定γ＞0的前提下，为了得到最优的H2性能保证界，需要搜索尺度参数ε. 另外，当系统不含参数不确定时(也即H=0,E1=0,E2=0)，定理4中的控制器就化为文［10］中的混合H2/H∞状态反馈控制器. 而当γ→∞时，定理4中的控制器就化为文［3］中的最优保价状态反馈控制器. 
5 仿真示例
　　考虑如下不确定线性离散系统

这里wk是未知干扰，δk为模型的不确定参数，满足｜δk｜≤0.15. 取H=［1 0］T,E1=［0.15 0］,E2=0.考虑无限时域情形，且要求给定的H∞干扰抑制水平γ=3.5. 
　　用Matlab软件中Toolbox工具来进行仿真，首先看看不考虑H∞干扰抑制性能时(也即γ→∞)，由定理4给出的状态反馈控制器的性能，可以发现当ε∈(0.0，0.0297］时，(33)式存在一个满足(34)式的正半定对称解，且ε=0.0109时，H2性能保证界达到其最小值4.3098.此时使得闭环系统渐近稳定的控制律为uk=［3.2481 3.2129］xk，且奇异值σ［Gzw(ejω)］与频率ω的关系如图1所示，其中实线、虚线及点线分别为δk=0、δk=-0.15以及δk=0.15的情形. 
　　逐渐减小γ值，可以得到不同γ值所对应的最优H2性能保证界(如表1所示)，其中Δ(ε)为使得(33)式有一个满足(34)式的正半定对称解的ε取值区间，ε*为使得H2性能保证界达到最小的ε值，J(ε*)为最优H2性能保证界.从表1可以看出：随着γ值的减小，相应ε的取值区间不断缩小，且最优H2性能保证界增大. 这说明提高干扰衰减水平需要牺牲最优H2性能保证界作为代价. 虽然可以得到γ的最优值近似为3.395，但由于要求的H∞干扰抑制水平为γ=3.5，因此无需为进一步提高H∞干扰抑制水平而牺牲最优H2性能保证界.

图1 γ→∞时，闭环传函G

图2 γ=3.5时，闭环传函G
表1 不同γ值所对应的最优H2性能保证界
γ值∞10543.53.4
Δ(ε)(0.0，0.0297］［0.0006，0.0273］［0.0008，0.0206］［0.0016，0.0152］［0.0033，0.0095］［0.0051，0.0064］
ε*0.01090.01060.01020.00980.00950.0064
J(ε*)4.30984.50945.25536.02376.90217.5207
　　当γ=3.5时，可以发现当ε∈［0.0033，0.0095］时，(33)式存在一个满足(34)式的正半定对称解，且ε=0.0095时，H2性能保证界达到其最小值6.9021，此时使得闭环系统渐近稳定的控制律为uk=［5.34595.2072］xk，且奇异值σ［Gzw(ejω)］与频率ω的关系如图2所示，其中实线、虚线及点线分别为δk=0、δk=-0.15以及δk=0.15的情形.
6 结论
　　本文解决了一类含有范数有界参数不确定线性离散系统的具有H∞性能界的鲁棒LQG状态反馈控制问题，并考虑了有限时域时变及无限时域时不变两种情形. 给出了系统在满足给定的H∞干扰抑制水平条件下，其最坏情形H2性能指标所要求的一个上界，并导出了“最优的”状态反馈控制器优化了该界. 所得的控制器对于所有可容许的参数不确定都能保证满足给定的H∞干扰抑制水平，并为最坏情形H2性能指标提供了一个最优上界，而且对于无限时域时不变情形，还能保证闭环系统渐近稳定. 本文的方法容许设计时在H2性能保证界与H∞干扰抑制性能之间进行权衡. 最后仿真结果也验证了方法的有效性.
吴淮宁 1972年生，1992年毕业于山东建材学院自动化系，获学士学位. 同年进入西安交通大学信控系自控专业学习，1997年6月获博士学位. 1997.8至1999.7在北京理工大学电子工程系做博士后. 现为北京航空航天大学自动控制系副教授. 主要研究方向为H∞控制与估计，鲁棒控制与滤波，自适应信号处理. 
吴淮宁(北京航空航天大学自动控制系 北京 100083)
参考文献
1，Francis B A. A course in H∞ Control Theory. New York: Springer Verlag, 1987
2，Kwakernaak H. Robust control and H∞ optimization: tutorial paper.Automatica, 1993, 29(2): 255～273
3，Petersen I R, McFarlane D C, Rotea M A. Optimal guaranteed cost control of discretetime uncertain linear systems. Int. J. Robust and Nonlinear Contr., 1998, 8(8): 649～657
4，Geromel J C, Peres P L D, de Souza S R.H2 guaranteed cost control for uncertain discrete time linear systems. Int. J. Contr., 1993, 57(4):853～864
5，Bambang R T, Shimemura E, Uchida K. Discrete time  H2/H∞ robust control with state feedback. In: Proc. Amer. Contr. Conf. Boston, MA, 1991. 1172～1173
6，Geromel J C, Peres P L D, de Souza S R. A convex approach to the mixed H2/H∞ control problem for discretetime uncertain systems. SIAM J. Contr. Optim., 1995, 33(6):1816～1833
7，吴淮宁, 尤昌德. 具有H∞性能界的鲁棒LQG控制. 西安交通大学学报, 1997, 31(12): 26～32
8，Xie L, de Souza C E, Wang Y. Robust control of discrete time uncertain dynamical systems. Automatica, 1993, 29(4): 1133～1137
9，De Souza C E, Xie L. On the discretetime bounded real lemma with applicationin the characterization of static state feedback H∞ controllers.Syst. Contr. Lett., 1992, 18(1): 61～71
10，Haddad W M, Bernstein D S, Mustafa D. Mixed norm H2/H∞ regulation and estimation: the discretetime case. In: Proc. Amer. Contr. Conf. Boston, MA, 1991. 1159～1164 
收稿日期 1999-03-07 收修改稿日期 1999-07-21
