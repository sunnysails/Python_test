自动化学报
ACTA AUTOMATICA SINICA
1998年 第24卷 第4期 Vol.24 No.4 1998




基于分形理论的一种图象分割方法1)
刘文萍　吴立德
摘　要　介绍了一种基于分形特征进行人造目标分割的方法.它是用分形模型描述自然场景，基于人 造目标和自然背景在分形特征上的差别，并利用概率松弛的思想增强这种差异，从而自适应分割出目标图象.实验结果验证了这种方法的有效性和可行性.
关键词　分形，图象分割，概率松弛.
A METHOD FOR IMAGE SEGMENTATION BASED ON FRACTAL THEORY

LIU WENPING WU LIDE
(Dept.of Computer Science,Fudan University,Shanghai 200433)
Abstract Based on fractal characters,a method for segmenting man－made objects is presented,in which fractal model is used to describe the n atural background.The difference between man－made objects and the natural scene in fractal characters is enhanced by using the probabilistic relaxation,and the difference is also employed to segment man－made objects adaptively.Experiments have shown the effectiveness and feasibility of the approach.
Key words Fractal,image segmentation,probabilistic re laxation.
1　引言
　　图象分割是图象处理中的关键技术，目前的分割方法大都利用人造目标及自然背景之间的 灰度及几何特性上的差异，从自然景物中提取目标.但由于实际成象条件和环境等因素的影响，通常所摄取的图象中上述特性发生了变化，基于这些差别进行分割，势必会造成较高的错分率和漏检率.因此，如何在不同的自然环境下分割出人造目标，仍然是人们不断探索的课题.
　　分形理论的创立为图象分割技术开辟了新的途径［1］，但由于实际环境变化、不同目标类型等因素的影响，传统的基于分形理论的图象分割方法，用于实际图象所取得的效果并不理想.本文在基于分形特征用于人造目标图象分割的基础上，利用松驰法改善分割性能，获得了较好的实验结果.
2　分形模型及特征参数提取
　　本文选择一种公认较好的描述自然背景的模型--分数布朗随机场 FBR［1］，下面先对有关概念作一简述［1，2］.
　　定义1.　设 0＜H＜1,b0为任意实数，随机过程满足

称BH(t)为分数布朗运动(Fractional Brownian Motion,简记为 FBM).H为分形参数，H=0.5时为通常的布朗运动，b0为初始值.FBM是一个非平稳的自仿射随机过程，即对c,BH(ct)-BH(0)≈cH｛BH(t)-BH(0)｝.
　　TH定律.　设 BH(t)为分数布郎运动(均值为0)，则其满足
E｜［BH(t+T)-BH)］｜=CHTH,
E｜［BH(t+T)-BH(t)］2=CHT2H,
其中 CH 为一常数.该定律表明 FBM 场增量的一、二阶绝对矩具有各向同性.
　　定义2.　如果对任意t,T,随机函数 B(t)满足

称B(t)为分形布朗随机函数，F(y)为零均值随机变量的分布函数.
　　分形模型满足性质
A(r)～r2-D,　　(1)
其中D为分维数，A(r)是尺度为r时分形布朗函数的表面积.
　　Mandelbrot基于性质(1)提出了一种计算分形维数的思想［3］，将图象视为一座山丘，高度为图象的灰度值，在距该表面为ε的两侧形成了一厚为2ε的毯子(图1)，表面积
A(ε)=Fε2-D,　　(2)
则　　　　　　　　　　　logA(ε)=c1 logε+c0，　　　　　(3)
其中 c1=2-D 为图2拟合直线的斜率，并进而求出分形维数D.具体算法如下：
　　设毯子的上、下表面分别为uε,bε，灰度函数为g(i,j),u0(i,j)=b0(i,j)=g(i, j)，对所有ε=1,2,3，…，定义

式中 d(i,j,m,n)为点(i,j)和(m,n)之间的距离.


图1　“毯子”示意图


图2　直线拟合求D
　　毯子的体积,表面积A(ε)=(vε-vε-1)/2，求不同ε对应的表面积 A(ε)，再由(3)式得拟合直线斜率2-D，进而得到分形维数D.
3　分形用于图象分割及其改进方法
　　基于分形特性的图象分割方法的步骤如下：
　　1)对一幅 N×N 的图象，从图象的起点开始，沿水平和垂直方向滑动--M×M的窗口，计算窗口内图象的分形维数作为窗中心点处图象的分形特征值.利用上述算法，求取输入的灰度图象中各点的局部分形维数，得到分维数分布图象，简称分形图象.
　　2)由于自然背景符合DFBR场模型，有2＜D＜3；人造目标不具有统计意义上的自相似性，不满足分形模型，所得的分形维数可能小于2，利用这种分形特征差异来区分自然背景和人造目标，是基于分形理论分割人造目标的基本思想.
　　实际的自然景物并不是完全自相似的理想分形体，加上图象采集装备和采集过程中各因素 的影响，仅根据分形维数区分目标和景物并不可靠，还需做进一步的处理.将分维数 D 图象 归一化后影射成分形灰度图象 ，然后将作为输入，利用概率松弛法增强背景和目标的 分形特征差异，最后用固定阈值进行分割.
　　有关松弛法的算法较多，本文采用梯度松弛法［4］，它是根据最大梯度优化准则 函数来确定松弛迭代过程的.按梯度投影法导出概率迭代公式
P(n+1)i(λk)=P(n)i(λk)+ρ(n)i(2qi(λk)-1),k =1,2.
其中λ1和λ2分别为具有高和低D值(背景和目标区)的象素类的标记；
　　　　｛［pi(λ1),pi(λ2)］T,i=0,1,…，255｝是与灰度有关的概率向量集；
　　　　｛［qi(λ1),qi(λ2)］T,i=0,1,…，255｝是相容向量集.实际上，qi(λk)是象素xi邻域中各象素概率的均值，即

　　参数a1，a2及概率初值可控制松弛过程.实验中发现，松弛法仅需几次迭代，就可用一固定概率阈值来分离所对应的人造目标和背景区域.
4　实验结果及分析
　　我们对38幅实际图象进行了仿真实验.在具体实现中注意到以下三点：
　　1)滑窗大小的选取.如果窗过大，则影响运算速度和直线拟合的精度；过小，则不能准确地反映图象的统计特性，实验中窗大小为9×9；
　　2)尺寸ε的取值范围.理论上分形具有尺度不变性，在所有尺度上均满足自相似性，但实际的自然场景仅在一小尺度范围上呈现分形特征，实验中取值 1≤ε≤9；
　　3)概率松弛过程中概率初值的选择.实验按下式赋初值，

　　其中i,I分别表示图象的灰度及灰度均值；INI是一灰度函数，当i＞I时，INI=1;当i＜I时，0.7＜INI＜1.
　　我们对38幅真实图象作了大量实验，均取得了较好的分割结果，部分实验结果如图3和图4 所示(各图中上为原始图象，下为分割结果).实验参数为：原始图象灰度级［0，255］；图象大小 100×100；滑窗尺寸 9×9；松弛次数3；概率阈值 p=0.5；PC机型 486DX /33；运行时间约16s.


图3　对空目标的分割(背景为云层)
　　分割结果图为多值图，背景的灰度置为零，分割出的区域灰度值同原始图.实验结果表明该 方法可对自然环境中的人造目标进行较好的分割.其中，图3(a)，(b)是灰度极性相反的两幅飞行器图象；图4(a),(b)为极性相反且大小不同的舰船图象；图3(c)是处于强噪声背景中的飞机；图4(c)是夜间拍摄的多艘船图象.本文方法针对实际采集到的图象，自动进行全视场搜索，单帧即可准确分割出处于自然背景中的人造目标，且不受人造目标的运动姿态、速度、灰度极性变化等因素的影响，对海洋、空中等不同自然背景中的不同目标均可得到较好的结果，还可用于多目标分割，是一种性能较为优良的图象分割方法.


图4　对舰船的分割(背景为海面和天空)
5　结论
　　本文提出的分割方法是以DFBR场作为描述自然背景的分形模型，结合松弛法增强分形特征以提高分割精度和自适应性，利用增强后的分形特征分割人造目标，实验结果证实了它的有效性和可行性.
　　1)　国家“八六三－三一七”资助项目.
作者单位：复旦大学计算机系　上海　200433
参考文献
1　Pentland A P.Fractal－based description of natural scenes.I EEE Trans.PAMI,1984,PAMI－6(6):661-674 
2　Fortin C et al.Fractal dimension in the analysis of medical ima ges.IEEE Engineering in Medicine and Biology.1992,6:173- 181
3　Chaudhuri B B,Sarkar N. An efficient approach to estimate fractal dimension of textural images. Pattern Recognition, 1992, 25(9):1035-1041
4　Bhanu B,Faugeras O D.Segmentation of images having unimodal distributions.IEEE Trans.PAMI,1982,PAMI－4(4):408-419
收稿日期　1996-09-17
