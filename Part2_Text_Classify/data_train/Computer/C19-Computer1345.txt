自动化学报
ACTA AUTOMATICA SINICA
1997年 第23卷 第1期 Vol.23 No.1 1997



无辨识自适应控制预估算法及应用
江青茵
摘　要　借助 Smith 预估思想，将无辨识自适应控制算法推广到大纯滞后系统.为解决 Smith 预估器对模型的依赖问题，引入搜寻算法，提高了预估算法的鲁棒性和适应能力.给出了仿真研究及具体工业应用结果.
关键词　无辨识自适应，预估控制.
PREDICTIVE ALGORITHMS OF IDENTIFICATION-FREE ALGORITHMS
FOR ADAPTIVE CONTROL AND ITS APPLICATION
JIANG　QINGYIN
(Xiamen University,Xiamen 361005)
Abstract　By combining Smith-predictor,the identification-free algorithms for adaptive control is extended to system with long time delay.A search algorithms is proposed to solve the problem that Smith-predictor is strongly related to system model;and enhance the robustness and the adaptivity of the predictor.The simulation result and the application result in a industrial process are also given.
Key word　Identification-free,adaptive control,predictive control.
1　引言
　　无辨识自适应控制是 Marsik 和 Strejc 提出的一种无需辨识系统参数的自适应控制算法［1］.该法只需在线检测过程的实际输出及期望输出便可形成具有较好的动态性能指标的自适应控制系统.根据文［1］，该算法的控制律可以写成
Δu(k)=g(k)［e(k)+2Tυ(k)Δe(k)+2T2υ(k)Δ2e(k)］.　　　(1.1)
其中 Δu(k)是控制器输出增量，e(k),Δe(k)，Δ2e(k)为控制偏差及其一阶、二阶差分，具备下述形式
e(k)=w(k)-y(k),　　　(1.2)
Δe(k)=e(k)-e(k-1),　　　(1.3)
Δ2e(k)=e(k)-2e(k-1)+e(k-2).　　　(1.4)
上述式中，w(k)为给定输出，y(k) 为系统输出，g(k)为控制器增益，Tv(k)为控制器参数.可见控制器的自适应问题也就是 Tv(k) 及 g(k) 的在线校正的问题.由文［1］Tv(k)可按下述式子校正
ΔTυ(k)=L*sign［｜Δe(k)｜-Tυ(k-1)｜Δ2e(k)｜］　　　(1.5)
其中 0.05≤L*≤0.1.文［1］证明了上式的稳定性和收敛性.
　　文［1］介绍了一种 g(k)的迭代算法，即
　　　　(1.6)
这里 c 为小正数，取值范围为 0.025≤c≤0.05.该算法计算量小、简便可行，在工业过程的控制中有着广泛的应用前景；但该算法并不能解决工业过程普遍存在的大纯滞后问题.本文借鉴Smith 预估器引入无辨识自适应控制的预估算法，使之也能适用于大纯滞后系统.
2　预估算法及闭环特性分析
　　设单入-单出系统特性为
y(k)=z-dG(z)u(k)　　　(2.1)
令　　　　　　　　　　　　　y*(k)=G*(z)u(k)　　　　(2.2)
及预估输出为
yP(k)=y(k)+y*(k)-y*(k-d*)　　　(2.3)
考虑期望输出与预估输出的偏差
eP(k)=w(k)-yP(k)　　　　(2.4)
和控制律 Δu(k)=g(k)［eP(k)+2Tυ(k)ΔeP(k)+2T2υ(k)Δ2eP(k)］，　　　(2.5)
可根据(1.5)，(1.6)式实现 g(k) 和 Tv(k)的自适应.
　　带预估器的闭环控制系统如图1所示，其闭环特征方程为
1+G*(z)C(z)+z-d(G(z)-z-(d*-d)G*(z))C(z)=0.　　　(2.6)


图1　闭环控制框图
若有 d=d* 及 G(z)=G*(z),则闭环特性与无滞后系统同，这也正是Smith预估器希望的效果.但一般不易做到.不少工业系统不仅过程特性可能是时变的，纯滞后时间也会变化.为避免辨识系统特性和纯滞后时间的麻烦，这里引入一简单的搜寻算法，其基本思想是令
G(z)-z-(d*-d)G*(z)→min,
使闭环特性尽可能地接近无滞后系统，在此基础上，利用上述的自适应算法，可使系统获得满意的动态特性，算法如下：
　　1)给出预估模型 G*(z)，一般用一阶模型近似.
　　2)给出搜寻区域［n1,n2］(n1≤d≤n2).
　　3)由 (2.2)式计算 y*(k),y*(k-1),…,y*(k-n2).
　　4)求使下式最小的 j.
　　　(2.7)
　　5)令 d*=j，根据(2.3)，(2.4)式，求预估输出 yP(k)和偏差 ep(k).
　　6)根据(1.5)，(1.6)式校正 g(k) 和 Tv(k).
　　7)根据(2.5)式计算控制律Δu(k).
　　8)k=k+1;转入步3，进入下一轮计算.
3　仿真研究
　　设系统模型 　y(k)=0.6y(k-1)+u(k-104)　　　(3.1)
和预估模型　　　　y*(k)=0.8y*(k-1)+0.5u(k-1)　　　　(3.2)
考察大纯滞后下模型有误差时的控制特性：
　　1)令 d*=96≈d,采用 1.常规 PID 加 Smith 预估器(图2，3中上部)，　2.由(2.3)式提供的无辨识自适应预估算法(图2，3中下部).从图2中可以看出：模型误差在一定范围内时，两法均能稳定，但法2.的特性要优于法1.


曲线类型：以数据点为X轴
图2　d*=96 仿真


曲线类型：以数据点为X轴
图3　d*=66 仿真


曲线类型：以数据点为X轴
图4　搜寻算法仿真
　　2)若令 d*=66≠d,算法同上，仿真结果见图3，其中法1.发散，法2.也无法稳定.
　　3)在同样条件下取搜索区域［66，132］，采用搜寻算法结果见图4.在模型有较大误差的情况下，搜寻算法仍保持良好的动、稳态特性.
　　仿真表明：搜寻算法有良好的鲁棒性对预估模型的精度要求不高.因此实际控制时只需估计一简单的预估模型和确定一搜索区域，便可满足需要，避免辨识模型的困难，该算法简单易行，特别适合工业过程.
4　工业应用
　　本算法已用于某炼油厂催化裂化装置的产率控制，催化裂化是炼油厂的龙头装置，它通过催化反应将重油裂解为轻油(汽油和柴油)气体及焦炭.如何提高轻油收率一直是催化裂化操作与控制的研究重点.由于该装置反应机理复杂，影响因素众多，建模困难.反应生成物需经过分馏、稳定等过程才能检测出来，具有较长时间的传输滞后，且滞后时间随油处理量的大小而变化，这些都增加了控制的难度，故目前只能采用间接方法控制产率，很难达到优化操作的目的.
　　我们采用搜寻算法在 Porvox 集散控制系统及其上位机VAX3100上用 C 语言实现了催化裂化的产率控制.如前述，算法对预估模型要求不高，可简单地采用一阶环节近似，令
y*(k)=0.75y*(k-1)+1.2u(k-1).
　　预估模型的参数应根据实际控制要求选定，如在本例中，控制要求以平稳为主则可选较大的输入系数，以避免超调.为适应纯滞后时间的变化，选择一较大的搜索区域［36，196］.搜索区域原则上应能覆盖纯滞后时间的变化段，在对纯滞后时间估计不准的情况下可稍微大点.为保证控制系统的安全可靠，附设了故障诊断系统和实时决策系统，以实现意外情况下的无扰动切换.
　　一个典型的提给定值的调节过程如图5所示，可以看出该控制系统具有较好的动态特性及稳态特性.


图5　工业应用结果
　　致谢　北京科技大学自动化系舒迪前教授提供了有关资料和理论咨询，北京石科院袁临京工程师提供了Provox控制系统的接口服务，广州石化总厂炼油厂范运隆副总工程师和催化车间的技术人员进行了现场配合，特此致谢.
作者单位：厦门大学化工系　厦门　361005
参考文献
［1］　Marsik J.Strejc V.Application of Identification-free Algorithms for Adaptive Control.Automatica,1989,25(2):273-277.
收稿日期　1994-07-11
