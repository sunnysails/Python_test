微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
1999年 第18卷 第1期 Vol.18 No.1 1999



Windows下利用中文WORD输出AUTOCAD工程图纸
王纯贤
　　摘　要：对AutoCAD和WORD中几种图形格式及生成与调用方法进行了比较，给出了在Windows环境下利用中文WORD对AutoCAD中的工程图纸进行汉化输出的实现方法。
　　关键词：图形格式　WORD字处理软件　AutoCAD绘图软件　工程图纸
　　中文WORD和AutoCAD绘图软件都是目前广为流行的Windows应用软件。其中中文WORD具有强大的文字处理和表处理功能，但它提供的画图工具远远满足不了复杂图形如工程图纸的绘制要求。AutoCAD则以它卓越的图形功能广泛用于绘制各种工程图纸和施工图纸，但西文AutoCAD不能输入汉字，汉化的AutoCAD也只适合于输入少量、字型单一的汉字，难以满足一般工程图纸中输入各种汉字特别是数据表格的需要。本文通过对AutoCAD和WORD中图形格式、生成和调用方法的比较，根据工程图纸的特点，给出了在Windows环境下，通过WORD与AutoCAD的数据交换，对AutoCAD绘制的工程图纸输入各种字型的汉字和各种规格的数据表格，获得足够精确和美观的工程图纸的方法。
1　WORD和AUTOCAD图形格式、生成与调用方法比较
　　WORD 7.0和AutoCAD R12兼容的图形格式主要有4种：
　　1.AutoCAD图形格式(*.dwg)。这是AutoCAD本身提供的以二进制形式存储的图形文件格式，文件较小，在WORD中缩放处理时图形不失真；
　　2.Windows位图(*.bmp)。这种格式在Windows下得到广泛的支持，支持稀疏位图，但在WORD中进行缩放处理时会产生失真现象；
　　3.Windows元图(*.wmf)。这种格式具有高级的性能描述，文件比相应的位图小很多，在WORD中缩放时不失真，是Windows下与设备无关、最好的1种图形格式；
　　4.惠普图形语言HPGL图(*.hgl)。这种格式易产生图形，与图纸大小无关，但在AutoCAD中生成很麻烦，在WORD中处理结果与元图相同。
　　由以上比较可见，利用WORD处理AutoCAD工程图形时采用AutoCAD本身的图形文件和元图格式最好。在AutoCAD中生成元图图形格式的方法有2种：文件方式和剪贴板方式，其生步骤分别为：
　　1.文件方式：打开AutoCAD软件绘制好工程图形，选FILE项，在其下拉菜单中选择Import/Export项，再在其弹出菜单中选择WMF out…项，再按提示输入文件名或回车默认取原图形文件名，之后可用矩形框选择所需的图形回车即可生成1个扩展名为.wmf的元图文件。
　　2.剪贴板方式：打开AutoCAD软件绘制好工程图形，选EDIT项，其下拉菜单中有多项选择，其中有2个选项可以生成元图格式图形。如选择COPYVECTORS，再按提示选择需粘贴的图形，则向剪贴板上复制进1个.wmf格式图形；如选择COPYEMBED，再按提示选择需粘贴的图形，则在剪贴板上生成1个具有OLE(对象链接与嵌入)功能的.wmf格式图形。
　　在WORD中调用元图图形格式AutoCAD图形的方法也有2种：
　　1.图片插入方式：打开中文WORD进入编辑状态，把光标移到欲粘贴图片的位置，然后下拉插入［I］菜单选择图片［P］项，之后按提示直接输入已生成的图片文件名或在对话框中选择图片文件，图片便被插入到指定位置。
　　2.剪贴板粘贴方式：在WORD编辑状态下，把光标移到欲插入图形的位置，再进行粘贴操作，剪贴板上的AutoCAD图形便被粘贴到指定位置。
　　在WORD中直接调用AutoCAD本身的图形文件插入图形的方法是：进入WORD编辑状态，把光标移到欲插入图形的位置，下拉插入［I］菜单，选择对象［O］项，再按提示选择由文件创建［F］项，从列出的文件目录中选择所需的*.dwg文件，再选择链接到文件项即可调入该.dwg格式图形。该操作具有OLE功能，因此系统将同时打开AutoCAD供用户对该图形修改。
　　从以上所述可以看出，AutoCAD和WORD之间的数据交换可以通过文件方式或剪贴板方式实现，其中以剪贴板方式最为灵活快捷，因此一般情况下应优先选择这种方式。另外，剪贴板方式使用COPYEMBED命令较好，其优点在于具有OLE功能，允许用户直接在WORD中调用AutoCAD进行图形修改。具体方法是先用鼠标选中粘贴进入WORD中的图形，再用鼠标双击该图形即可调入AutoCAD进行图形修改，修改之后按提示作出选择即可更新WORD中的图形。
2　利用中文WORD对AutoCAD工程图纸汉化输出
　　对工程图纸的一般要求是：(1)图面尺寸应符合比例，图幅周边有图框线；(2)在图面的空白处附注汉字说明，如技术要求、参数列表等；(3)在图面右下方设置数据表格，如标题栏、明细等；(4)图形中作少量的汉字标注。根据这些要求，在用WORD输出AutoCAD工程图纸时，可以采用前面所述方法把已绘制好的工程图形在AutoCAD中生成图片文件或复制到剪贴板上，再调用中文WORD，采用适当的技巧进行处理。下面以COPYEMBED命令为例说明具体操作方法。
　　第一步：生成常用空白图纸库，其目的是生成各种常用标准图幅的空白图纸备用。以纵向布置的A5号图纸(210×148)为例：
　　1.打开中文WORD 7.0，在页面设置中设置纸张大小为A5号，左边框为2.5cm，上、下、右边框均为0.5cm，方向设置为纵向。
　　2.利用WORD强大的制表功能，通过自动制表、手动制表、单元格合并操作，建立1个表格如图1所示。其中(1)区主要用于放置图形，(4)区为标题栏，(2)、(3)区则主要用于输入汉字。


图1　表格
　　3.按工程制图标准，对图1进行单元格调整和实化图框线操作。就本例而言，把(1)和(2)区的总宽×总高设置为18cm×11cm，(3)区的宽×高设置为4cm×2.8cm，(4)区标题栏的总宽×总高设置为14cm×2.8cm，标题栏中各栏的尺寸设置方法与此类似。实化图框线时，画细边框线应把制表笔粗细设置为3/4磅(约0.27mm)，画粗边框线时则应设置为1.5磅(约0.53mm)或2.25磅(约0.8mm)，之后在标题栏内填好汉字，即可得到如图2所示的一张完全符合国家标准的空白图纸画面，图中的虚线在图纸输出时不显示。

图2　符合国家标准的空白图纸
　　4.存盘退出。之后借助于这个图纸文件通过纸张大小设置和单元格调整操作即可很方便地生成各种符合国家标准尺寸的图纸，为方便管理和使用，把这些标准空白图纸文件放入一专门子目录中形成1个空白图纸库。　　
　　第二步：打开AutoCAD R12，按比例绘制好工程图，再键入“DIST”命令，得到图形左右端点距离X，之后下拉EDIT项，从弹出菜单中选择COPYEMBED命令，再选取全部图形复制到剪贴板上。
　　第三步：根据所绘制图形的大小从第一步已建立的空白图纸库中复制出1个图幅大小合适的空白图纸文件，将其文件名改为欲输出图纸的文件名，之后双击鼠标将其调入WORD中，进入编辑状态。这一步相当于在图板上铺上1张标准空白图纸。
　　第四步：将光标移至图2中(1)区合适位置，再将剪贴板上的图形粘贴进来。用光标选中图形，此时在图形周边出现8个小方框，将光标移至位于对角的方框上，出现双箭头时即可按比例缩放图形。对照标尺使其宽度等于第二步中的X值。
　　第五步：填写标题栏，在图2中的(2)区或(3)区输入汉字说明。(1)区中的汉字则可在任意位置使用WORD绘图功能中所提供的文本框、垂直文本框或标注功能，方便地输入各种大小、式样的汉字。编辑再完成之后，存盘待输出。
3　结束语
　　本文所介绍的方法简便易行，不需二次开发，仅使用通用软件和普通打印机就能输出美观、汉化的工程图纸，适合于中小型企业特别是广大的个人AutoCAD用户。需要注意的是，目前WORD 7.0能够处理的纸张幅面最大为55.87cm×55.87cm，因此无法直接输出超过此尺寸的大幅面AutoCAD工程图纸，但可以间接地采取分而治之的策略，把AutoCAD工程图形分成大小适当的几部分分别调入WORD中，再在WORD中对照标尺按比例缩小，并在图2中的(1)区和(2)区合理调整各部分位置，即可得到1张按比例缩小的大幅面AutoCAD工程图纸。　　
作者单位：合肥工业大学机械工程系(230009)
参考文献
　1　侯阳.微机图形文件格式集粹.北京：学苑出版社，1993
　2　SOEN F著，阮红译.深入剖析AutoCAD 13 for Windows.北京：科学出版社，1995
　3　STEELE H著，宋荣译.怎样使用Microsoft Word for Windows 95.北京：电子工业出版社，1996
(收稿日期：1998-07-12)
