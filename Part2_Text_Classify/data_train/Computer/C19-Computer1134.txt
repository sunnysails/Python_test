自动化学报
ACTA AUTOMATICA SINICA
1999年　第25卷　第5期　Vol.25 No.5 1999



Kalman滤波的抗野值修正1)
胡　峰　孙国基
摘　要　分析了动态测量系统中异常数据对Kalman滤波的不利影响.提出了一组具有良好容错能力的修正型滤波算法.该滤波算法既可以充分利用正常新息确保滤波的精度，又可以有效拟制异常新息的不利影响提高滤波估计可靠性，达到对故障数据的容错能力.最后，通过仿真计算验证了该算法的有效性.
关键词　Kalman滤波，动态测量系统，野值，容错滤波.
FAULT-TOLERANT IMPROVEMENT ON KALMAN FILTER
HU Feng　　SUN Guoji
(System Engineering Institute,Xi'an Jiaotong University,Xi'an　710049)
Abstract　The influence of outliers on the Kalman filter is analysed,and a new set of modified algorithms,which are fault-tolerant to outliers is built. These new algorithms can not only sufficiently absorb good innovations to increase filtering precision but also efficiently restrain bad influence coming from outliers.These new filters have high security and fault-tolerant capability when abrupt faults take place.Simulation results show that the modified filtering algorithms are practical and efficiently resistant to outliers in sampling data.
Key words　Kalman filter, dynamic-measurement system, outlier, fault-tolerant filter.
1　引　言
　　本世纪60年代初期随状态空间理论发展起来的Kalman滤波技术是一组以递推关系给出的随机系统状态最优线性滤波算法，它具备优良的数学性质［1］，并在随机控制、信号处理、过程监控和故障诊断［2］等诸多领域中有着十分广泛的应用.
　　但是，近十几年来大量的研究结果揭示［3―6］：Kalman滤波算法缺乏对测量数据过失误差的抗扰性和对传感器突发性故障的容错能力.应用Kalman滤波算法处理工程实际问题的经验也证实，测量数据中即使包含少量的过失误差对Kalman滤波效果也会产生严重的不利影响，甚至导致目标状态估计明显地偏离系统真实状态.
　　工程领域中称传感器发生突发性故障时的采样信息或含过失误差的测量数据为野值(Outliers).本文从过程控制和随机信号处理的实际出发，系统分析野值对Kalman滤波的不利影响，并建立一组具有抗野值干抗能力的修正型递推算法.
2　野值对Kalman滤波的影响分析
　　对于线性动态测量系统
　(1)
状态向量的Kalman滤波算法为［1］
　(2)
式中样本新息,滤波增益Kk+1=Σk+1Hτk+1｛Hk+1Σk+1Hτk+1+Rη(k+1)｝-1;Σk+1=Ak+1(I-KkHk)ΣkAτk+1+Rε(k),Rη(k)=cov(ηk,ηk),Rε(k)=cov(εk,εk).
　　从式(2)可以看出，新增加样本点yk+1所带来的新息(innovations)是以线性组合的方式对Kalman滤波估值产生影响的.因此，当样本点yk+1为“正常值”时，新息会对tk+1时刻的滤波估计值进行正确的修正(修正倍数为滤波增益Kk+1)；如果新增样本点yk+1为“异常值”(即野值)时，带来的异常新息也会以Kk+1倍地对系统的状态预报进行错误修正，使滤波估计值发生偏移.
3　含野值数据序列的处理对策
　　在序贯处理和实时测控过程中，对大量实测数据进行野值点统计诊断是比较困难的.因此，为了提高Kalman滤波的容错能力，有必要对滤波算法进行容错改进或适当修正，并要求
　　1)修正后的滤波算法有简洁的递推关系，便于工程应用；
　　2)当观测数据序列中含有少量野值时，能有效克服其不利影响，或者至少能将其影响控制在某预先给定界限内，以确保滤波估计值尽可能接近系统真实状态；
　　3)当数据集合中不包含野值时，能充分利用有效新息提高滤波精度.
　　基于上述设想，本文构造出一组类似于Kalman滤波的修正算法
　(3)
式中Φk+1(.)为适当选取的按段光滑的函数，称为压缩影响函数；Kk+1为滤波增益，Gk+1为权矩阵.
　　显然，式(3)描述的是一个滤波族，随着Φk+1(.)取法的不同，可以得到具有不同统计性质的滤波算法.
　　可以证明，当选取Φk+1(.)=1,Gk+1=I(单位矩阵)时，式(3)给出的即为Kalman滤波.但是，序列｛Φk+1(.)=1｝作用的直接效果是同等看待正常新息和异常新息，导致滤波算法缺乏抗野值干扰的能力.
　　鉴于此，一种合理的容错处理策略是通过适当选取Φk+1(.)使得当rk+1增大时Φk+1(.)减小或接近于零.
4　最佳Φk(.)函数的选取
　　基于第3节的分析，为削弱野值数据对状态滤波的不利影响，可以通过适当选取压缩影响函数Φk+1(.)来限制滤波修正项
　(4)
的大小.即对适当给定的门限常数ck+1，通过合理地选取压缩影响函数Φk+1(.)，使得下式成立：
　(5)
式中的最大特征值.
　　不难看出，满足条件(5)的Φk+1(.)函数序列有很多，可形成集合S
　(6)
下面，具体讨论从集合S中选取最优压缩影响函数序列Φk(.)的方法.
　　定理.当线性随机系统(1)的基本随机序列｛x0,ε0,ε1,…,η1,η2,…｝为服从正态分布且互不相关时，如果选取权矩阵序列Gk+1=Hk+1Σk+1Hτk+1+Rη(k+1)，则在函数族S中使滤波误差均方差最小的Φ函数为
　(7)
其中Ck为适当选取的门限常数或常数序列.
　　证明.由式(3)，(2)有
　(8)
问题转化为关于集合S的极小化问题.由式(2)，(3)有
　(9)
结合S的定义知，式(7)给定的｛Φk(.)｝在S中使上式(9)达到最小.
证毕.
　　实际应用中，为简化计算也可采用如下形式的｛Φk(r)｝函数序列
　(10)
式中C*1为适当选取的非负常数.
　　下面，对门限常数Ck+1的选取方法做一简单讨论.
　　在上述定理条件下，可以证明ω(k+1｜k)服从标准的多元正态分布.因此,‖rk+1=ω(k+1｜k)‖2服从自由度为m的χ-分布.取该χ-分布的置信度为(1-α)×100%的上分位点为cα（m)(α常取0.05或0.025)，则门限常数Ck+1的合理取值可采用下式给定：
Ck+1=(λk+1cα(m))1/2　(11)
在工程问题的具体应用中，门限Ck+1也可凭经验选取.
5　仿真计算
　　设定线性随机系统模型(1)的系数阵和误差协方差阵分别为

并选取系统的初态为x(0｜0)=(1.3，1.5，2.3)τ,Σ(0｜0)=0.01I3，I3表示s阶单位矩阵.
　　采用Monte Carlo方法产生100组仿真“测量”数据(记为集合S).将集合S中第50，60，75点分别引入偏移量(Δy1,Δy2)=(-1)i(100,-5)(i=50,60,75)形成含3个野值点的数据集合S*.利用S*中的数据，分别按式(2)，(3)计算状态的滤波估计，结果如图1和图2所示：


图1　3维状态空间Kalman滤波


图2　3维状态空间的容错滤波
　　从图1、2可以看出，野值对Kalman滤波有十分明显的不利影响，本文提出的容错修正算法能够有效地克服野值点的不利影响，提高滤波估计的可靠性.
致谢　本文曾得到张殷龙副总工程师、李济生院士和范金城教授的指导，谨致谢忱.
1)西安交通大学研究生院博士学位论文基金(DFXJU1998-10)资助项目.
作者简介：胡　峰　男，1964年生，1989年硕士毕业.现为西安交通大学系统工程研究所博士研究生，西安卫星测控中心某技术室副主任、高级工程师、中国宇航学会会员、《飞行器测控学报》编委.近年来承担科研课题7项，参加大型航天试验任务30多次，发表研究论文50多篇(其中11篇论文获奖)，获部委级科技进步二、三等奖6项.主要研究方向为复杂系统建模与仿真、大系统控制论、数据诊断与稳健-容错处理技术.
　　　　　孙国基　1936年生，1966年获得苏联科学技术系统仿真副博士学位，历任西安交通大学副校长和该校工程与科学研究院院长.现为博士生导师、全国系统仿真学会副理事长、《系统仿真学报》等学术期刊的编委.近年来，主要从事CIMS仿真和虚拟现实在仿真中的应用研究，先后承担“863”国家高技术计划等攻关课题多项，获全国科学大会奖及多项部委级科技进步奖，并发表研究论文50多篇.
作者单位：西安交通大学系统工程研究所　西安　710049
参考文献
1　韩崇昭，王月娟，万百五.随机系统理论，西安：西安交通大学出版社，1987
2　Isermann R.Process fault detection based on modeling and estimation methods-a survey. Automatica,1984，20(4)：387―404
3　Martin C J,Mintz M.Robust filtering and prediction for linear systems with uncertain dynamics:a game-theoretic approach.IEEE Trans on Automatic Control,1983,28(9):888-896
4　胡　峰，范金城.动态测量系统有界影响滤波.控制理论与应用，1993，10(1)：36―45
5　胡　峰，范金城.动态测量系统抗扰性预报算法.宇航学报，1995，16(1)：93―96
6　胡　峰，范金城.动态-测量系统抗扰性技术研究的发展综述.数理统计与应用概率，1996，11(3)：244―248
收稿日期：1997-09-01
修稿日期：1998-06-23
