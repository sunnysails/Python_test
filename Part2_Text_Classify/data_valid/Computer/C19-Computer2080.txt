计算机工程
Computer Engineering
1999年　第25卷　第9期　Vol.25 No.9  1999



大中型工业企业DCS和MIS集成的实现与应用
严　华　李建国　李中志　王劲松
　　摘　要：得出了在大中型工业企业中将DCS与MIS系统集成的基本思路，讨论了与DCS和MIS密切相关的生产住处管理系统的实现方法，并给出具体的应用实例．
　　关键词：分布式计算机控制系统；管理信息系统；集成
Application and Realization of Intergating DCS and MIS in Large and Medium Scale Industry Enterprises
Yan Hua Li Jianguo Li Zhongzhi Wang Jingsong
(Electronical Information College of Scichuan University, Chengdu 610064)
　　Abstract　The thought of integrating DCS and MIS in Large and medium scale industry enterprises is introduced in this paper. The method of realizing production information management system (PIMS) which is relative to DCS and MIS closely is provided. Apractical example is also offered in this paper.
　　Key words　DCS; MIS; Integration
　　许多大中型企业在建立或规划MIS时往往会忽略DCS(分布式计算机控制系统)的各类信息，使DCS与MIS脱节成为一个信息"孤岛"。这必然会导致：(1)企业决策时，缺乏准确、及时的原始数据和情况分析；(2)企业管理中的信息冗余、准确性差、不畅通；(3)企业计划能力差，导致生产不均衡，影响产品质量和能源的合理利用。因此，企业已不能再满足DCS的孤立应用，应将DCS与MIS紧密地结合起来，达到信息集成与决策，以便解决企业中的许多复杂问题。为此，设计了一种将DCS与MIS集成的计算机生产信息管理系统，并从1997年12月在辽宁抚顺洗涤剂化工厂应用、实施。
1　系统主要功能
　　企业计算机生产信息管理系统利用Client/Server结构，通过计算机网络环境及相应的软件系统，使企业内部的微机工作站都能及时准确地显示DCS实时数据，并能够根据实时数据动态显示工艺流程图等画面；同时形成实时数据库，并按指定条件选择实时数据存入历史数据库，实现企业生产控制、监测、管理一体化。它具有的功能主要有：(1)生产系统的数据采集；(2)实时数据和状态显示；(3)报警产生及处理；(4)过程数据运算；(5)各类画面及图形显示；(6)生成并打印各类报表；(7)存储数据及查询、生产调度；(8)提供标准软件接口与企业MIS系统进行连接，提供DCS数据，以便MIS系统能进一步实现质量管理、计划调度、班组考核、质量分析、成本核算、能耗统计和质量评定。
2 计算机生产信息管理系统的实现
2.1 系统特点
　　生产信息管理系统的设计、开发涉及的因素很多，各种因素之间的关系很复杂，难度高、工作量大，主要表现在：.系统服务器及有关子系统需要连续运行；.系统实时性要求高，从而对通信速度及系统处理速度的要求也很高；.系统收集信息要全面，使系统数据量和数据流量均相当大，系统负荷重；.系统软件需跨越多个平台进行设计；.系统要求的管理功能多而且复杂，需设计大量图表；.系统要求的可靠性高，相应地对硬、软件的选型、设计的质量要求也很高；.系统在安装、调试、运行时不能影响企业生产系统的正常工作。
　　这就要求计算机生产信息管理系统应具有如下特点：
　　(1)技术先进性；(2)良好的开放性和互操作性；(3)灵活的可扩充性；(4)高度的可靠性和安全性。
2.2 系统结构
　　系统采用分层结构，即通信层、数据仓库层和监控管理层的3级结构。监控管理层与数据仓库层、MIS系统与数据仓库层、数据仓库层与通信层均为Client与Server的关系，采用Client/Server结构。如图1所示。

图1　系统结构示意图
　　(1)通信层：运用通信软件，通过标准通信接口和研制的设备，获取DCS所采集的生产现场信息，它包括：各种流量、压力、液位、温度等模拟量当前数值；各种开关量当前状态值；各控制回路的回路信息；DCS的组态信息；各种报警信息；各I/O点当前数据；每个I/O点的名称、上下限、状态等信息。
　　(2)数据仓库层：根据生产具体情况建立实时数据库,分配存储空间，并做相应的设置。通信层从DCS获取的生产信息，进行计算和处理以后，按数据库的要求存储在实时数据库中。建立历史数据库，根据生产和用户的要求，有选择地把实时数据库中的数据存入历史数据库中，以供生产信息查询和生产状况分析。同时，数据仓库层还对实时数据库和历史数据库定期地进行处理和维护，如删除无用信息，定期备份等。另外，提供标准数据库接口(如ODBC)及通信协议与MIS系统交换信息。
　　(3)监控管理层：负责对整个系统进行监控与管理，层中的每一个子系统即为生产信息管理系统的一个客户。这些子系统直接供厂长、总工程师等人员以及总调度室等部门使用。监控管理层要完成的任务是：合理分配存储空间、外设等资源，对每个客户做正确的设置；绘制工艺流程、趋势、状态、报警等各类画面；建立与数据仓库层的双向联系，可相互交换信息；根据客户需要进行相应组态，设置各种组态信息；对生产信息作相应的分析与处理，如运算、统计、报警处理等；生成各种客户所需要的报表并可打印；根据用户级别的高低，设置相应的权限；根据需要，建立本机数据库，并进行科学的管理和处理，如生成时报、班报、日报、周报、月报和年报等运行报表；对生产情况进行考核。
2.3 网络拓扑结构
　　(1)生产区的网络拓扑结构采用总线型，如果生产信息传送速率要求很高，可采用环型拓扑结构，因为环型拓扑结构具有时延和确定上限的优点，能够保证实时性。
　　(2)对于小型系统，DCS接口单元数目不多、比较集中且数据通信量不是很大，通信层和数据仓库层可由一台计算机来实现。


图2　网络拓扑结构示意图
2.4 技术要点
　　(1)与DCS接口单元通信 集成DCS与MIS的前提是能够与DCS建立良好的通信环境。通常DCS均会提供标准接口来完成DCS与其它系统之间的通信。最常用的是RS232C，如Bailey的Network-90，Yokogawa的μXL，HoneyWell的6200系列，ABB的ASEA Masterpiece等。有些DCS提供了专门的插卡来完成通信，现在一些开放性能较好的DCS也可以通过Ethernet接口来与其它计算机系统通信。因此，在设计通信层时，须认真阅读DCS产品说明书，以便编制通信程序。当然，部分DCS厂商也会提供通信接口软件包。
　　(2)数据存储　根据数据集成的要求，需将从DCS采集到的大量实时数据实时地、有选择地存到数据仓库中，以备生产信息管理系统信息的存储、查询和MIS系统能对这些数据作进一步的加工处理，使其发挥更大的作用。数据仓库需要在数据库中插入时间标志，以表明历史数据的先后顺序。数据仓库需要巨大的存储空间，因此可以放在全厂MIS系统的总服务器上。
　　为减少历史数据所耗费的存储空间，系统可采用例外报告传送方式来形成数据仓库。每一个过程变量要传送到数据仓库都必须受到一些限制，无论时间或信号值的大小都是这样。当过程变量有"明显"改变时，就产生一个新的例外报告。在例外报告传送方式中规定最小时间和最大时间。最小时间是用来限制快速变化信号的传送速率，以防止耗费大量的存储空间。最大时间是用来使缓慢变化信号能按指定时间向数据仓库传送数据。
　　(3)组态工具软件　系统应根据可靠性高的原则，选择国内外成熟、可靠的通用组态软件包，以实现实时数据的监督和管理。当然，也可以自行开发组态软件。组态软件通常应具有如下功能：各类应用工具，如画面、警报、动态趋势、变量标识、动态图形、实时数据、软功能键、控制器面板、密码保护、在线组态开发等；对实时数据及历史数据进行数据趋势显示、分析和打印；提供各种函数及逻辑计算功能，使用户方便地对实时数据库的数据进行操作，并支持非编程实现各种计算功能；对各类应用工具(例如对报警、实时趋势、变量标志及画面上的动态图形和功能键)进行在线和离线组态、定义；具有绘制流程画面的制图软件包；具有密码编辑软件包；支持与其它软件包相连的动态数据交换接口，如DDE等。
　　(4)数据库接口　可采用DDE、ODBC等标准接口来实现生产信息系统与其它MIS系统之间的数据交换。
3　应用实例
　　抚顺石化公司洗涤剂化工厂(以下简称洗化厂)是亚洲最大的洗涤剂原料生产基地，90年代初从美国贝利公司引入Network-90 DCS设备用于烷基苯和脂肪醇的生产监测和控制。1997年5月委托我单位开发管理信息系统。计算机生产信息系统为该系统内的一个特殊的子系统。该系统已于当年12月安装并投入使用，现正常运行至今。系统具有技术先进、开放性良好、扩充灵活、可靠、安全、界面友好、操作与维护简单等优点，从而受到厂方各级用户的一致好评，并为洗化厂生产系统的正常运行提供了良好的监测与管理环境。
3.1 洗化厂DCS系统
　　洗化厂DCS系统为美国贝利公司(Bailey)的Network-90系统，它由3个过程控制单元PCU，6个管理控制系统MCS，1个过程计算机接口单元CIU和1个上位机接口单元共11个节点组成。Network-90系统的通信环路为厂环，它把环路上的节点联结起来。整个生产系统的控制回路近400个，I/O点数有4003点 (AI：1363，AO：672，DI：1152，DO：816)。
3.2 计算机生产信息管理系统XH_PIMS
　　(1)检测点数 厂方指定的系统参数点(包括模拟量与开关量)总共为1748点。
　　(2)各类画面幅数 流程画面123幅；趋势画面378幅；总貌画面9幅；累积量画面55幅；报警画面87幅；报表画面114幅；系统介绍画面17幅；其它画面31幅；总计：814幅
　　(3)报表数量 实时报表114张；历史报表114张；报表查询任意记录参数。
　　(4)通信速率与数据平均刷新频率 网络通信速率10Mbps；数据平均刷新频率10秒。
　　(5)数据存储、管理性能 将采集的数据全部按要求准确无误地存入实时数据库；按照一定的选择条件从实时数据库中选取数据存入历史数据库，存储的时间长短由用户定义(1小时到数年)；将历史数据进行备份等处理。
　　(6)画面性能 颜色256色或更高；画面大小640 x 480，可支持更高分辨率；画面显示速度<4秒。
　　(7)开发平台性能 人机界面友好，操作方便，全中文显示；开放性良好，厂方技术人员培训后能进行修改和二次开发。
　　(8)系统维护 利用MIS系统的网络功能，通过通信设施，以远程终端的方式进入抚顺石化公司洗涤剂化工厂计算机生产信息管理系统，对系统进行在线维护。
4　结束语
　　生产与管理是企业的中心主题。对于已经引入DCS设备的企业来说，将DCS和MIS集成不失为一种投资小、建设周期短、见效快的新思路，是企业实现CIMS的一条捷径。
作者简介：严　华(1971～)，男，讲师，主要从事计算机与自动化方面的研究与工程应用
作者单位：四川大学电子信息学院，成都　610064
参考文献
1 王常力，罗安. 集散型控制系统选型与应用.北京：清华大学出版 社，1996
2 王常力，廖道文. 集散型控制系统的设计与应用.北京：清华大学 出版社，1993
收稿日期：1999-03-19
