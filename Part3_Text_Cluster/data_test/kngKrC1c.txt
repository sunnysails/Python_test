导弹与航天运载技术
MISSILES AND SPACE VEHICLES
1999年 第1期　No.1 1999



利用Excel进行推进剂剩余量的分析与计算
杨建民
　　摘要　推进剂剩余量分析与计算是运载火箭飞行结果分析的重要环节。讨论了利用Microsoft Office软件包中的Excel软件的强大表格处理和数据处理功能，通过建立推进剂剩余量模板，来完成运载火箭飞行结果分析中推进剂剩余量的分析与计算工作，并详细描述了Excel模板的建立及推进剂剩余量计算模板的设计过程。
　　主题词　推进剂余量，运载火箭，飞行后分析，计算机，软件。
Residual Propellant Analysis and Calculation 
by Using Excel 
Yang Jianmin
(Beijing Institute of Astronautical Systems Engineering,100076)
　　Abstract　Residual propellang analysis and calculation of launch vehicle is an important part in post -flight data analysis.This paper discusses the construction of residual propellant template in Excel format by using the powerful sheet processing and data processing function of Excel,and the residual propellant analysis and calculation by using the residual propellant template.The design process of construcing the residual propellant template is detailed.
　　Key Words　Remaining propellant mass,Launch vehicle,Post flight analysis,Computer,Software.
1　前　言
　　推进剂剩余量分析与计算是运载火箭飞行结果分析的重要环节，是分析和评估火箭性能及发动机性能的重要手段。
　　在运载火箭各推进剂组元箱体中安装有推进剂剩余液位传感器，传感器上有若干个信号发讯点。在运载火箭飞行过程中，当推进剂液位达到某发讯点所在位置的液面时，传感器就将信号发给遥测系统，遥测系统记录发讯点发出信号的时间。通过发讯点对应的容积可以计算信号出现时的推进剂剩余量。若干个信号发讯点可以得到若干个推进剂剩余量及相对应的时间，通过最小二乘分析方法，可以预测发动机关机时的推进剂剩余量，进而进行火箭飞行性能分析及发动机性能分析。
　　 Microsoft Excel是一个集成化的快速制表以及把数据图表化的软件工具包，它可以创建和修改工作表、二维／三维图形，可用来完成一系列商业、科学和工程任务。
　　利用Excel的制表功能、数据处理功能，以及作图功能可以完成较为复杂的运载火箭飞行结果分析工作。下面通过建立一个推进剂剩余量计算模板，来完成运载火箭飞行结果分析工作中推进剂剩余量的分析与计算工作。
2　建立表格并进行计算
　　一个完整的推进剂剩余量计算模板，包含有8列信息：第1列为发讯点数信息，为字符串格式；第2列为信号出现的时间；第3列为发讯点距法兰的实际距离；第4列为发讯点液位对应的推进剂容积；第5列为推进剂发射温度；第6列为对应发讯点液位的推进剂剩余量；第7列和第8列为发讯点距法兰的理论距离及其对应的理论容积，用作插值表信息(见图1)。


图1　推进剂剩余量计算表格
　　第2列和第3列信息，即列B和列C，为输入参数，代表发讯点信息遥测参数；因为每发火箭的箱体推进剂剩余量传感器的实际安装位置会略有差异，列D的推进剂容积是根据实际的发讯点距法兰的距离，按列G和列H提供的插值表，进行插值计算得到。Excel提供了线性回归预测函数FORECAST，通过该函数可以进行插值计算。在D3单元格输入：
＝IF（B3＝“”，“”，FORECAST（C3，H3：H4，G3：G4）
这里使用了Excel的条件函数IF，其格式为
IF（Logical　test， value　if　true，value　if　false）
含义为如果测试条件Logical　test为真，则进行value　if　true的操作；否则进行value　if　false的操作。因此，D3单元格的含义为：如果B3单元格内容为空，即没有相应发讯点的遥测参数时，D3单元格为空，否则进行该发讯点对应液位容积的计算，即FORECAST（C3，H3：H4，G3：G4）。这里C3为实际发讯点距法兰的距离，G3：G4，H3：H4为插值表x数组和y数组。在D3单元格函数输入结束后，D4，D5等其它发讯点液位容积的计算，可以通过Excel的自动填充功能来完成，不必每个单元逐个输入。
　　为得到相应发讯点的推进剂质量，还需要知道推进剂的温度。可在E3单元格输入推进剂的温度。E4，E5等单元内容与E3单元一样，可以通过Excel的自动填充功能来完成。F列为推进剂质量，在F3单元格输入根据容积和温度进行推进剂质量计算的公式：
＝IF（B3=“”，“”，D3*(1.458＋（15-E3）*0.002 5））
其含义为如果没有相应发讯点的液位遥测参数，则F3单元格为空，否则根据D3单元格的推进剂容积以及E3单元格的推进剂温度，进行推进剂质量的计算，并将结果在F3单元格内显示。F4、 F5等单元内容可以通过自动填充功能来完成。
3　建立图表并进行最小二乘拟合
　　在推进剂剩余量传感器发讯点对应的推进剂量计算完毕后，令人最为关心的是从中得到发动机平均流量，以及关机时的推进剂剩余量、飞行结束时的推进剂最终剩余量等参数。因此，下面的工作是如何对计算得到的推进剂剩余量进行数据平滑处理，并从中得到想要的东西。
　　按住Ctrl键不放，同时用鼠标左键单击列B和列F的列标B和F，即选中B和F两列。在“插入”菜单“图表”栏选中“在原工作表中嵌入”项，选中图表类型中的“XY散点图（S)”、折线图，即将推进剂剩余量与时间的对应关系图画在工作表上。在工作表上双击该图表，使其处于激活状态，单击选中曲线，在“插入”菜单中单击“趋势线（R)…”项，即可为数据增加趋势线。
　　趋势线用于预测分析，也称回归分析。利用回归，可以在图表里根据实际数据向前或向后模拟数据的走向。这对利用剩余液位遥测参数计算推进剂剩余量是非常有意义的。根据遥测关机时间，通过回归分析，计算关机时的推进剂剩余量。
　　在选中趋势线命令后，屏幕上出现图2所示的“趋势线”对话框。单击对话框中的“类型”按钮，在对话框中的“趋势预测／回归分析类型”中，选中合适的类型。在图2所示的回归分析类型中，分别选中“线性”和“多项式”用于推进剂剩余量分析的回归类型，可将“线性”回归和“多项式”回归曲线显示在图表上。“线性”类型是计算由方程y＝ax＋b所代表的最小二乘方拟合直线，可用于发动机平均流量的计算。“多项式”类型是计算由方程y＝b＋c1x＋c2x2十c3x3+…+c6x6所代表的最小二乘方拟合曲线。选中该项时，必须指定多项式的阶数，这里选用2，即二阶曲线。使用二阶曲线拟合，可以较为准确地计算发动机关机时的推进剂剩余量。


图2　“趋势线”对话框
　　在“趋势线”对话框的“选项”按钮中选中“显示公式(E)”，即可在图表上显示拟合曲线的同时，将回归直线或曲线的计算公式显示在图表上。根据这些拟合曲线公式以及遥测发动机关机时间，计算发动机关机时的推进剂剩余量。
4　推进剂剩余量计算
　　推进剂剩余量曲线及拟合曲线公式见图3。在C23单元格中输入遥测关机时间，根据图表中的拟合曲线公式，在C25单元中输入关机时推进剂量的计算公式，这样就完成了整个计算过程。在本文示例中，关机时推进剂剩余量为442 kg,发动机平均流量为199.59 kg/s。


图3　图表及剩余量计算
　　在完成某一箱体推进剂剩余量计算处理后，可以利用Excel“编辑”菜单中的“移动或复制工作表”命令，进行运载火箭其它箱体的推进剂剩余量计算表格处理，分别替换列G和列H的内容，完成整个火箭推进剂剩余量的计算工作。
5　保存为模板文件
　　通过拖拉选中并单击Delete键，删除表格中“信号出现时间”、“发讯点距法兰实际距离”、“推进剂温度”等列内容，以及C25单元的数据，即在计算模板中仅保留发讯点距法兰的理论距离及其相应容积（列G和列H的内容）；单击“文件（F)”菜单，并选择“另存为（A)”命令，在“保存类型（T)”中选择“模板”类型；然后在“文件名”区输入模板名称，这里取名为“PROP　RES”(见图4)。最后按“保存”键，完成推进剂剩余量计算模板的整个设计过程。


图4　推进剂剩余量计算模板
6　剩余量计算模板的使用
　　当需要根据遥测参数计算推进剂剩余量时，可以直接调用剩余量计算模板，具体操作步骤如下：
　　启动Excel，在“文件（F)”菜单中，单击“新建（N）”选项，在“新建”对话框中的“常用”标签中即可找到“PROR　RES”模板，双击该模板即可打开推进剂剩余量计算模板；在B列相应位置输入推进剂剩余量传感器发讯点出现的时间，在列C相应位置输入推进剂剩余量传感器发讯点液位的实际容积。例如在B3和C3单元分别输入发讯点1出现的时间以及相应容积。可以利用Excel将遥测参数相应的文件打开，利用粘贴方式将B,C两列数据一并输入。
　　在E3单元输入推进剂温度。这时，各发讯点对应的推进剂剩余量数据马上就显示在列F中，同时剩余量图形以及回归分析公式即显示在表格中的图表上。这时在C23单元输入发动机关机时间；在C25单元中输入图表中的回归系数，这时发动机关机时的推进剂剩余量即显示在C25单元中。为使最后推进剂剩余量的结果更加醒目，在作模板时可以将C25单元用醒目颜色标出。
作者单位：杨建民(北京宇航系统工程设计部，100076)
参考文献
　[1]　高志刚，徐东等编著.怎样使用Microsoft Excel 7 for Windows(95中文版).电子工业出版社，1996.
　[2]　冯春山，马力.Office 97模板制作（Excel篇）.电脑爱好者,1998(8):32
收稿日期：1998-09-21
