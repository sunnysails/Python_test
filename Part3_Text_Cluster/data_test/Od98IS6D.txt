导弹与航天运载技术
MISSILES AND SPACE VEHICLES
1999年 第3期　No.3 1999



仿真可信性分析与导弹系统的仿真可信性
李鹏波
　　摘要　介绍了国际上仿真可信性研究的概念和方法。根据动态系统仿真的特点，将其可信性研究分为静态性能检验和动态性能检验，重点讨论了基于频谱估计的动态一致性检验方法。然后分析了导弹系统仿真可信性研究的具体思想和方法，给出了一个技术方案。
　　主题词　模拟，导弹，+频谱估计。
Simulation Credibility Analysis Method
and Its Application to Missile System
Li Pengbo
(National Univ. of Defense Technology，Changsha，410073)
　　Abstract　The concepts and methods of foreign research on simulation credibility are introduced. On the basis of the characteristics of dynamic system simulation, its credibility analysis is divided into two parts: static consistence test and dynamic consistence test, and the method of dynamic consistence test by spectrum analysis is emphatically discussed. Then, specific methodology of the research on simulation credibility of missile system is analyzed, and a technology project is given.
　　Key Words　Simulation, Guided missile,＋ Spectrum estimation.
1　前　言
　　计算机仿真技术一直在导弹系统的研制中发挥重要的作用。随着计算机技术、网络技术、多媒体技术的发展，仿真技术在方法和手段上得以不断创新，所以倍受人们的关注。近10年来，仿真技术更是受到美国等发达国家的高度重视，美国国防部一直把仿真技术作为“国防关键技术计划”的重点项目，不但发布了“国防建模及仿真倡议”，批准了“建模与仿真管理计划”，新组建了“国防建模与仿真办公室”，还提出了新的建模与仿真的投资战略。在美国国防部1996年“国防技术领域计划”中，提出了美国国防科学与技术发展10个关键领域的计划：a）航空平台；b）生化防御与核技术；c)信息系统与技术；d）地面车辆与舰艇；e）材料与工艺；f）生物医学科学技术；g）传感器、电子设备与作战空间环境；h）航天平台；i）人机系统；j）武器。这10个领域都利用建模与仿真技术作为工具，支持概念分析、技术开发、采办、试验、部署、维持、作战效果、训练和计划产品改进等工作。美国国防部1994年“建模与仿真管理指令”中规定了国防部的政策，其中有几条是投资促进DOD（Department of Defense） 的M&S（Modeling and Simulation）技术的提高；建立M＆S信息分析中心；DOD各部门建立验证、确认与认定VV＆A(Validation Verification and Accreditation）政策和由DOD各部门管理M＆S应用的过程等。从以上可看出，现在仿真技术已不仅仅局限于尖端武器系统的研制，而是扩展到各个国防技术领域，扩展到武器系统的全生命周期。不再局限于研制部门作为一种研究的手段，而是成立了专门的管理机构，在政策和资金上予以重视和支持。
　　美国的试验鉴定策略已经从传统的“试验―调整―试验”方法向“模型―仿真―试验―迭代”方法转变，即首先是建立模型，其次仿真，然后进行试验，最后将试验结果迭代回模型，称之为仿真、试验与鉴定过程。通过这一过程，最终要建立一组能够精确代表系统且有适当置信度的模型，用来预测系统的性能、作战效能和作战适用性，并为采办和训练领域的其他人员提供支持。可见，计算机仿真技术的发展，不仅使试验鉴定方法的变革成为可能，而且使武器系统的装备部署、作战使用都可在实验室模拟实现。
　　毫无疑问，仿真技术是导弹系统型号研制、试验鉴定、装备部署、作战使用以及改进设计的重要手段。仿真系统必须是对实际系统真实的反映，不能反映真实系统的仿真是没有意义的。仿真结果可信的前提是有正确的仿真模型，仿真试验要求数学模型能真实地描述系统的物理过程和数学关系。也就是说，仿真必须是可信的，对仿真系统必须进行可信性研究，国际上称这项工作为验证、确认与认定（VV＆A），也给予了日益重视。
　　 对于仿真可信性研究，国际上强调的是加强模型的管理和校验管理，需要详细的技术准则和规范，有完善的组织、管理和监督机构。在技术方法上侧重于软件工程方法，即计算机软件的实现对实际系统的真实性反映程度。国内应对此引起重视，并注意结合我们的实际情况，多做一些分析处理工作。不仅要加强仿真技术方法的研究，还需要加强仿真可信性的研究。这对于加速武器的研制定型，提高性能，缩短研制周期，节省人力，节约经费都具有重要的意义。
2　仿真可信性研究的基本方法
　　对模型和仿真（M＆S)的信任度（Credibility）评价，是仿真过程必不可少的重要组成部分。评价信任度的过程称为可信度评估（Confidence Assessment）。可信度评估的主要工作包括：a) 模型的验证和确认（V＆V，Validation and Verification）。模型验证是一个过程，它确定模型的计算机实现是否准确地表示了模型开发者对系统的概念表达和描述。模型确认也是一个过程，它从预期应用的角度确定模型表达实际系统的准确程度。b) 版本管理（CM，Configuration Management）和认定(Accreditation）。模型版本管理则是一种制度，它应用技术和管理上的监督、控制手段，辨明模型的功能需求和能力并编写相应的文本，然后，监控模型能力的变化，将这些变化写入文本并发布相应的报告。模型认定是一种相信并接受某一模型的权威性决定，它表明权威性机构已认可模型适用于某一特定目的。以上工作一般统称为模型验证、确认和认定。
　　基于以上仿真可信性的概念和对它的认识，仿真可信性研究一般有如下方法。
2.1　模型检验管理方法
　　模型校验是一项复杂而艰巨的工作，它涉及很多单位和部门，应该首先做好组织管理工作。组建模型校验的管理机构，明确各单位的责任，搞好组织、管理和协调工作。没有严密的组织措施，模型校验工作是无法开展的。
2.2　模型验证方法
　　模型验证是针对仿真模型与程序进行的，目的是证实从实际系统的描述模型到其计算机程序之间的转换是正确的，简单地说就是检查仿真程序有无错误。1994年，Balci综述了模型验证的各种方法及其分类。原则上讲，软件工程领域提出的所有软件验证方法都可以用于仿真程序验证，只是各种方法的实用价值不同。
2.3　模型确认方法
　　模型确认的目的是检验和评估模型的有效性。模型有效性一般通过在给定试验条件下检验仿真模型，评价其在预期的应用目的下是否满足一定的精度要求来实现。模型精度是关于模型结果正确性的度量值。对于复杂系统模型，要想从理论上证明其正确性或得到其精度，都是十分困难甚至不可能的。模型有效性是模型可用性的度量，与实验条件、应用目的、精度要求和用户有关。模型有效性的度量值可以用模型可信度来表示。复杂系统模型可信度的评价是很困难的，很多情况下只有通过主观评价得到模型的可信度。模型有效与否是相对一定的应用目的及相应的实验条件而言的。评估时模型和实际／参考系统的实验或运行条件应当是相同的。实验条件的设定很大程度上取决于应用目的。模型精度是否满足要求也与应用目的有关。1994年，Sargent综述了模型确认的方法，主要方法有图灵测试法、灵敏度分析法、极端条件测试法、统计检验法、主观有效性检验等。
2.4　文本化方法
　　模型检验文本（简称模型文本）是根据一定的规范对模型、程序及VV＆A需求的文字描述。建立模型文本规范、编写模型文本及根据模型文本对建模过程进行控制的过程，称为模型文本化。在模型开发的过程中，通过编写模型文本，可以加深建模者对模型的认识，有助于消除模型的不完全性、不明确性和不一致性，提高M＆S的规范化程度。对于那些规模庞大、内容复杂、开发周期长、需要多个单位共同合作的仿真模型，编写规范的模型文本，既可以供建模者自己查阅，又可以作为协作人员的参考资料，便于模型开发过程的协调统一。
3　仿真可信性研究的定量方法
　　仿真可信性研究，最直接的方法是在相同的输入条件下将仿真试验的结果同其它更可信的结果（对导弹而言，即飞行试验的结果）作全面系统的比较，看它们是否一致以及一致性的程度。对于动态系统模型的检验，可以通过动态系统模型在相同的初始条件下的多次仿真，获得在同一模型下多个采样时间序列或采样变量，即同一总体的多个样本。由这些样本可以获得关于这个总体分布的许多特性，然后与更可信的结果（如飞行试验结果）进行一致性检验。这样，检验飞行试验的样本和仿真试验的样本是否属于同一总体，就可判断模型的可信性。根据试验结果的特性，系统性能参数包括静态性能（随机变量）和动态性能（随机序列）。因此，可信性检验的方法包括静态一致性检验和动态一致性检验。
3．1　静态一致性检验方法
　　静态性能是仿真计算的许多静态输出量，如某制导段的终点偏差、脱靶量、杀伤概率等，可以作为随机变量。实践中通常采用统计方法来描述其均值（准确度）和散布（密集度）。在相同试验条件下，可以获得飞行试验的样本和仿真试验的样本。静态一致性检验的实质就是检验它们是否来自同一随机总体，可根据假设检验方法。不妨设总体的分布函数为F，分两种情况讨论：
　　a） 非参数方法。当F完全未知时，在大样本情况下，可利用Kolmogorov-Smirnov检验；小样本情况下，则采用Wilcoxon秩和检验、逆序检验等。鉴于导弹飞行试验次数少，采用秩和检验。设n1， n2分别是相同条件下的仿真试验和飞行试验的样本数，一般来说，n1，n2中有一个较大（大于20），另外一个则较小（不大于20），缺乏秩和检验的概率分布表，那么用Bootstrap方法来解决这个问题。事实上，如果样本X＝（X1，…，Xn1）较大，而Y=（Y1，…，Yn2）较小（即n2较小），此时运用Bootstrap方法由小样本Y1，…，Yn2作出经验分布F（y)，再用Monte-Car1o方法，对F（y)进行抽样，即产生以F（y)为总体分布的随机数，例如Y1，Y2，…，YN（N＞＞1），它就是再生子样，且为大子样。于是用Wilcoxon检验样本X和Y是否为相容，以代替X和Y的相容性检验。
　　b） 参数方法。对F作正态假设，则F的形状只依赖于个别参数（均值和方差）。常用的参数统计方法，如假设检验、点估计、置信区间估计都可以作一致性检验。
　　1) 置信区间估计。设（x1，x2，…，xn）为正态总体N（μ，σ2）的一个样本，μ和σ2均未知。由样本均值和方差作均值μ的100（1-α)%置信区间。对于某一种飞行试验条件下（射程、目标特性、气候环境、干扰环境等），导弹只作一次飞行试验，而仿真可以重复多次。这样对仿真脱靶量作区间估计，由飞行试验脱靶量是否落入这个区间来判断仿真的可信性。
　　2) 假设检验。已假定命中点位置服从正态分布，设（x1，x2，…，xn1）和（y1，y2，…，yn2）分别是所有仿真和飞行试验子样，x2～N（μ1，σ21），y2～N（μ2，σ22）。由F检验来检验二正态总体方差的一致性，由t检验来检验二正态总体均值的一致性。
3．2　动态一致性检验方法
　　动态性能如导弹试验的过载、姿态、速率、分系统的输出等过程参数，其变化是复杂的，一致性检验也比较困难。我们用频谱估计方法进行动态一致性检验，取得了较好的效果。在实际飞行试验和仿真试验中获得的是一系列采样时间序列，要了解仿真试验对实际系统的模拟程度，即仿真模型的可信度，就是检验两个时间序列的总体一致性。如果两个时间序列样本服从同一总体，则可说明在该置信水平下，仿真试验和飞行试验的结果是一致的。
　　在相同的发射条件下，实弹飞行试验数据为一个样本｛x(t)，t=1，2…，N｝，而全数字打靶试验可重复多次，获得n个样本｛yi(t)，t=1，2…，N｝，i＝1，2，…，n。那么可以对时间序列样本｛y(t)｝作估计。
　　均值函数(1)
　　方差函数(2)

　　a） 直接统计方法。可以对试验结果进行直接统计，由作置信带，若｛x(t)｝落在置信带内，则接受假设，认为仿真试验结果和飞行试验结果具有动态一致性。这是工程上应用的方法，简便、直观。它只考察相同的误差变化范围，而不考察系统的结构、参数等。在系统很复杂的情况下，这不失为一种有效的分析方法。
　　b） 误差分析方法。由飞行试验和仿真试验的观测序列得到误差序列，一般可以从以下几个方面来度量误差序列：1) 误差序列的各种范数，典型的有均方误差、平方和误差、规一化平方和误差、最大误差、Theil不等式系数等等；2) 误差序列的概率分布函数和频谱特性；3) 误差的传播特性，主要针对仿真模型用于预报时的情况。
　　c) 频谱分析方法。时间序列的功率谱在频率域中服从一定的统计分布，但要求时间序列本身是平稳的。导弹飞行过程中的采样时间序列，一般是非平稳的，与复杂试验结果要作相同的处理，才具备一致性检验的基础。
　　为了得到平稳化的时间序列，作中心化和标准化处理：
(3)
(4)

式中　号表示复共轭。
　　如果为平稳时间序列，则可以利用功率谱进行一致性检验。传统的周期图谱估计虽然有较为精确的分布，但存在分辨率低、谱峰偏倚等问题。最大熵谱估计分辨率高，对短时序、低信噪比的信号亦有较好的精度，虽分布特性是近似的，用来作假设检验也是可行的。
　　对最大熵谱估计对数谱的抽样分布，构造统计量
(5)

式(5)的结果提供了假设检验S1(ωi)=S2(ωi)的基础，此假设检验的接受域是［-Zα／2≤D≤Zα／2］，其中，α为检验的显著性水平。对每个频率点都要作这样的检验。如果每个频率点都接受检验，则这两个时间序列样本是相容的。
　　设导弹飞行试验得到一个时间序列样本｛x（t），t=1，2，…，N｝，对数谱的估计为x1(ω)=样本容量为1，总体方差。
　　仿真试验数据为n个相互独立的时间序列样本｛yi(t)，t=1，2，…，N｝，i＝1，2，…，n。对数谱的估计的平均值为样本容量为n，，总体方差检验二正态总体的均值差。
　　假设检验为

　　在显著性水平α之下，拒绝H0，若
（6）

同样，对每个频率点ωi，i=1，2，…，m都要作这样的检验。如果所有频率点的功率谱都一致，则这两个时间序列是一致的。但在工程上，一般注意的是功率谱较强的频率点上频谱的一致性。
　　d）瞬时谱估计方法。前面讲的谱估计与相容性检验都是针对平稳时间序列的，但按前面的处理方法不一定得到了平稳化。因此，有必要作平稳性检验，并继续探讨平稳化方法。
　　无论傅立叶谱估计还是最大熵谱估计，都只适用于平稳随机信号的分析和处理。实际应用中，系统的输出大都是非平稳的时间序列，一般要进行平稳化处理。但有些信号是达不到平稳化要求的，如时变频率的信号。改进方法如短时傅立叶（STFT）是一个窗函数加权信号的Fourier变换，窗的宽度很短，即假设信号在很小的时间间隔内是平稳的。STFT一般难以达到分辨率的要求。瞬时谱分析方法之一，Wigner Distribution（WD）分析能用来分析这个问题，它能给出信号在任一时刻的频率成分。特别是适合于处理时变频率的非平稳随机信号。两个连续信号x(t)，y(t)的互WD变换定义为
(7)

其数学期望称为演变谱（或Wigner-Ville谱），由下式定义：
(8)

式(7)，(8)中的表示复共轭。
　　用频谱分析方法进行导弹系统仿真模型的验证在工程上已经得到了应用。因为频谱分析方法易于构造假设检验，是一种定量的方法，且可信度较高，所以其应用受到了广泛的关注。频率域的分析方法很多，如傅立叶谱估计、最大熵谱估计、交叉谱估计等，还有基于时间频率域的瞬时谱估计和演变谱估计等。它们的估计精度（分辨率）和分布特性都不一样，构造检验的方法也不一样，应用的范围和受到的限制也有差别。
4　导弹系统的仿真可信性分析
　　飞行试验是最终鉴定导弹武器系统性能的主要依据，也是检验仿真模型可信性的主要依据。所以，在导弹的研制过程中，要充分利用各种信息来源，对仿真试验、飞行试验和分系统试验的信息进行分析、比较和综合，以检验仿真模型是否正确，仿真结果是否可信。
　　导弹系统的全数字仿真模型非常复杂，各部分的子模型相互耦合、相互影响。如果将导弹的模型作为一个整体进行检验，则不能发现导弹哪个部分的模型需要校验。如果能将各个部分的模型（即子模型）分开进行检验，则容易发现需要校验的是导弹模型的哪个部分，即哪个子模型。导弹的遥测弹记录了飞行试验过程中各子系统的参数。综合遥外测的记录数据，充分利用这些信息，可以对导弹数学模型进行检验和校验。飞行试验过程的遥外测数据有目标参数（位置、速度等）、导弹位置、速度、姿态角、发动机推力、角增量和速度增量、舵偏指令和舵偏角、导弹角速度、过载等参数。飞行试验数据不仅仅包括导弹飞行的位置、速度等外测数据，还包括各子系统输入输出量的遥测数据，是全面的、充分的，可以用来检验各子系统的数学模型，从而检验整个系统的数学模型。
　　对于子系统模型的检验，如果这个子系统的输入输出参数都有飞行试验数据，那么可以通过飞行试验数据与相对应的仿真试验数据进行一致性检验，来判断子系统模型的可信性。如果这个子系统模型的输入或输出参数没有飞行试验数据，就要利用飞行试验的其它参数进行计算得到它。如果该子系统模型的输入参数是一致的，就具备了检验该子模型的基础。检验对应的输出参数，如果飞行试验数据与仿真试验数据是一致的，则该子模型得到了验证，见图1（方案一）；否则，可利用飞行试验参数对该子模型进行校验。具体方法是，将飞行试验的过程参数作为子系统仿真模型的输入，计算的结果与该子系统实际飞行试验的输出作比较，如图2所示（方案二）。图中的子系统输入数据和输出数据均为飞行试验数据。若输出数据与仿真计算数据相容，则子系统仿真模型反映了实际系统；若不相容，则子系统仿真模型没有反映实际系统，要对模型进行校验，直至子系统模型可信为止。


图1　利用飞行试验数据验证子系统仿真模型的基本思路（方案一）


图2　利用飞行试验数据校验子系统数字仿真模型的基本思路（方案二）
　　需要说明的是，飞行试验既可以是全程弹道，也可以是高弹道、小射程弹道等。对于子模型的验证，通过飞行试验数据的验证是最可信的，但如果飞行试验数据缺乏，也可以通过分系统的地面试验数据来验证，即分系统地面数据与该分系统仿真模型的输出作相容性检验。
　　对于飞行试验的遥外测数据要经过预处理，才可作为飞行试验的测量参数值。通过子系统模型输入输出参数与相应的飞行试验数据作为两个时间序列样本，作相容性检验，从而检验该子系统的数字仿真模型。对于两个时间序列样本，要进行时域和频域里的分析来判断其总体一致性。时域方法是误差序列的分析、置信区间估计等。频域分析要对样本进行中心化和标准化处理，作为两个时间序列样本的平稳化，还需要作平稳性检验。对两个平稳的时间序列样本，容易通过频谱分析方法来检验它们的相容性。其原理是对于相同模型下的两个时间序列样本，在频率域里具有相容性。频谱的估计方法在前面已有介绍，经常使用的是最大熵谱估计方法。
5　导弹模拟打靶的可信性分析技术方案
　　根据导弹模拟试验的特点，以及导弹模拟试验可信性分析的方法和要求，给出如下的可信性分析技术方案：
　　a） 获取飞行试验数据，即遥测、外测参数。遥测、外测参数为过程参数，包括导弹的位置、速度、姿态角、发动机推力、角增量和加速度增量、舵偏指令和舵偏角、导弹的角速度、过载等等。并获取落点偏差ΔLi，ΔHi，i=1，2，…，n。飞行试验包括全程弹道、高弹道、小射程弹道等飞行试验。
　　b） 获得进行仿真打靶试验的全数字仿真模型。将仿真模型分解细化为各个子系统模型，明确各子系统模型的输入输出及其接口关系。
　　c） 进行模拟打靶试验。由模拟打靶试验的过程参数得到各子模型的输入或输出参数，这些动态参数与相应的飞行试验过程参数作为两个时间序列样本。
　　d) 对于要检验的子系统模型，如果其输入输出参数都有飞行试验的遥测数据，则可直接对其进行检验；如果其输入或输出参数不具备飞行试验的遥测数据，则通过模型计算得到它，以得到相应的时间序列样本。
　　e） 对于两个时间序列样本，就可以作时域和频域里的分析和比较。时域里的一致性检验过程是：作预处理，剔除野值。然后作中心化和标准化处理，进行统计分析。
　　f） 对两个平稳的时间序列分别作最大熵谱估计。作对数功率谱，由式（6）检验每个频率点上功率谱的一致性。
　　g) 如果功率谱一致，则认为在该置信水平下，该子模型是可信的。如果功率谱不一致，则该子模型需要校验。
　　h） 如果所有子模型都是可信的，全系统仿真模型是可信的，则可以进行模拟打靶，得到落点偏差ΔL′j，ΔH′j，j=1，2，…，m。
　　i) 飞行试验的落点偏差ΔLi，ΔHi，i=1，2，…，n与仿真打靶的落点偏差ΔL′j，ΔH′j，j=1，2，…，m进行静态一致性检验。
　　j） 对动态一致性和静态一致性检验都完成后，即可给出结论性意见。在一定的置信水平下，如果仿真打靶和飞行试验的结果是一致的，即可对导弹制导精度进行鉴定。
　　致谢　感谢北京仿真中心王东木总师，北京航天自动控制研究所吴立人研究员等老师的帮助和指导。
作者单位:李鹏波(国防科学技术大学，长沙，410073)
参考文献
　[1]　Balci O. Validation，verification，and testing techniques throughout the life cycle of a simulation study．Proc. of WSC’94（Winter Simulation Conference），1994.
　[2]　Balderson K A，Weathers J T. Comparison of frequency response and perturbation methods to extract linear models from a nonlinear simulation. AD-A284115， 1994.
　[3]　Bonner M S，Gingras D R. Status of a comprehensive validation of the Navy's F／A-18A aerodynamics mode1. AIAA-96-3529-CP,1996.
　[4]　Gravitz R M，Waite W F. Validation methodologies for complex，hybrid，HWIL， 6DOF missile simulations――a structured approach. Proc. of WSC’88，1988.
　[5]　Morton W C. Simulation validation experience――patriot guidance system, 1983.
　[6]　Patricia Sanders. Test and evaluation to the modernization challenge.Internet：hhtp：／／www.acq.osd.mil／te／speeches／sanders／challenge.html.
　[7]　Poolla K，Khargonekar P. A time-domain approach to model validation. IEEE trans．A.C，39（5），1994.
　[8]　Sargent R G. Verification and validation of simulation models. Proc. of WSC'94，1994.
　[9]　Smith R S. Model validation for robust control：an experimental process control application. Automatica， 1995，31(11).
　[10]　李鹏波，谢红卫. 应用瞬时谱估计方法验证近炸引信的数字仿真模型. 国防科技大学学报，1998，20（1）.
　[11]　李鹏波，谢红卫. 频谱分析方法在仿真可信性研究中的应用. 系统仿真学报，1998，10（3）.
　[12]　李鹏波，蔡洪等. 仿真技术在导弹精度分析中的应用. 战术导弹技术，1998(2）.
　[13]　王秀成，徐长林. 指令制导系统数学仿真置信度问题. 系统工程与电子技术，1989（2）.
　[14]　汪德武. 战略导弹精度仿真中仿真模型的校验研究. 计算机仿真，1993，34（1）.
　[15]　魏华梁，刘藻珍. 交叉谱估计及其在导弹系统仿真模型验证中的应用. 系统仿真学报，1997，9（3）.
　[16]　吴立人. 制导精度评定的蒙特卡罗模拟. 导弹与航天运载技术，1995(5）.
　[17]　陈兆国. 时间序列及其谱分析. 科学出版社，1988.
　[18]　张金槐，蔡洪. 飞行器试验统计学. 国防科技大学出版社，1995.
　[19]　张金槐，贾沛然. 远程火箭精度分析与评估. 国防科技大学出版社，1996.
　[20]　张贤达. 现代信号处理. 清华大学出版社，1995.
　[21]　郑治真. 瞬时谱估计理论及其应用. 地震出版社. 1993.
收稿日期：1998-10-05
