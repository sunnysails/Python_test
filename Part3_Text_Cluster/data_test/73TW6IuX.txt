航空工艺技术
AERONAUTICAL MANUFACTURING TECHNOLOGY
1999年　第3期　No.3 1999



基于微控制器的动平衡机
通用电测系统的研究
Research on Microcontrollor_Based Measuring System Used
for Different Types of Dynamic Balancing Machines
周正干　满庆丰　周卫宁　邬学礼
　　［摘要］　论述了一种以89C51微控制器为核心的动平衡机通用电测系统的实现方法。系统采用了90年代先进的硬软件结合技术，寻求达到高精度、多功能、易操作和低成本的总体目标。为了满足不同用户的需求，系统可支持多种支承方式，具有多种显示方式、多种补偿方式、多次启动平均、多面校正计算、多种打印方式以及自动标定等功能。
　　关键词： 动平衡机　电测系统　微控制器应用

　　［ABSTRACT］　This paper describes a microcontrollor_based measuring system used for different types of dynamic balancing machines. Using advanced technology both in hardware and software of the nineties, this system aims to reach the general goal of high precision, multiple function, easy_to_operate and low cost. In order to meet the needs of different users, this system is designed to be applicable under different supporting, displaying and compensating modes. Besides, this system is also capable of realizing: averaging over time & runs, re_distribution of correction data between multiplanes, data/screen printing and automatic calibration, etc..
　　Keywords: Dynamic balancing machine　Measuring system　Application of microcontrollor

　　机器中绕轴线旋转的零部件，称为机器的转子。如果一个转子的质量分布均匀，制造和安装合格，则运转是平稳的，其对轴承的压力，只有静压力，我们称之为平衡的转子。反之，若转子因质量分布不均匀，安装不当，致使其中心惯性主轴与回转轴线不重合而在旋转时对轴承加有动压力，我们称之为不平衡的转子。
　　对于旋转轴线有约束的不平衡转子，动不平衡在支承上造成的动压力也称动载荷，它不仅会引起整个旋转机械的振动，产生噪音，增加能耗，还会加快轴承的磨损，造成转子部件的高频疲劳破坏和支承机匣及某些部件强迫振动损坏，降低旋转机械的寿命，严重时还会导致重大事故。
　　对于旋转轴线无约束的转子(如卫星等)，动不平衡将会影响其在空间的姿态，进而影响工作质量。
　　由于这些不平衡是在转子转动时出现的，故一般需要在转动时进行测量，然后校正，因此称为动平衡。动平衡效果如何，在很大程度上受测量系统精度的制约。
　　从原理上分，测量系统可分为软支承动平衡机和硬支承动平衡机。软支承动平衡机问世于50年代末至60年代初，至今仍广泛使用，特别是在超高速、高精度、小转子和大批量(如曲轴)的平衡以及在自动动平衡机领域仍用软支承动平衡机。硬支承动平衡机是自70年代初迅速发展起来的一种用途广泛的通用动平衡机，由于其标定与转子的M(质量)和I(转动惯量)无关，因此只需要一次标定(而软支承动平衡机的标定系数随转子的M和I而异，故对于不同类型的转子，需要一一重新标定)。近年来，由于硬支承动平衡机结构上的不断改进，电测系统也日益完善，平衡精度不断提高且通用性强，因此目前硬支承动平衡机已成为动平衡机的主流。
　　动平衡机由以下几部分组成：机械测振系统(含振动传感器和相位信号发生器)、驱动系统、电子测量系统、校正装置和安全防护装置。其中，机械测振系统等的发展相对缓慢，而电测系统发展却十分迅速。由于微机的日益普及，微机化的电测系统已经成为国内外动平衡机设计的新潮流。随着近代超大规模集成电路的出现，微处理器及其外围芯片有了迅速发展，选择微控制器实现微机化动平衡机电测系统是一种经济、可行的方案。
　　由此可见，动平衡技术是一种机电一体化的复杂技术，也是制约机械工业发展的关键技术，它直接影响各种旋转机械的工作质量和寿命．
　　为了跟踪世界先进的动平衡技术，提高国内电测系统的水平，研制了测量精度高、功能齐全、操作简单、适用于各种动平衡机的通用微机化电测系统。

1　系统的总体设计方案
1.1　影响系统方案的因素
　　动平衡机电测系统的主要任务是从机械测振系统所得到的含干扰的微弱的动不平衡信号中提取与转子旋转同频的有用信号的幅值和相位信息，同时，还要配合机械测振系统解决转子的平面分离(解算)以及转子的自动定相问题。这是我们在电测系统设计时的基本出发点。
　　本系统是动平衡机通用电测系统，适用于各种动平衡机，包括不同支承系统(硬支承和软支承)和测振传感器(位移、速度和力传感器)，因此需要考虑以下问题：
　　.　不同支承系统与不同测振传感器组合的平衡机，传感器输出的不平衡量信号与ω的关系是不同的(ω――转子的旋转角速度)；
　　.机械杠杆放大器输出的高频噪声；
　　.通过地基传来的低频干扰和传动干扰；
　　.转子的平衡转速不可能做到绝对稳定；
　　.在信号滤波放大的过程中，要考虑如何减小参考通道对小信号通道的干扰以及环境温度变化对直流零位漂移的影响等；
　　.在实现高精度和多功能目标时，要考虑如何充分发挥硬软件各自的优势以使系统获得较高的性能价格比。
1.2　系统的组成
　　根据上述考虑，在设计和组成系统时确定了以下原则：
　　.通过软件计算来消除平衡转速对不平衡信号的影响；
　　 为了在高转速工作时有用信号不至于过小，将100～25?600?r/min的转速分成100～399，400～1599，1600～6399和6400～25600r/min 4个区间；
　　.选用AD574，加快数据采集步伐，以加大样本。通过软件进行多次平均，以最大程度地减少近频干扰和随机干扰；
　　.选用89C51微控制器作主机，在保证测量精度的前提下，大力加强电测系统的功能：多种支承方式、多种显示方式、多种补偿方式、多种增益控制方式、多种时间平均、多次启动平均、多面校正计算、多种打印输出方式和自动标定等。
　　系统的总体框图如图1所示。


图1　基于微控制器的动平衡机通用电测系统总体框图
Fig.1　Block diagram of microcontrollor_based measuring system used 
for different types of dynamic balancing machines
　　下面对系统框图中的某些部分作简单介绍：
　　(1)前置处理　软支承动平衡机是测幅型，通过传感器检测出与振幅成正比的不平衡量；而硬支承动平衡机是测力型，通过传感器检测出与离心力成正比的不平衡量。前已述及，不同支承系统与不同测振传感器组合的平衡机，传感器输出的不平衡量信号与平衡转速的关系是不同的，因此，前置处理中积分器的阶次是可选的。系统将工作转速分成4个转速档，对应于每个转速档，有相应的积分器通道(转速的分档是由硬件来实现的)。
　　(2)人工/自动增益控制电路AGC　增益控制AGC是为了在扩大量程范围基础上，减小A/D的量化误差而设计的。该电路使A/D转换精度得以充分利用，保证平衡机的指标不因信号小而降低。本系统的增益控制可以实现人工控制和自动控制的切换。一般情况下选取用“自动增益控制”方式，当干扰特别强烈并且起伏较大时建议选取用“人工增益控制”方式．
　　(3)MDAC相关滤波　动平衡机传感器的输出信号中包括有与转子转速同频的信号、确定性干扰和随机干扰。电测系统的主要任务之一就是滤波：抑制各种干扰，提取有用信号，即与转子同频的信号。设计滤波器时，带宽越窄，分离的精度也就越高，同时，一个通用的动平衡机要求能在不同的转速下工作(即使在某一特定转速下平衡时，由于各种原因，转速也会发生一定偏移，要求它恒定是困难的，也是不经济的)。因此，系统中采用自动跟踪带通滤波器。当动平衡机转速不稳定时，跟踪带通滤波器的中心频率可自动跟踪转速，从而保证有用信号幅值和相位的稳定，提高测量精度。由于MDAC滤波器的特点，本系统采用MDAC相关滤波。所谓相关滤波，就是选定一对正交信号sinω0t和cosω0t作为参考信号，使信号f(t)分别与它们相关，便可得到ω0频率分量的幅值和相位。
　　(4)参考通道电路　参考通道电路主要包括：转速测量电路；为前置处理中的积分电路提供通道地址的译码电路，以控制积分器的自动切换；为自动增益控制电路(AGC)提供计数器时钟信号，使得在光电脉冲有输出时，允许AGC电路每秒动作一次；为MDAC主滤波电路提供360f0及f0信号，以控制计数器计数，使得EPROM能为MDAC提供一完整的正余弦波形。
　　(5)89C51微控制器应用系统　该系统中含A/D转换电路、键盘显示器接口及I/O接口等。为了在软件中实现多点平均(相当于软件低通滤波器)，系统中A/D转换器采用AD574。AD574是快速12位逐次逼近型A/D转换器，是目前我国市场应用最广泛、价格适中的A/D转换器。由于其片内包含高精度的参考电压源和时钟电路，这使它能在不需要任何外部电路和时钟信号的情况下完成一切A/D转换功能，应用非常方便。键盘显示器接口用于各种功能键的输入和不平衡量的数字显示。89C51微控制器通过I/O接口接收硬件电路处理后的信息并输出必要的数据，主要完成以下功能：输入a,b,c,r1,r2，权系数及移相等数值；输入20位二进制转速码；输入16位系统状态信息码；输入4位人工/自动增益控制码；输出控制A/D转换电路前的多路开关的地址码；打印机输出接口。

2　系统软件分析
　　动平衡机电测系统微机化的主要目的并非在于提高平衡测量精度(实际上用软件实现的对时间的平均化处理也有助于读数的稳定，从而减小读数误差；而且通过非线性补偿以及其他算法可大大提高系统的测量精度，补偿硬件电路的缺陷)，而是在于增加系统的功能。通过微机化可以减少硬件成本并增加系统功能。有不少硬件功能，如软支承机的解算、硬支承机的a_b_c_r1_r2运算、各种补偿(如转子的初始不平衡量补偿、工装的系统误差补偿、键补偿以及直流零位补偿等)、平均化处理、数据存储、坐标变换和矢量分解等，用软件来实现更为方便。有一些用硬件难以实现的功能，如测试报告打印和随机操作指南等，通过微机化就可以轻而易举地得到解决。本系统的控制软件就是基于这种基本原则而设计的，其流程框图如图2所示。


图2　系统软件流程总体框图
Fig.2　Overall flow_chart of system software
　　下面对软件流程图中的某些部分做简单介绍：
　　(1)初始化、实时钟设置或显示和系统自校　软件运行时，首先对硬件部分(如8255，8279等)进行初始化，并将其本身所用到的状态标志进行初始设置，然后进行系统实时钟的设置或显示。系统关机后重新开机，如果需要，可进行实时钟设置；如果是不关机复位，则系统时钟只显示但不重新设置。接着系统进入自校。系统自校主要是对硬件电路的校验，判断硬件是否正常工作。若有故障，显示并提请用户排除故障；若无故障，自校通过。该功能的设置，主要是为了增加系统的可靠性，方便用户使用、维护。
　　(2)读取系统参数　系统操作面板上设置的参数记录了转子动平衡所需的全部平衡参数信息。一个转子的平衡测量必须在这些参数的基础上进行，这是因为测量中所有的运算、补偿及其他特殊处理(包括多面校正计算)所需要的参数都是由这些参数提供的。这些参数包括了动平衡机的信息、转子的几何尺寸、电测系统的信息以及平衡的方式和不平衡的表述方式，综合起来有下述一些方面：动平衡机类别(硬支承/软支承)、测振传感器(位移型/速度型/力型)、转子支承方式(6种)、a-b-c-r1-r2尺寸、显示模式(左右校正面/准静-偶/偶-准静/支承动载荷)、显示方式(极坐标/分量)、轻/重区、增益控制方式(人工/自动)、宽/窄带、平均化处理(延迟时间、平均时间)、平衡允差、平衡转速、校正方式(不要/人工/自动)、补偿(不要/初值补偿/工装偏心补偿/键补偿/多次启动平均)等等。用户根据实际需要，在系统操作面板上设置或修改这些参数。
　　(3)测量　测量模块包括对不平衡量的测量以及各种特殊处理、打印和增益控制切换等。不平衡量的测量是本系统的主要任务，也是系统软件的主要功能，它包括采集硬件系统来的不平衡信号、系统状态信息码、平衡转速和增益控制电路的增益码等；进行矢量运算、增益运算、非线性补偿运算和a-b-c-r1-r2矢量分离运算；显示不平衡量、转速及增益等。
　　(4)二次处理　二次处理包括：频率加权；放大器增益影响的扣除；a-b-c-r1-r2运算；补偿运算；坐标变换；标定系数的自动生成和运用；多次启动平均；校正量计算等。a-b-c-r1-r2运算根据系统参数中的a-b-c-r1-r2值、支承方式以及用户要求的显示模式(左右校正面/准静-偶/偶-准静/支承动载荷)的不同，利用有关公式进行。补偿运算主要用于消除各类系统误差，主要有：初值补偿、键补偿和工装偏心补偿。通过初值补偿可获得一个不平衡读数为零的“标准”转子(转子的实际不平衡量并不为零)；通过键补偿可使无键轴的不平衡读数自动加上键的不平衡量的影响；通过工装偏心补偿则可以消除动平衡机工艺装备(如工艺心轴、平衡夹具、联轴节等)的偏心(相对于旋转轴线)对转子不平衡量的影响。多次启动平均主要用于有松动零件的转子(如带叶片的涡轮转子)的平衡，由于这种误差的引起是随机的，故采用多次启动平均。不同的场合，要求动平衡量有不同的表示方式，如极坐标、分量等等，用户可根据自己的需要和要求进行选择，软件将根据系统参数中有关量的不同设置，对平衡量进行坐标变换。为了给校正工序提供直接的数据，软件可以根据不同的工艺要求，将不平衡量分解到需要校正的各个平面上。
　　(5)标定　动平衡机系统包括机械测振系统(含传感器)和电测硬件线路的整体。标定就是确定整个机电系统的传递函数的增益系数和相位移。硬支承动平衡机属于永久性标定，其标定系数取决于多种参数，如转子-支承系统的频率特性、测振传感器的频率特性、电测系统的频率特性以及平衡机承重面与地基地面的接触刚度等(严格说来，还包括平衡转速)。所以高精度和大型平衡机一般需要在用户地基上安装后通过校验转子在现场进行一次最后的调正(含标定)。软支承动平衡机不是永久性标定，对于每一类型的转子都需要由用户自己对平衡机进行调正和标定。系统软件中含有标定模块。对于硬支承机，为减小原理误差，本系统采取了逐段(转速段)标定的办法。标定系数的单位为克*毫米/单位输出，可由系统自动生成。标定时，用户可根据需要选择键盘设置或自动标定。键盘设置适合于对标定系数作小的调整，并确定各转速段的特征频率(或特征转速)。自动标定采用两点标定法并能自动消除初始不平衡量，自动生成标定系数。

3　结论
　　本文针对国内外动平衡机电测系统的基本现状及发展趋势，提出了一种以微控制器为主机的微机化动平衡机通用电测系统的实现方案，并经过对系统的实际调试和机电联调，证明了方案的可行性。
　　. 系统的测量转速范围为100～25600r/min；
　　. 主滤波器采用先进的MDAC数字模拟混合式的相关滤波，直流零漂稳定，受温度影响小；
　　. 前置滤波中积分器的阶次可选，消除了转速对不平衡信号的影响；
　　. 自动增益控制与人工增益控制均采用纯硬件实现；
　　. 转子转速测量采用闸门计数法，精确、可靠；
　　. 为进一步提高测量精度，系统软件中采用了非线性补偿的方法，以消除实际积分器线性化所引入的误差；
　　. 本文提出了新的前置滤波器方案――跟踪带通滤波器，并在试验中证明了该方案的可行性。
　　动平衡机电测系统微机化的好处是明显的，不但以较小的代价增强了系统的功能，也由于各种平均和补偿算法的加入，提高了测量精度，实现了高精度、多功能、易操作和低成本的总体目标。
　　本文的研究工作得到周士炎教授的悉心指导。周教授积劳成疾，不幸于1996年4月与世长辞。作者谨以此文献给周士炎教授。
作者单位：北京航空航天大学
参考文献
　　1　周士炎.航空发动机转动件的平衡.见：《航空制造工程手册》总编委会主编.航空制造工程手册.发动机装配与试车.北京：航空工业出版社，1995
(责编　根　山)　
